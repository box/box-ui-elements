{"version":3,"file":"createTheme.js","names":["Color","method","merge","mapValues","THEME_VERY_DARK","THEME_DARK","THEME_MID_DARK","THEME_MIDTONE","THEME_MID_LIGHT","THEME_VERY_LIGHT","defaultTheme","vars","OFFSET_FACTOR","MIN_CONTRAST","getYiq","color","rgb","adjustLightness","amount","lightness","createTheme","colorKey","Error","colorKeyObj","colorKeyYiq","colorKeyLightness","whiteTextContrast","contrast","white","blackTextContrast","black","foreground","foregroundObj","colorMap","yiqRange","modifiers","active","gradient","hover","activeInverse","hoverInverse","lightnessThreshold","colorRange","Object","keys","find","key","colorRangeConfig","_objectSpread","modifiedColors","value","entries","exceedsLightThreshold","exceedsDarkThreshold","hoverContrast","activeContrast","scrollShadowRgba","colorKeyHex","hex","hoverHex","activeHex","gradientHex","colorValues","background","backgroundHover","backgroundActive","backgroundGradient","border","bdlGray10","buttonForeground","buttonBackground","bdlGray","buttonBackgroundHover","bdlGray80","buttonBackgroundActive","bdlGray65","buttonBorder","buttonBorderHover","buttonBorderActive","progressBarBackground","bdlGray50","dynamicTheme","primary","_debug"],"sources":["../../src/utils/createTheme.js"],"sourcesContent":["/* eslint-disable no-restricted-syntax */\n// @flow\nimport Color from 'color';\nimport type { ColorType } from 'color';\nimport method from 'lodash/method';\nimport merge from 'lodash/merge';\nimport mapValues from 'lodash/mapValues';\n\nimport {\n    THEME_VERY_DARK,\n    THEME_DARK,\n    THEME_MID_DARK,\n    THEME_MIDTONE,\n    THEME_MID_LIGHT,\n    THEME_VERY_LIGHT,\n} from '../constants';\nimport defaultTheme from '../styles/theme';\nimport * as vars from '../styles/variables';\n\n// When converting from rgb/hsl to hex there is potential for\n// flattening of the color space, so we add an offset factor to account for it.\nconst OFFSET_FACTOR = 0.05;\nexport const MIN_CONTRAST = 4.5;\n\n// The yiq coefficients in the color library are incorrect\n// http://poynton.ca/notes/colour_and_gamma/ColorFAQ.html#RTFToC9\nfunction getYiq(color: string) {\n    const rgb = Color(color).rgb().color;\n\n    return (rgb[0] * 2126 + rgb[1] * 7152 + rgb[2] * 722) / 10000;\n}\n\nfunction adjustLightness(color: ColorType, amount: number) {\n    const lightness = color.lightness();\n    return color.lightness(lightness + amount);\n}\n\n// Given a colorKey, output an accessible Box color palette\nfunction createTheme(colorKey: string) {\n    if (!colorKey) {\n        throw new Error('Color key is undefined');\n    }\n\n    const colorKeyObj = Color(colorKey);\n    const colorKeyYiq = getYiq(colorKey);\n    const colorKeyLightness = colorKeyObj.lightness();\n\n    const whiteTextContrast = colorKeyObj.contrast(Color(vars.white));\n    const blackTextContrast = colorKeyObj.contrast(Color(vars.black));\n\n    // Take the greater contrasting foreground color\n    const foreground = whiteTextContrast > blackTextContrast ? vars.white : vars.black;\n    const foregroundObj = Color(foreground);\n\n    //  vDark dark    midDark   midtone   midLight  vLight\n    // |----|-----|-----------|----|----|-----------|----|\n    // 0    4     20         118  128  168         235  255\n    const colorMap = {\n        [THEME_VERY_DARK]: {\n            yiqRange: [0, 4],\n            modifiers: {\n                active: 15,\n                gradient: 10,\n                hover: 10,\n            },\n        },\n        [THEME_DARK]: {\n            yiqRange: [4, 20],\n            modifiers: {\n                active: 8,\n                gradient: 5,\n                hover: 4,\n            },\n        },\n        [THEME_MID_DARK]: {\n            yiqRange: [20, 118],\n            modifiers: {\n                active: -8,\n                gradient: -5,\n                hover: 4,\n            },\n        },\n        [THEME_MIDTONE]: {\n            yiqRange: [118, 168],\n            modifiers: {\n                active: -7,\n                activeInverse: 9,\n                gradient: -7,\n                hover: 7,\n                hoverInverse: -4,\n            },\n        },\n        [THEME_MID_LIGHT]: {\n            yiqRange: [168, 235],\n            modifiers: {\n                active: 15,\n                gradient: -10,\n                hover: 10,\n            },\n        },\n        [THEME_VERY_LIGHT]: {\n            yiqRange: [235, 256],\n            lightnessThreshold: 90,\n            modifiers: {\n                active: -8,\n                gradient: -5,\n                hover: -4,\n            },\n        },\n    };\n\n    // Filter down the color map to the object that's in the proper YIQ range\n    const colorRange = Object.keys(colorMap).find(\n        key =>\n            (colorKeyYiq >= colorMap[key].yiqRange[0] && colorKeyYiq < colorMap[key].yiqRange[1]) ||\n            (colorMap[key].lightnessThreshold && colorKeyLightness >= colorMap[key].lightnessThreshold),\n    );\n    const colorRangeConfig = {\n        ...colorMap[colorRange || THEME_MIDTONE],\n    };\n\n    // Modify the primary colorKey with the associated modifiers from the filtered map\n    const modifiedColors = {};\n\n    for (const [key, value] of Object.entries(colorRangeConfig.modifiers)) {\n        // $FlowFixMe\n        modifiedColors[key] = adjustLightness(colorKeyObj, value);\n    }\n\n    // If the color is too extreme on either end of the spectrum we need to change our rules.\n    const exceedsLightThreshold = colorRange === THEME_VERY_LIGHT || colorRange === THEME_MID_LIGHT;\n    const exceedsDarkThreshold = colorRange === THEME_VERY_DARK || colorRange === THEME_DARK;\n\n    // Light or dark isn't sufficient for determining how the secondary or accent colors should\n    // be calculated. In addition to that check, we will check the yiq value of the color to ensure\n    // the colorKey is not on the edges of the spectrum.\n\n    const hoverContrast = modifiedColors.hover.contrast(foregroundObj);\n    // If contrast has reached 21, we have hit the end of the spectrum and want to invert.\n    const hover =\n        hoverContrast >= MIN_CONTRAST + OFFSET_FACTOR && hoverContrast !== 21\n            ? modifiedColors.hover\n            : modifiedColors.hoverInverse || adjustLightness(colorKeyObj, -colorRangeConfig.modifiers.hover);\n\n    const activeContrast = modifiedColors.active.contrast(foregroundObj);\n    const active =\n        activeContrast >= MIN_CONTRAST + OFFSET_FACTOR && activeContrast !== 21\n            ? modifiedColors.active\n            : modifiedColors.activeInverse || adjustLightness(colorKeyObj, -colorRangeConfig.modifiers.active);\n\n    let scrollShadowRgba = 'rgba(0, 0, 0, 0.12)';\n    if (exceedsLightThreshold) {\n        scrollShadowRgba = 'rgba(0, 0, 0, 0.08)';\n    } else if (exceedsDarkThreshold) {\n        scrollShadowRgba = 'rgba(0, 0, 0, 0.4)';\n    }\n\n    // Converting color objects to hex for return value\n    const colorKeyHex = colorKeyObj.hex();\n    const hoverHex = hover.hex();\n    const activeHex = active.hex();\n    const gradientHex = modifiedColors.gradient.hex();\n\n    const colorValues = {\n        background: colorKeyHex,\n        backgroundHover: hoverHex,\n        backgroundActive: activeHex,\n        backgroundGradient: gradientHex,\n        foreground,\n        border: exceedsLightThreshold ? vars.bdlGray10 : colorKeyHex,\n\n        // Button specific overrides. If the primary color is greater than the lightness threshold\n        // we will override the button styling to be a styling based on vars.bdlGray primary.\n        buttonForeground: exceedsLightThreshold ? vars.white : foreground,\n        buttonBackground: exceedsLightThreshold ? vars.bdlGray : colorKeyHex,\n        buttonBackgroundHover: exceedsLightThreshold ? vars.bdlGray80 : hoverHex,\n        buttonBackgroundActive: exceedsLightThreshold ? vars.bdlGray65 : activeHex,\n        buttonBorder: exceedsLightThreshold ? vars.bdlGray : colorKeyHex,\n        buttonBorderHover: exceedsLightThreshold ? vars.bdlGray80 : hoverHex,\n        buttonBorderActive: exceedsLightThreshold ? vars.bdlGray65 : activeHex,\n\n        // ProgressBar overrides\n        progressBarBackground: exceedsLightThreshold ? vars.bdlGray50 : hoverHex,\n\n        // Scroll effect overrides for scrollable themed elements\n        scrollShadowRgba,\n    };\n\n    const dynamicTheme = {\n        // To avoid a mixture of casing, we force all values to lower\n        primary: { ...mapValues(colorValues, method('toLowerCase')), _debug: { colorRange } },\n    };\n\n    return merge({}, defaultTheme, dynamicTheme);\n}\n\nexport { createTheme };\n"],"mappings":"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","ignoreList":[]}