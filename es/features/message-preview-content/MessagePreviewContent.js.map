{"version":3,"file":"MessagePreviewContent.js","names":["React","classNames","ContentPreview","Cache","MessagePreviewGhost","PreviewErrorNotification","apiCache","MessagePreviewContent","contentPreviewProps","fileId","sharedLink","getToken","className","apiHost","isPreviewLoaded","setIsPreviewLoaded","useState","isPreviewInErrorState","setIsPreviewInErrorState","previewRef","useRef","useEffect","createElement","_extends","cache","componentRef","onError","onLoad","current","getViewer","disableViewerControls","token"],"sources":["../../../src/features/message-preview-content/MessagePreviewContent.js"],"sourcesContent":["// // @flow\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport ContentPreview from '../../elements/content-preview';\nimport type { Token } from '../../common/types/core';\nimport Cache from '../../utils/Cache';\nimport MessagePreviewGhost from '../message-preview-ghost/MessagePreviewGhost';\nimport PreviewErrorNotification from './PreviewErrorNotification';\nimport './styles/MessagePreviewContent.scss';\n\nexport type ContentPreviewProps = $Diff<\n    React.ElementConfig<typeof ContentPreview>,\n    {\n        apiHost: any,\n        cache: any,\n        className: any,\n        componentRef: any,\n        fileId: any,\n        onError: any,\n        onLoad: any,\n        sharedLink: any,\n        token: any,\n    },\n>;\n\ntype Props = {|\n    apiHost: string,\n    className?: string,\n    contentPreviewProps?: ContentPreviewProps,\n    fileId: string,\n    getToken: (fileId: string) => Promise<Token>,\n    sharedLink: string,\n|};\n\nconst apiCache = new Cache();\n\nfunction MessagePreviewContent({ contentPreviewProps, fileId, sharedLink, getToken, className = '', apiHost }: Props) {\n    const [isPreviewLoaded, setIsPreviewLoaded] = React.useState(false);\n    const [isPreviewInErrorState, setIsPreviewInErrorState] = React.useState(false);\n    const previewRef = React.useRef(null);\n\n    React.useEffect(() => {\n        setIsPreviewLoaded(false);\n        setIsPreviewInErrorState(false);\n    }, [fileId]);\n\n    return (\n        <div className={classNames('MessagePreviewContent', className)}>\n            {isPreviewLoaded ? null : <MessagePreviewGhost />}\n            {isPreviewInErrorState ? (\n                <PreviewErrorNotification />\n            ) : (\n                <ContentPreview\n                    {...contentPreviewProps}\n                    apiHost={apiHost}\n                    cache={apiCache}\n                    className={classNames({ 'MessagePreviewContent is-loading': !isPreviewLoaded })}\n                    componentRef={previewRef}\n                    fileId={fileId}\n                    onError={() => {\n                        setIsPreviewLoaded(true);\n                        setIsPreviewInErrorState(true);\n                    }}\n                    onLoad={() => {\n                        if (previewRef.current) {\n                            previewRef.current.getViewer().disableViewerControls();\n                            setIsPreviewLoaded(true);\n                        }\n                    }}\n                    sharedLink={sharedLink}\n                    token={() => getToken(fileId)}\n                />\n            )}\n        </div>\n    );\n}\n\nexport default MessagePreviewContent;\n"],"mappings":";AAAA;AACA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,OAAOC,UAAU,MAAM,YAAY;AACnC,OAAOC,cAAc,MAAM,gCAAgC;AAE3D,OAAOC,KAAK,MAAM,mBAAmB;AACrC,OAAOC,mBAAmB,MAAM,8CAA8C;AAC9E,OAAOC,wBAAwB,MAAM,4BAA4B;AACjE,OAAO,qCAAqC;AA0B5C,MAAMC,QAAQ,GAAG,IAAIH,KAAK,CAAC,CAAC;AAE5B,SAASI,qBAAqBA,CAAC;EAAEC,mBAAmB;EAAEC,MAAM;EAAEC,UAAU;EAAEC,QAAQ;EAAEC,SAAS,GAAG,EAAE;EAAEC;AAAe,CAAC,EAAE;EAClH,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGf,KAAK,CAACgB,QAAQ,CAAC,KAAK,CAAC;EACnE,MAAM,CAACC,qBAAqB,EAAEC,wBAAwB,CAAC,GAAGlB,KAAK,CAACgB,QAAQ,CAAC,KAAK,CAAC;EAC/E,MAAMG,UAAU,GAAGnB,KAAK,CAACoB,MAAM,CAAC,IAAI,CAAC;EAErCpB,KAAK,CAACqB,SAAS,CAAC,MAAM;IAClBN,kBAAkB,CAAC,KAAK,CAAC;IACzBG,wBAAwB,CAAC,KAAK,CAAC;EACnC,CAAC,EAAE,CAACT,MAAM,CAAC,CAAC;EAEZ,oBACIT,KAAA,CAAAsB,aAAA;IAAKV,SAAS,EAAEX,UAAU,CAAC,uBAAuB,EAAEW,SAAS;EAAE,GAC1DE,eAAe,GAAG,IAAI,gBAAGd,KAAA,CAAAsB,aAAA,CAAClB,mBAAmB,MAAE,CAAC,EAChDa,qBAAqB,gBAClBjB,KAAA,CAAAsB,aAAA,CAACjB,wBAAwB,MAAE,CAAC,gBAE5BL,KAAA,CAAAsB,aAAA,CAACpB,cAAc,EAAAqB,QAAA,KACPf,mBAAmB;IACvBK,OAAO,EAAEA,OAAQ;IACjBW,KAAK,EAAElB,QAAS;IAChBM,SAAS,EAAEX,UAAU,CAAC;MAAE,kCAAkC,EAAE,CAACa;IAAgB,CAAC,CAAE;IAChFW,YAAY,EAAEN,UAAW;IACzBV,MAAM,EAAEA,MAAO;IACfiB,OAAO,EAAEA,CAAA,KAAM;MACXX,kBAAkB,CAAC,IAAI,CAAC;MACxBG,wBAAwB,CAAC,IAAI,CAAC;IAClC,CAAE;IACFS,MAAM,EAAEA,CAAA,KAAM;MACV,IAAIR,UAAU,CAACS,OAAO,EAAE;QACpBT,UAAU,CAACS,OAAO,CAACC,SAAS,CAAC,CAAC,CAACC,qBAAqB,CAAC,CAAC;QACtDf,kBAAkB,CAAC,IAAI,CAAC;MAC5B;IACJ,CAAE;IACFL,UAAU,EAAEA,UAAW;IACvBqB,KAAK,EAAEA,CAAA,KAAMpB,QAAQ,CAACF,MAAM;EAAE,EACjC,CAEJ,CAAC;AAEd;AAEA,eAAeF,qBAAqB","ignoreList":[]}