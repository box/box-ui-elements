{"version":3,"file":"SharedLinkPermissionMenu.js","names":["React","Component","classNames","FormattedMessage","DropdownMenu","MenuToggle","LabelPill","PlainButton","Menu","SelectMenuItem","VIEW_SIZE_TYPE","withMediaQuery","CAN_EDIT","CAN_VIEW_DOWNLOAD","CAN_VIEW_ONLY","messages","SharedLinkPermissionMenu","constructor","args","_defineProperty","newPermissionLevel","changePermissionLevel","permissionLevel","trackingProps","props","onChangeSharedLinkPermissionLevel","render","allowedPermissionLevels","isSharedLinkEditTooltipShown","sharedLinkEditTagTargetingApi","sharedLinkEditTooltipTargetingApi","size","submitting","sharedLinkPermissionsMenuButtonProps","canShowTag","canShow","canShowTooltip","permissionLevels","label","createElement","sharedLinkPermissionsEdit","sharedLinkPermissionsViewDownload","sharedLinkPermissionsViewOnly","isRightAligned","small","medium","constrainToWindow","onMenuClose","includes","onComplete","onMenuOpen","onShow","_extends","className","disabled","type","map","level","key","isSelected","onClick","onChangePermissionLevel","Pill","Text","ftuxSharedLinkPermissionsEditTag","sharedLinkPermissionMenu","displayName","SharedLinkPermissionMenuBase"],"sources":["../../../src/features/unified-share-modal/SharedLinkPermissionMenu.js"],"sourcesContent":["// @flow\n\nimport React, { Component } from 'react';\nimport classNames from 'classnames';\nimport { FormattedMessage } from 'react-intl';\n\nimport DropdownMenu, { MenuToggle } from '../../components/dropdown-menu';\nimport LabelPill from '../../components/label-pill';\nimport PlainButton from '../../components/plain-button';\nimport { Menu, SelectMenuItem } from '../../components/menu';\nimport { VIEW_SIZE_TYPE } from '../../components/media-query/constants';\nimport withMediaQuery from '../../components/media-query/withMediaQuery';\nimport type { TargetingApi } from '../targeting/types';\n\nimport type { permissionLevelType } from './flowTypes';\nimport { CAN_EDIT, CAN_VIEW_DOWNLOAD, CAN_VIEW_ONLY } from './constants';\nimport messages from './messages';\n\nimport './SharedLinkPermissionMenu.scss';\n\ntype Props = {\n    allowedPermissionLevels: Array<permissionLevelType>,\n    canChangePermissionLevel: boolean,\n    changePermissionLevel: (\n        newPermissionLevel: permissionLevelType,\n    ) => Promise<{ permissionLevel: permissionLevelType }>,\n    isSharedLinkEditTooltipShown: boolean,\n    permissionLevel?: permissionLevelType,\n    sharedLinkEditTagTargetingApi?: TargetingApi,\n    sharedLinkEditTooltipTargetingApi?: TargetingApi,\n    size: string,\n    submitting: boolean,\n    trackingProps: {\n        onChangeSharedLinkPermissionLevel?: Function,\n        sharedLinkPermissionsMenuButtonProps?: Object,\n    },\n};\n\nclass SharedLinkPermissionMenu extends Component<Props> {\n    static defaultProps = {\n        trackingProps: {},\n    };\n\n    onChangePermissionLevel = (newPermissionLevel: permissionLevelType) => {\n        const { changePermissionLevel, permissionLevel, trackingProps } = this.props;\n        const { onChangeSharedLinkPermissionLevel } = trackingProps;\n\n        if (permissionLevel !== newPermissionLevel) {\n            changePermissionLevel(newPermissionLevel);\n\n            if (onChangeSharedLinkPermissionLevel) {\n                onChangeSharedLinkPermissionLevel(newPermissionLevel);\n            }\n        }\n    };\n\n    render() {\n        const {\n            allowedPermissionLevels,\n            isSharedLinkEditTooltipShown,\n            permissionLevel,\n            sharedLinkEditTagTargetingApi,\n            sharedLinkEditTooltipTargetingApi,\n            size,\n            submitting,\n            trackingProps,\n        } = this.props;\n        const { sharedLinkPermissionsMenuButtonProps } = trackingProps;\n        const canShowTag = sharedLinkEditTagTargetingApi ? sharedLinkEditTagTargetingApi.canShow : false;\n        const canShowTooltip = sharedLinkEditTooltipTargetingApi ? sharedLinkEditTooltipTargetingApi.canShow : false;\n\n        if (!permissionLevel) {\n            return null;\n        }\n\n        const permissionLevels = {\n            [CAN_EDIT]: {\n                label: <FormattedMessage {...messages.sharedLinkPermissionsEdit} />,\n            },\n            [CAN_VIEW_DOWNLOAD]: {\n                label: <FormattedMessage {...messages.sharedLinkPermissionsViewDownload} />,\n            },\n            [CAN_VIEW_ONLY]: {\n                label: <FormattedMessage {...messages.sharedLinkPermissionsViewOnly} />,\n            },\n        };\n\n        const isRightAligned = size === VIEW_SIZE_TYPE.small || size === VIEW_SIZE_TYPE.medium;\n\n        return (\n            <DropdownMenu\n                constrainToWindow\n                isRightAligned={isRightAligned}\n                onMenuClose={() => {\n                    if (allowedPermissionLevels.includes(CAN_EDIT) && canShowTag && sharedLinkEditTagTargetingApi) {\n                        sharedLinkEditTagTargetingApi.onComplete();\n                    }\n                }}\n                onMenuOpen={() => {\n                    if (allowedPermissionLevels.includes(CAN_EDIT) && canShowTag && sharedLinkEditTagTargetingApi) {\n                        sharedLinkEditTagTargetingApi.onShow();\n                    }\n\n                    // complete tooltip FTUX on opening of dropdown menu\n                    if (isSharedLinkEditTooltipShown && canShowTooltip && sharedLinkEditTooltipTargetingApi) {\n                        sharedLinkEditTooltipTargetingApi.onComplete();\n                    }\n                }}\n            >\n                <PlainButton\n                    className={classNames('lnk', {\n                        'is-disabled': submitting,\n                        'bdl-is-disabled': submitting,\n                    })}\n                    data-testid=\"usm-share-permissions-toggle\"\n                    disabled={submitting}\n                    type=\"button\"\n                    {...sharedLinkPermissionsMenuButtonProps}\n                >\n                    <MenuToggle>{permissionLevels[permissionLevel].label}</MenuToggle>\n                </PlainButton>\n                <Menu className=\"ums-share-permissions-menu\" data-testid=\"usm-share-permissions-menu\">\n                    {allowedPermissionLevels.map(level => (\n                        <SelectMenuItem\n                            key={level}\n                            isSelected={level === permissionLevel}\n                            onClick={() => this.onChangePermissionLevel(level)}\n                        >\n                            <div className=\"ums-share-permissions-menu-item\">\n                                <span>{permissionLevels[level].label}</span>\n                                {level === CAN_EDIT && canShowTag && (\n                                    <LabelPill.Pill className=\"ftux-editable-shared-link\" type=\"ftux\">\n                                        <LabelPill.Text>\n                                            <FormattedMessage {...messages.ftuxSharedLinkPermissionsEditTag} />\n                                        </LabelPill.Text>\n                                    </LabelPill.Pill>\n                                )}\n                            </div>\n                        </SelectMenuItem>\n                    ))}\n                </Menu>\n            </DropdownMenu>\n        );\n    }\n}\n\nconst sharedLinkPermissionMenu = withMediaQuery(SharedLinkPermissionMenu);\nsharedLinkPermissionMenu.displayName = 'SharedLinkPermissionMenu';\n\nexport { SharedLinkPermissionMenu as SharedLinkPermissionMenuBase };\nexport default sharedLinkPermissionMenu;\n"],"mappings":"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","ignoreList":[]}