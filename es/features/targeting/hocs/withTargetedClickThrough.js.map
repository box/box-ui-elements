{"version":3,"file":"withTargetedClickThrough.js","names":["React","useOnClickBody","withTargetedClickThrough","WrappedComponent","WrapperComponent","_ref","children","closeOnClickOutside","shouldTarget","useTargetingApi","onDismiss","rest","_objectWithoutProperties","_excluded","canShow","onComplete","onClose","onShow","handleClose","handleOnComplete","shouldShow","useEffect","createElement","_extends","showCloseButton","stopBubble","isShown","className","onClickCapture","onKeyPressCapture","tabIndex","displayName","name"],"sources":["../../../../src/features/targeting/hocs/withTargetedClickThrough.js"],"sourcesContent":["// @flow\nimport * as React from 'react';\n\nimport { useOnClickBody } from '../utils';\nimport { type TargetedComponentProps } from '../types';\n\nfunction withTargetedClickThrough<Config>(\n    WrappedComponent: React.ComponentType<Config>,\n): React.ComponentType<{|\n    ...Config,\n    ...$Exact<TargetedComponentProps>,\n|}> {\n    const WrapperComponent = ({\n        children,\n        closeOnClickOutside,\n        shouldTarget,\n        useTargetingApi,\n        onDismiss,\n        ...rest\n    }: {|\n        ...Config,\n        ...$Exact<TargetedComponentProps>,\n    |}) => {\n        const { canShow, onComplete, onClose, onShow } = useTargetingApi();\n\n        const handleClose = () => {\n            onClose();\n            if (onDismiss) {\n                // $FlowFixMe onDismiss should be declared in both inferred types, which is not true, because we declare props types as Union of Config & TargetedComponentProps\n                onDismiss();\n            }\n        };\n\n        const handleOnComplete = () => {\n            if (shouldTarget && canShow) {\n                onComplete();\n            }\n        };\n\n        const shouldShow = shouldTarget && canShow;\n\n        useOnClickBody(onClose, !!(shouldShow && closeOnClickOutside));\n\n        React.useEffect(() => {\n            if (shouldShow) {\n                onShow();\n            }\n        }, [shouldShow, onShow]);\n\n        return (\n            <WrappedComponent showCloseButton stopBubble {...rest} isShown={shouldShow} onDismiss={handleClose}>\n                <span\n                    className=\"bdl-targeted-click-through\"\n                    data-targeting=\"click-through\"\n                    data-testid=\"with-targeted-click-span\"\n                    onClickCapture={handleOnComplete}\n                    onKeyPressCapture={handleOnComplete}\n                    tabIndex={-1}\n                >\n                    {children}\n                </span>\n            </WrappedComponent>\n        );\n    };\n\n    WrapperComponent.displayName = `withTargetedClickThrough(${WrappedComponent.displayName ||\n        WrappedComponent.name ||\n        'Component'})`;\n\n    return WrapperComponent;\n}\n\nexport default withTargetedClickThrough;\n"],"mappings":";;;;AACA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAE9B,SAASC,cAAc,QAAQ,UAAU;AAGzC,SAASC,wBAAwBA,CAC7BC,gBAA6C,EAI7C;EACA,MAAMC,gBAAgB,GAAGC,IAAA,IAUlB;IAAA,IAVmB;QACtBC,QAAQ;QACRC,mBAAmB;QACnBC,YAAY;QACZC,eAAe;QACfC;MAKH,CAAC,GAAAL,IAAA;MAJKM,IAAI,GAAAC,wBAAA,CAAAP,IAAA,EAAAQ,SAAA;IAKP,MAAM;MAAEC,OAAO;MAAEC,UAAU;MAAEC,OAAO;MAAEC;IAAO,CAAC,GAAGR,eAAe,CAAC,CAAC;IAElE,MAAMS,WAAW,GAAGA,CAAA,KAAM;MACtBF,OAAO,CAAC,CAAC;MACT,IAAIN,SAAS,EAAE;QACX;QACAA,SAAS,CAAC,CAAC;MACf;IACJ,CAAC;IAED,MAAMS,gBAAgB,GAAGA,CAAA,KAAM;MAC3B,IAAIX,YAAY,IAAIM,OAAO,EAAE;QACzBC,UAAU,CAAC,CAAC;MAChB;IACJ,CAAC;IAED,MAAMK,UAAU,GAAGZ,YAAY,IAAIM,OAAO;IAE1Cb,cAAc,CAACe,OAAO,EAAE,CAAC,EAAEI,UAAU,IAAIb,mBAAmB,CAAC,CAAC;IAE9DP,KAAK,CAACqB,SAAS,CAAC,MAAM;MAClB,IAAID,UAAU,EAAE;QACZH,MAAM,CAAC,CAAC;MACZ;IACJ,CAAC,EAAE,CAACG,UAAU,EAAEH,MAAM,CAAC,CAAC;IAExB,oBACIjB,KAAA,CAAAsB,aAAA,CAACnB,gBAAgB,EAAAoB,QAAA;MAACC,eAAe;MAACC,UAAU;IAAA,GAAKd,IAAI;MAAEe,OAAO,EAAEN,UAAW;MAACV,SAAS,EAAEQ;IAAY,iBAC/FlB,KAAA,CAAAsB,aAAA;MACIK,SAAS,EAAC,4BAA4B;MACtC,kBAAe,eAAe;MAC9B,eAAY,0BAA0B;MACtCC,cAAc,EAAET,gBAAiB;MACjCU,iBAAiB,EAAEV,gBAAiB;MACpCW,QAAQ,EAAE,CAAC;IAAE,GAEZxB,QACC,CACQ,CAAC;EAE3B,CAAC;EAEDF,gBAAgB,CAAC2B,WAAW,GAAG,4BAA4B5B,gBAAgB,CAAC4B,WAAW,IACnF5B,gBAAgB,CAAC6B,IAAI,IACrB,WAAW,GAAG;EAElB,OAAO5B,gBAAgB;AAC3B;AAEA,eAAeF,wBAAwB","ignoreList":[]}