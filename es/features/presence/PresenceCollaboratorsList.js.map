{"version":3,"file":"PresenceCollaboratorsList.js","names":["React","classnames","PropTypes","throttle","FormattedMessage","injectIntl","Button","PresenceCollaborator","messages","PresenceCollaboratorsList","Component","constructor","args","_defineProperty","isScrollableAbove","isScrollableBelow","elem","scrollTop","scrollHeight","clientHeight","event","onScroll","props","elDropdownList","setState","calculateOverflow","handleScroll","leading","trailing","createElement","className","recentActivity","getLinkCallback","inviteCallback","onClick","getLinkButtonText","inviteButtonText","componentDidMount","overflow","componentDidUpdate","state","render","collaborators","buttonsPresent","dropdownListClasses","title","renderTitle","actions","renderActions","ref","list","throttledHandleScroll","role","map","collaborator","key","id","arrayOf","shape","avatarUrl","string","oneOfType","number","isActive","bool","interactedAt","interactionType","name","isRequired","profileUrl","func","intl","any","PresenceCollaboratorsListComponent"],"sources":["../../../src/features/presence/PresenceCollaboratorsList.js"],"sourcesContent":["import * as React from 'react';\nimport classnames from 'classnames';\nimport PropTypes from 'prop-types';\nimport throttle from 'lodash/throttle';\nimport { FormattedMessage, injectIntl } from 'react-intl';\n\nimport Button from '../../components/button';\nimport PresenceCollaborator from './PresenceCollaborator';\nimport messages from './messages';\n\nimport './PresenceCollaboratorsList.scss';\n\nclass PresenceCollaboratorsList extends React.Component<Props> {\n    static propTypes = {\n        collaborators: PropTypes.arrayOf(\n            PropTypes.shape({\n                /** Url to avatar image. If passed in, component will render the avatar image instead of the initials */\n                avatarUrl: PropTypes.string,\n                /** Users id */\n                id: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n                isActive: PropTypes.bool,\n                /** Unix timestamp of when the user last interacted with the document */\n                interactedAt: PropTypes.number,\n                /** The type of interaction by the user */\n                interactionType: PropTypes.string,\n                /** User's full name */\n                name: PropTypes.string.isRequired,\n                /** Custom Profile URL */\n                profileUrl: PropTypes.string,\n            }),\n        ).isRequired,\n        /* Get Link button callback. also controls visibility of button */\n        getLinkCallback: PropTypes.func,\n        /* Show Invite button callback. also controls visibility of button */\n        inviteCallback: PropTypes.func,\n        /* Callback for Dropdown onScroll event */\n        onScroll: PropTypes.func,\n        /* Intl object */\n        intl: PropTypes.any,\n    };\n\n    state = {\n        isScrollableAbove: false,\n        isScrollableBelow: false,\n    };\n\n    componentDidMount() {\n        const overflow = this.calculateOverflow(this.elDropdownList);\n        // eslint-disable-next-line react/no-did-mount-set-state\n        this.setState(overflow);\n    }\n\n    componentDidUpdate() {\n        const overflow = this.calculateOverflow(this.elDropdownList);\n        /**\n         * recalculate overflow when dropdown is visible and new collabs are added\n         * This will not go into an infinite loop because we check for changes in local component state\n         */\n        if (\n            overflow.isScrollableAbove !== this.state.isScrollableAbove ||\n            overflow.isScrollableBelow !== this.state.isScrollableBelow\n        ) {\n            // eslint-disable-next-line react/no-did-update-set-state\n            this.setState(overflow);\n        }\n    }\n\n    calculateOverflow = elem => {\n        const isScrollableAbove = elem.scrollTop > 0;\n        const isScrollableBelow = elem.scrollTop < elem.scrollHeight - elem.clientHeight;\n        return {\n            isScrollableAbove,\n            isScrollableBelow,\n        };\n    };\n\n    handleScroll = event => {\n        const { onScroll } = this.props;\n        if (this.elDropdownList) {\n            this.setState(this.calculateOverflow(this.elDropdownList));\n            if (onScroll) {\n                onScroll(event);\n            }\n        }\n    };\n\n    throttledHandleScroll = throttle(this.handleScroll, 50, {\n        leading: true,\n        trailing: true,\n    });\n\n    renderTitle = () => (\n        <div className=\"bdl-PresenceCollaboratorsList-title\">\n            <FormattedMessage {...messages.recentActivity} />\n        </div>\n    );\n\n    renderActions = () => {\n        const { getLinkCallback, inviteCallback } = this.props;\n\n        return (\n            (getLinkCallback || inviteCallback) && (\n                <div className=\"bdl-PresenceCollaboratorsList-actions\">\n                    <div>\n                        {getLinkCallback && (\n                            <Button onClick={getLinkCallback}>\n                                <FormattedMessage {...messages.getLinkButtonText} />\n                            </Button>\n                        )}\n                        {inviteCallback && (\n                            <Button onClick={inviteCallback}>\n                                <FormattedMessage {...messages.inviteButtonText} />\n                            </Button>\n                        )}\n                    </div>\n                </div>\n            )\n        );\n    };\n\n    render() {\n        const { isScrollableAbove, isScrollableBelow } = this.state;\n        const { collaborators, getLinkCallback, inviteCallback } = this.props;\n        const buttonsPresent = getLinkCallback || inviteCallback;\n\n        const dropdownListClasses = classnames('bdl-PresenceCollaboratorsList-list', {\n            'dropshadow-list': !buttonsPresent,\n            'dropshadow-list-with-buttons': buttonsPresent,\n            'is-scrollable-above': isScrollableAbove,\n            'is-scrollable-below': isScrollableBelow,\n        });\n\n        const title = this.renderTitle();\n        const actions = this.renderActions();\n\n        return (\n            <div className=\"bdl-PresenceCollaboratorsList\">\n                {title}\n                <div\n                    ref={list => {\n                        this.elDropdownList = list;\n                    }}\n                    className={dropdownListClasses}\n                    onScroll={this.throttledHandleScroll}\n                    role=\"list\"\n                >\n                    {collaborators.map(collaborator => (\n                        <PresenceCollaborator collaborator={collaborator} key={collaborator.id} role=\"listitem\" />\n                    ))}\n                </div>\n                {actions}\n            </div>\n        );\n    }\n}\n\nexport { PresenceCollaboratorsList as PresenceCollaboratorsListComponent };\nexport default injectIntl(PresenceCollaboratorsList);\n"],"mappings":"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","ignoreList":[]}