{"version":3,"file":"Item.js","names":["noop","setProp","getBadItemError","getBadPermissionsError","fillMissingProperties","Base","ACCESS_NONE","CACHE_PREFIX_SEARCH","CACHE_PREFIX_FOLDER","TYPE_FOLDER","ERROR_CODE_DELETE_ITEM","ERROR_CODE_RENAME_ITEM","ERROR_CODE_SHARE_ITEM","Item","constructor","args","_defineProperty","isDestroyed","parentKey","getParentCacheKey","parentId","folder","getCache","get","postDeleteCleanup","item_collection","entries","total_count","Array","isArray","childKey","getCacheKey","id","oldCount","length","newEntries","filter","entry","newCount","updatedObject","merge","_extends","successCallback","data","unsetAll","name","fields","dataWithMissingFields","cache","key","has","set","getUrl","cacheKey","value","deleteItem","item","errorCallback","Promise","reject","errorCode","permissions","parent","type","can_delete","url","xhr","delete","then","deleteSuccessHandler","catch","e","errorHandler","rename","can_rename","put","renameSuccessHandler","validateSharedLinkRequest","itemID","itemPermissions","canSkipSetShareAccessPermission","can_share","can_set_share_access","share","access","options","shared_link","sharedLink","undefined","requestData","params","toString","shareSuccessHandler","updateSharedLink","sharedLinkParams"],"sources":["../../src/api/Item.js"],"sourcesContent":["/**\n * @flow\n * @file Helper for the box item API\n * @author Box\n */\n\nimport noop from 'lodash/noop';\nimport setProp from 'lodash/set';\nimport { getBadItemError, getBadPermissionsError } from '../utils/error';\nimport { fillMissingProperties } from '../utils/fields';\nimport Base from './Base';\nimport {\n    ACCESS_NONE,\n    CACHE_PREFIX_SEARCH,\n    CACHE_PREFIX_FOLDER,\n    TYPE_FOLDER,\n    ERROR_CODE_DELETE_ITEM,\n    ERROR_CODE_RENAME_ITEM,\n    ERROR_CODE_SHARE_ITEM,\n} from '../constants';\nimport type { ElementsErrorCallback, RequestData, RequestOptions } from '../common/types/api';\nimport type {\n    Access,\n    BoxItem,\n    BoxItemPermission,\n    FlattenedBoxItem,\n    FlattenedBoxItemCollection,\n    SharedLink,\n} from '../common/types/core';\nimport type APICache from '../utils/Cache';\n\nclass Item extends Base {\n    /**\n     * @property {string}\n     */\n    id: string;\n\n    /**\n     * @property {string}\n     */\n    parentId: string;\n\n    /**\n     * @property {Function}\n     */\n    successCallback: Function;\n\n    /**\n     * @property {Function}\n     */\n    errorCallback: ElementsErrorCallback;\n\n    /**\n     * Creates a key for the item's parent\n     * This is always a folder\n     *\n     * @param {string} Id - folder id\n     * @return {string} Key\n     */\n    getParentCacheKey(id: string): string {\n        return `${CACHE_PREFIX_FOLDER}${id}`;\n    }\n\n    /**\n     * Creates a key for the cache\n     *\n     * @param {string} Id - Folder id\n     * @return {string} Key\n     */\n    getCacheKey(id: string): string {\n        return `getCacheKey(${id}) should be overriden`;\n    }\n\n    /**\n     * API URL for items\n     *\n     * @param {string} id - Item id\n     * @protected\n     * @return {string} Base url for files\n     */\n    getUrl(id: string): string {\n        return `getUrl(${id}) should be overriden`;\n    }\n\n    /**\n     * Merges new data with old data and returns new data\n     *\n     * @param {String} cacheKey - The cache key of item to merge\n     * @param {String} key - The attribute to merge\n     * @param {Object} value - The value to merge\n     * @return {BoxItem} The newly updated object from the cache\n     */\n    merge(cacheKey: string, key: string, value: any): BoxItem {\n        const cache: APICache = this.getCache();\n        cache.merge(cacheKey, setProp({}, key, value));\n        return cache.get(cacheKey);\n    }\n\n    /**\n     * Steps to do after deletion\n     *\n     * @return {void}\n     */\n    postDeleteCleanup(): void {\n        if (this.isDestroyed()) {\n            return;\n        }\n\n        // Get rid of all searches\n        this.getCache().unsetAll(CACHE_PREFIX_SEARCH);\n        this.successCallback();\n    }\n\n    /**\n     * Handles response for deletion\n     *\n     * @return {void}\n     */\n    deleteSuccessHandler = (): void => {\n        if (this.isDestroyed()) {\n            return;\n        }\n\n        // When fetching the parent folder from the cache\n        // we have no guarantees that it will be there since\n        // search results happen across folders and we only\n        // add those folders to cache that have been navigated to.\n        const parentKey: string = this.getParentCacheKey(this.parentId);\n        const folder: ?FlattenedBoxItem = this.getCache().get(parentKey);\n        if (!folder) {\n            this.postDeleteCleanup();\n            return;\n        }\n\n        // Same logic as above but in this case we may have the parent\n        // folders meta data in cache but not its contents.\n        const { item_collection }: FlattenedBoxItem = folder;\n        if (!item_collection) {\n            this.postDeleteCleanup();\n            return;\n        }\n\n        const { entries, total_count }: FlattenedBoxItemCollection = item_collection;\n        if (!Array.isArray(entries) || typeof total_count !== 'number') {\n            throw getBadItemError();\n        }\n\n        const childKey: string = this.getCacheKey(this.id);\n        const oldCount: number = entries.length;\n        const newEntries: string[] = entries.filter((entry: string) => entry !== childKey);\n        const newCount: number = newEntries.length;\n\n        const updatedObject: BoxItem = this.merge(\n            parentKey,\n            'item_collection',\n            Object.assign(item_collection, {\n                entries: newEntries,\n                total_count: total_count - (oldCount - newCount),\n            }),\n        );\n\n        this.successCallback(updatedObject);\n        this.postDeleteCleanup();\n    };\n\n    /**\n     * API to delete an Item\n     *\n     * @param {BoxItem} item - Item to delete\n     * @param {Function} successCallback - Success callback\n     * @param {Function} errorCallback - Error callback\n     * @return {void}\n     */\n    deleteItem(item: BoxItem, successCallback: Function, errorCallback: ElementsErrorCallback = noop): Promise<void> {\n        if (this.isDestroyed()) {\n            return Promise.reject();\n        }\n\n        this.errorCode = ERROR_CODE_DELETE_ITEM;\n        const { id, permissions, parent, type }: BoxItem = item;\n        if (!id || !permissions || !parent || !type) {\n            errorCallback(getBadItemError(), this.errorCode);\n            return Promise.reject();\n        }\n\n        const { id: parentId } = parent;\n        const { can_delete }: BoxItemPermission = permissions;\n        if (!can_delete || !parentId) {\n            errorCallback(getBadPermissionsError(), this.errorCode);\n            return Promise.reject();\n        }\n\n        this.id = id;\n        this.parentId = parentId;\n        this.successCallback = successCallback;\n        this.errorCallback = errorCallback;\n\n        const url = `${this.getUrl(id)}${type === TYPE_FOLDER ? '?recursive=true' : ''}`;\n        return this.xhr\n            .delete({ url })\n            .then(this.deleteSuccessHandler)\n            .catch((e: $AxiosError<any>) => {\n                this.errorHandler(e);\n            });\n    }\n\n    /**\n     * Handles response for rename\n     *\n     * @param {BoxItem} data - The updated item\n     * @return {void}\n     */\n    renameSuccessHandler = ({ data }: { data: BoxItem }): void => {\n        if (!this.isDestroyed()) {\n            // Get rid of all searches\n            this.getCache().unsetAll(CACHE_PREFIX_SEARCH);\n            const updatedObject: BoxItem = this.merge(this.getCacheKey(this.id), 'name', data.name);\n            this.successCallback(updatedObject);\n        }\n    };\n\n    /**\n     * API to rename an Item\n     *\n     * @param {BoxItem} item - Item to rename\n     * @param {string} name - Item new name\n     * @param {Function} successCallback - Success callback\n     * @param {Function} errorCallback - Error callback\n     * @return {void}\n     */\n    rename(\n        item: BoxItem,\n        name: string,\n        successCallback: Function,\n        errorCallback: ElementsErrorCallback = noop,\n    ): Promise<void> {\n        if (this.isDestroyed()) {\n            return Promise.reject();\n        }\n\n        this.errorCode = ERROR_CODE_RENAME_ITEM;\n        const { id, permissions }: BoxItem = item;\n        if (!id || !permissions) {\n            errorCallback(getBadItemError(), this.errorCode);\n            return Promise.reject();\n        }\n\n        const { can_rename }: BoxItemPermission = permissions;\n        if (!can_rename) {\n            errorCallback(getBadPermissionsError(), this.errorCode);\n            return Promise.reject();\n        }\n\n        this.id = id;\n        this.successCallback = successCallback;\n        this.errorCallback = errorCallback;\n\n        return this.xhr\n            .put({ url: `${this.getUrl(id)}`, data: { name } })\n            .then(this.renameSuccessHandler)\n            .catch((e: $AxiosError<any>) => {\n                this.errorHandler(e);\n            });\n    }\n\n    /**\n     * Handles response for shared link\n     *\n     * @param {BoxItem} data - The updated item\n     * @param {Array<string>} [fields] - Optional fields from request\n     * @return {void}\n     */\n    shareSuccessHandler = (data: BoxItem, fields?: Array<string>): void => {\n        if (!this.isDestroyed()) {\n            // Add fields that were requested but not returned\n            const dataWithMissingFields = fields ? fillMissingProperties(data, fields) : data;\n            const cache: APICache = this.getCache();\n            const key = this.getCacheKey(this.id);\n\n            if (cache.has(key)) {\n                cache.merge(key, dataWithMissingFields);\n            } else {\n                cache.set(key, dataWithMissingFields);\n            }\n            this.successCallback(cache.get(key));\n        }\n    };\n\n    /**\n     * Validate request to update an item shared link\n     *\n     * @param {string|void} itemID - ID of item to share\n     * @param {BoxItemPermission|void} itemPermissions - Permissions for item\n     * @param {boolean|void} canSkipSetShareAccessPermission - skip `can_set_share_access` permission check\n     * @throws {Error}\n     * @return {void}\n     */\n    validateSharedLinkRequest(\n        itemID: ?string,\n        itemPermissions: ?BoxItemPermission,\n        canSkipSetShareAccessPermission: boolean = false,\n    ) {\n        if (!itemID || !itemPermissions) {\n            this.errorCode = ERROR_CODE_SHARE_ITEM;\n            throw getBadItemError();\n        }\n\n        // It is sometimes necessary to skip `can_set_share_access` permission check\n        // e.g. Viewer permission can create shared links but cannot update access level\n        const { can_share, can_set_share_access }: BoxItemPermission = itemPermissions;\n        if (!can_share || (!canSkipSetShareAccessPermission && !can_set_share_access)) {\n            this.errorCode = ERROR_CODE_SHARE_ITEM;\n            throw getBadPermissionsError();\n        }\n    }\n\n    /**\n     * API to create, modify (change access), or remove a shared link\n     *\n     * @param {BoxItem} item - Item to share\n     * @param {Access} access - Shared access level\n     * @param {Function} successCallback - Success callback\n     * @param {Function|void} errorCallback - Error callback\n     * @param {Array<string>|void} [options.fields] - Optionally include specific fields\n     * @return {Promise<void>}\n     */\n    async share(\n        item: BoxItem,\n        access?: Access, // if \"access\" is undefined, the backend will set the default access level for the shared link\n        successCallback: Function,\n        errorCallback: ElementsErrorCallback = noop,\n        options: RequestOptions = {},\n    ): Promise<void> {\n        if (this.isDestroyed()) {\n            return Promise.reject();\n        }\n\n        try {\n            const { id, permissions, shared_link: sharedLink }: BoxItem = item;\n            this.id = id;\n            this.successCallback = successCallback;\n            this.errorCallback = errorCallback;\n\n            // skip permission check when creating links with default access level\n            const canSkipSetShareAccessPermission = !sharedLink && access === undefined;\n            this.validateSharedLinkRequest(id, permissions, canSkipSetShareAccessPermission);\n\n            const { fields } = options;\n            const requestData: RequestData = {\n                url: this.getUrl(this.id),\n                data: {\n                    shared_link: access === ACCESS_NONE ? null : { access },\n                },\n            };\n            if (fields) {\n                requestData.params = { fields: fields.toString() };\n            }\n\n            const { data } = await this.xhr.put(requestData);\n            return this.shareSuccessHandler(data, fields);\n        } catch (e) {\n            return this.errorHandler(e);\n        }\n    }\n\n    /**\n     * API to update a shared link\n     *\n     * @param {BoxItem} item - Item to update\n     * @param {$Shape<SharedLink>} sharedLinkParams - New shared link parameters\n     * @param {Function} successCallback - Success callback\n     * @param {Function|void} errorCallback - Error callback\n     * @param {Array<string>|void} [options.fields] - Optionally include specific fields\n     * @return {Promise<void>}\n     */\n    async updateSharedLink(\n        item: BoxItem,\n        sharedLinkParams: $Shape<SharedLink>,\n        successCallback: Function,\n        errorCallback: ElementsErrorCallback = noop,\n        options: RequestOptions = {},\n    ): Promise<void> {\n        if (this.isDestroyed()) {\n            return Promise.reject();\n        }\n\n        try {\n            const { id, permissions }: BoxItem = item;\n            this.id = id;\n            this.successCallback = successCallback;\n            this.errorCallback = errorCallback;\n\n            this.validateSharedLinkRequest(id, permissions);\n\n            const { fields } = options;\n            const requestData: RequestData = {\n                url: this.getUrl(this.id),\n                data: {\n                    shared_link: sharedLinkParams,\n                },\n            };\n            if (fields) {\n                requestData.params = { fields: fields.toString() };\n            }\n\n            const { data } = await this.xhr.put(requestData);\n            return this.shareSuccessHandler(data, fields);\n        } catch (e) {\n            return this.errorHandler(e);\n        }\n    }\n}\n\nexport default Item;\n"],"mappings":"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","ignoreList":[]}