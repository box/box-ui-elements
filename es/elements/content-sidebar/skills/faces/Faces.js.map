{"version":3,"file":"Faces.js","names":["React","FormattedMessage","classNames","PlainButton","PrimaryButton","LoadingIndicatorWrapper","InlineError","Tooltip","Button","IconEdit","messages","SKILLS_TARGETS","Face","Timeline","Faces","PureComponent","constructor","props","_defineProperty","setState","prevState","isEditing","face","selected","state","undefined","removes","push","slice","onSkillChange","toggleIsEditing","length","isLoading","resetState","faces","card","entries","hasError","render","isEditable","getViewer","duration","hasFaces","filter","includes","editClassName","createElement","className","text","editLabel","FACES","EDIT","onClick","type","title","sidebarSkillsErrorTitle","sidebarSkillsErrorContent","map","index","key","onDelete","onSelect","skillNoInfoFoundError","Array","isArray","appears","interactionTarget","TIMELINE","timeslices","EDIT_CANCEL","onCancel","cancel","EDIT_SAVE","onSave","save"],"sources":["../../../../../src/elements/content-sidebar/skills/faces/Faces.js"],"sourcesContent":["/**\n * @flow\n * @file Faces Skill Card component\n * @author Box\n */\n\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport classNames from 'classnames';\nimport PlainButton from '../../../../components/plain-button/PlainButton';\nimport PrimaryButton from '../../../../components/primary-button/PrimaryButton';\nimport LoadingIndicatorWrapper from '../../../../components/loading-indicator/LoadingIndicatorWrapper';\nimport InlineError from '../../../../components/inline-error/InlineError';\nimport Tooltip from '../../../../components/tooltip/Tooltip';\nimport Button from '../../../../components/button/Button';\nimport IconEdit from '../../../../icons/general/IconEdit';\nimport messages from '../../../common/messages';\nimport { SKILLS_TARGETS } from '../../../common/interactionTargets';\nimport Face from './Face';\nimport Timeline from '../timeline';\nimport type { SkillCardEntry, SkillCard } from '../../../../common/types/skills';\nimport './Faces.scss';\n\ntype Props = {\n    card: SkillCard,\n    getViewer?: Function,\n    hasError: boolean,\n    isEditable: boolean,\n    onSkillChange: Function,\n};\n\ntype State = {\n    faces: Array<SkillCardEntry>,\n    hasError: boolean,\n    isEditing: boolean,\n    isLoading: boolean,\n    removes: Array<SkillCardEntry>,\n    selected?: SkillCardEntry,\n};\n\nclass Faces extends React.PureComponent<Props, State> {\n    props: Props;\n\n    state: State;\n\n    /**\n     * [constructor]\n     *\n     * @public\n     * @return {Faces}\n     */\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            faces: props.card.entries,\n            removes: [],\n            isEditing: props.hasError,\n            hasError: props.hasError,\n            isLoading: false,\n        };\n    }\n\n    /**\n     * Helper to reset the state\n     *\n     * @private\n     * @param {Object} props - component props\n     * @return {void}\n     */\n    resetState(props: Props): void {\n        this.setState({\n            faces: props.card.entries,\n            removes: [],\n            isEditing: false,\n            selected: undefined,\n            hasError: false,\n            isLoading: false,\n        });\n    }\n\n    /**\n     * Toggles the edit mode\n     *\n     * @private\n     * @return {void}\n     */\n    toggleIsEditing = (): void => {\n        this.setState(prevState => ({\n            isEditing: !prevState.isEditing,\n        }));\n    };\n\n    /**\n     * Toggles face selection\n     *\n     * @private\n     * @return {void}\n     */\n    onSelect = (face: SkillCardEntry): void => {\n        const { selected } = this.state;\n        this.setState({\n            selected: selected === face ? undefined : face,\n        });\n    };\n\n    /**\n     * Deletes a face\n     *\n     * @private\n     * @return {void}\n     */\n    onDelete = (face: SkillCardEntry): void => {\n        const { removes } = this.state;\n        removes.push(face);\n        this.setState({ removes: removes.slice(0) });\n    };\n\n    /**\n     * Saves the new card data\n     *\n     * @private\n     * @return {void}\n     */\n    onSave = (): void => {\n        const { onSkillChange }: Props = this.props;\n        const { removes }: State = this.state;\n        this.toggleIsEditing();\n        if (removes.length > 0) {\n            this.setState({ isLoading: true });\n            onSkillChange(removes);\n        }\n    };\n\n    /**\n     * Cancels editing\n     *\n     * @private\n     * @return {void}\n     */\n    onCancel = (): void => {\n        this.resetState(this.props);\n    };\n\n    /**\n     * Renders the faces\n     *\n     * @private\n     * @return {void}\n     */\n    render() {\n        const { card, isEditable, getViewer }: Props = this.props;\n        const { selected, faces, removes, isEditing, hasError, isLoading }: State = this.state;\n        const { duration }: SkillCard = card;\n        const hasFaces = faces.length > 0;\n        const entries = faces.filter((face: SkillCardEntry) => !removes.includes(face));\n        const editClassName = classNames('be-face-edit', {\n            'be-faces-is-editing': isEditing,\n        });\n\n        return (\n            <LoadingIndicatorWrapper className=\"be-faces\" isLoading={isLoading}>\n                {hasFaces && isEditable && !isLoading && (\n                    <Tooltip text={<FormattedMessage {...messages.editLabel} />}>\n                        <PlainButton\n                            className={editClassName}\n                            data-resin-target={SKILLS_TARGETS.FACES.EDIT}\n                            onClick={this.toggleIsEditing}\n                            type=\"button\"\n                        >\n                            <IconEdit />\n                        </PlainButton>\n                    </Tooltip>\n                )}\n                {hasError && (\n                    <InlineError title={<FormattedMessage {...messages.sidebarSkillsErrorTitle} />}>\n                        <FormattedMessage {...messages.sidebarSkillsErrorContent} />\n                    </InlineError>\n                )}\n                {hasFaces ? (\n                    entries.map((face: SkillCardEntry, index: number) => (\n                        /* eslint-disable react/no-array-index-key */\n                        <Face\n                            key={index}\n                            face={face}\n                            isEditing={isEditing}\n                            onDelete={this.onDelete}\n                            onSelect={this.onSelect}\n                            selected={selected}\n                        />\n                        /* eslint-enable react/no-array-index-key */\n                    ))\n                ) : (\n                    <FormattedMessage {...messages.skillNoInfoFoundError} />\n                )}\n                {!!selected && !isEditing && Array.isArray(selected.appears) && selected.appears.length > 0 && (\n                    <Timeline\n                        duration={duration}\n                        getViewer={getViewer}\n                        interactionTarget={SKILLS_TARGETS.FACES.TIMELINE}\n                        timeslices={selected.appears}\n                    />\n                )}\n                {isEditing && (\n                    <div className=\"be-faces-buttons\">\n                        <Button\n                            data-resin-target={SKILLS_TARGETS.FACES.EDIT_CANCEL}\n                            onClick={this.onCancel}\n                            type=\"button\"\n                        >\n                            <FormattedMessage {...messages.cancel} />\n                        </Button>\n                        <PrimaryButton\n                            data-resin-target={SKILLS_TARGETS.FACES.EDIT_SAVE}\n                            onClick={this.onSave}\n                            type=\"button\"\n                        >\n                            <FormattedMessage {...messages.save} />\n                        </PrimaryButton>\n                    </div>\n                )}\n            </LoadingIndicatorWrapper>\n        );\n    }\n}\n\nexport default Faces;\n"],"mappings":"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","ignoreList":[]}