{"version":3,"file":"ItemList.js","names":["React","classNames","Table","Column","AutoSizer","KeyBinder","nameCellRenderer","iconCellRenderer","ItemOptions","isFocusableElement","focus","shareAccessCellRenderer","selectionCellRenderer","isRowSelectable","VIEW_SELECTED","FIELD_NAME","FIELD_ID","FIELD_SHARED_LINK","TYPE_FOLDER","moreOptionsCellRenderer","props","rowData","createElement","className","_extends","item","ItemList","view","rootId","isSmall","rootElement","focusedRow","selectableType","canSetShareAccess","hasHitSelectionLimit","isSingleSelect","extensionsWhitelist","onItemSelect","onItemClick","onShareAccessChange","onFocusChange","currentCollection","tableRef","itemActions","iconCell","nameCell","selectionCell","shareAccessCell","moreOptionsCell","id","items","rowCount","length","rowClassName","index","selected","type","isSelectable","onRowClick","event","target","columnCount","onSelect","onOpen","scrollToRow","onScrollToChange","onSectionRendered","focusOnRender","width","height","disableHeader","headerHeight","rowHeight","rowGetter","ref","scrollToIndex","onRowsRendered","startIndex","stopIndex","rowStartIndex","rowStopIndex","dataKey","cellRenderer","flexShrink","flexGrow","disableSort","headerRole"],"sources":["../../../src/elements/content-picker/ItemList.js"],"sourcesContent":["/**\n * @flow\n * @file Item list component\n * @author Box\n */\n\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport { Table, Column } from '@box/react-virtualized/dist/es/Table';\nimport AutoSizer from '@box/react-virtualized/dist/es/AutoSizer';\nimport KeyBinder from '../common/KeyBinder';\nimport nameCellRenderer from '../common/item/nameCellRenderer';\nimport iconCellRenderer from '../common/item/iconCellRenderer';\n// $FlowFixMe TypeScript file\nimport { ItemOptions, type ItemAction } from '../common/item';\nimport { isFocusableElement, focus } from '../../utils/dom';\nimport shareAccessCellRenderer from './shareAccessCellRenderer';\nimport selectionCellRenderer from './selectionCellRenderer';\nimport isRowSelectable from './cellRendererHelper';\nimport { VIEW_SELECTED, FIELD_NAME, FIELD_ID, FIELD_SHARED_LINK, TYPE_FOLDER } from '../../constants';\nimport type { View, Collection, BoxItem } from '../../common/types/core';\nimport '@box/react-virtualized/styles.css';\nimport './ItemList.scss';\n\ntype Props = {\n    canSetShareAccess: boolean,\n    currentCollection: Collection,\n    extensionsWhitelist: string[],\n    focusedRow: number,\n    hasHitSelectionLimit: boolean,\n    isSingleSelect: boolean,\n    isSmall: boolean,\n    itemActions?: ItemAction[],\n    onFocusChange: Function,\n    onItemClick: Function,\n    onItemSelect: Function,\n    onShareAccessChange: Function,\n    rootElement?: HTMLElement,\n    rootId: string,\n    selectableType: string,\n    tableRef: Function,\n    view: View,\n};\n\nconst moreOptionsCellRenderer =\n    props =>\n    ({ rowData }) => (\n        <div className=\"bcp-more-options\">\n            <ItemOptions item={rowData} {...props} />\n        </div>\n    );\n\nconst ItemList = ({\n    view,\n    rootId,\n    isSmall,\n    rootElement,\n    focusedRow,\n    selectableType,\n    canSetShareAccess,\n    hasHitSelectionLimit,\n    isSingleSelect,\n    extensionsWhitelist,\n    onItemSelect,\n    onItemClick,\n    onShareAccessChange,\n    onFocusChange,\n    currentCollection,\n    tableRef,\n    itemActions,\n}: Props) => {\n    const iconCell = iconCellRenderer();\n    const nameCell = nameCellRenderer(rootId, view, onItemClick);\n    const selectionCell = selectionCellRenderer(\n        onItemSelect,\n        selectableType,\n        extensionsWhitelist,\n        hasHitSelectionLimit,\n        isSingleSelect,\n    );\n    const shareAccessCell = shareAccessCellRenderer(\n        onShareAccessChange,\n        canSetShareAccess,\n        selectableType,\n        extensionsWhitelist,\n        hasHitSelectionLimit,\n    );\n    const moreOptionsCell = moreOptionsCellRenderer({\n        itemActions,\n    });\n    const { id, items = [] }: Collection = currentCollection;\n    const rowCount: number = items.length;\n\n    const rowClassName = ({ index }) => {\n        if (index === -1) {\n            return '';\n        }\n\n        const { selected, type } = items[index];\n        const isSelectable = isRowSelectable(selectableType, extensionsWhitelist, hasHitSelectionLimit, items[index]);\n        return classNames(`bcp-item-row bcp-item-row-${index}`, {\n            'bcp-item-row-selected': selected && view !== VIEW_SELECTED,\n            'bcp-item-row-unselectable': type !== TYPE_FOLDER && !isSelectable, // folder row should never dim\n        });\n    };\n\n    const onRowClick = ({\n        event,\n        rowData,\n        index,\n    }: {\n        event: Event & { target: HTMLElement },\n        index: number,\n        rowData: BoxItem,\n    }) => {\n        // If the click is happening on a clickable element on the item row, ignore row selection\n        if (\n            isRowSelectable(selectableType, extensionsWhitelist, hasHitSelectionLimit, rowData) &&\n            !isFocusableElement(event.target)\n        ) {\n            onItemSelect(rowData);\n        } else {\n            onFocusChange(index);\n        }\n    };\n\n    return (\n        <KeyBinder\n            columnCount={1}\n            rowCount={rowCount}\n            className=\"bcp-item-grid\"\n            id={id}\n            items={items}\n            onSelect={onItemSelect}\n            onOpen={onItemClick}\n            scrollToRow={focusedRow}\n            onScrollToChange={({ scrollToRow }) => focus(rootElement, `.bcp-item-row-${scrollToRow}`)}\n        >\n            {({ onSectionRendered, scrollToRow, focusOnRender }) => (\n                <AutoSizer>\n                    {({ width, height }) => (\n                        <Table\n                            width={width}\n                            height={height}\n                            disableHeader\n                            headerHeight={0}\n                            rowHeight={isSmall ? 70 : 50}\n                            rowCount={rowCount}\n                            rowGetter={({ index }) => items[index]}\n                            ref={tableRef}\n                            rowClassName={rowClassName}\n                            onRowClick={onRowClick}\n                            scrollToIndex={scrollToRow}\n                            onRowsRendered={({ startIndex, stopIndex }) => {\n                                onSectionRendered({\n                                    rowStartIndex: startIndex,\n                                    rowStopIndex: stopIndex,\n                                });\n                                if (focusOnRender) {\n                                    focus(rootElement, `.bcp-item-row-${scrollToRow}`);\n                                }\n                            }}\n                        >\n                            <Column\n                                dataKey={FIELD_ID}\n                                cellRenderer={iconCell}\n                                width={isSmall ? 30 : 50}\n                                flexShrink={0}\n                            />\n                            <Column dataKey={FIELD_NAME} cellRenderer={nameCell} width={300} flexGrow={1} />\n                            {isSmall ? null : (\n                                <Column\n                                    dataKey={FIELD_SHARED_LINK}\n                                    cellRenderer={shareAccessCell}\n                                    width={260}\n                                    flexShrink={0}\n                                />\n                            )}\n                            {!!itemActions?.length && (\n                                <Column\n                                    disableSort\n                                    dataKey={FIELD_ID}\n                                    cellRenderer={moreOptionsCell}\n                                    headerRole=\"gridcell\"\n                                    width={58}\n                                    flexShrink={0}\n                                />\n                            )}\n                            <Column\n                                dataKey={FIELD_ID}\n                                cellRenderer={selectionCell}\n                                width={isSmall ? 20 : 30}\n                                flexShrink={0}\n                            />\n                        </Table>\n                    )}\n                </AutoSizer>\n            )}\n        </KeyBinder>\n    );\n};\n\nexport default ItemList;\n"],"mappings":"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","ignoreList":[]}