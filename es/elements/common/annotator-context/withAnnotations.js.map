{"version":3,"file":"withAnnotations.js","names":["React","getProp","generatePath","matchPath","AnnotatorContext","isFeatureEnabled","Action","Status","FeedEntryType","ANNOTATIONS_PATH","defaultState","action","activeAnnotationFileVersionId","activeAnnotationId","annotation","annotationReply","error","meta","withAnnotations","WrappedComponent","ComponentWithAnnotations","Component","constructor","props","_defineProperty","id","annotator","emit","isStartEvent","event","reply","requestId","annotationId","eventData","onError","showNotification","setState","_objectSpread","state","getAction","getDeleteAction","getUpdateAction","getReplyCreateAction","getReplyDeleteAction","getReplyUpdateAction","fileVersionId","addListener","handleActiveChange","handleAnnotationCreate","handleAnnotationDelete","handleAnnotationFetchError","handleAnnotationUpdate","handleAnnotationReplyCreate","handleAnnotationReplyDelete","handleAnnotationReplyUpdate","shouldReset","removeListener","routerDisabled","sidebarNavigation","isRouterDisabled","features","activeFeedEntryType","ANNOTATIONS","activeFeedEntryId","location","match","getMatchPath","status","SUCCESS","CREATE_END","CREATE_START","DELETE_END","DELETE_START","UPDATE_END","UPDATE_START","REPLY_CREATE_END","REPLY_CREATE_START","REPLY_DELETE_END","REPLY_DELETE_START","REPLY_UPDATE_END","REPLY_UPDATE_START","getAnnotationsPath","sidebar","undefined","pathname","path","exact","render","annotationsRouterProps","getAnnotationsMatchPath","createElement","Provider","value","emitActiveAnnotationChangeEvent","emitAnnotationRemoveEvent","emitAnnotationReplyCreateEvent","emitAnnotationReplyDeleteEvent","emitAnnotationReplyUpdateEvent","emitAnnotationUpdateEvent","_extends","onAnnotator","handleAnnotator","onPreviewDestroy","handlePreviewDestroy","displayName","name"],"sources":["../../../../src/elements/common/annotator-context/withAnnotations.tsx"],"sourcesContent":["import * as React from 'react';\nimport getProp from 'lodash/get';\nimport { generatePath, match as matchType, matchPath } from 'react-router-dom';\nimport { Location } from 'history';\nimport AnnotatorContext from './AnnotatorContext';\nimport { isFeatureEnabled, type FeatureConfig } from '../feature-checking';\nimport { Action, Annotator, AnnotationActionEvent, AnnotatorState, GetMatchPath, MatchParams, Status } from './types';\nimport { FeedEntryType, SidebarNavigation } from '../types/SidebarNavigation';\n\nexport type ActiveChangeEvent = {\n    annotationId: string | null;\n    fileVersionId: string;\n};\n\nexport type ActiveChangeEventHandler = (event: ActiveChangeEvent) => void;\n\nexport type ComponentWithAnnotations = {\n    emitActiveAnnotationChangeEvent: (id: string | null) => void;\n    emitAnnotationRemoveEvent: (id: string, isStartEvent?: boolean) => void;\n    emitAnnotationReplyCreateEvent: (\n        reply: Object,\n        requestId: string,\n        annotationId: string,\n        isStartEvent?: boolean,\n    ) => void;\n    emitAnnotationReplyDeleteEvent: (id: string, annotationId: string, isStartEvent?: boolean) => void;\n    emitAnnotationReplyUpdateEvent: (reply: Object, annotationId: string, isStartEvent?: boolean) => void;\n    emitAnnotationUpdateEvent: (annotation: Object, isStartEvent?: boolean) => void;\n    getAction: (eventData: AnnotationActionEvent) => Action;\n    getAnnotationsPath: (fileVersionId?: string, annotationId?: string | null) => string;\n    getMatchPath: GetMatchPath;\n    handleActiveChange: ActiveChangeEventHandler;\n    handleAnnotationChangeEvent: (id: string | null) => void;\n    handleAnnotationCreate: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationDelete: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationFetchError: ({ error }: { error: Error }) => void;\n    handleAnnotationReplyCreate: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationReplyDelete: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationReplyUpdate: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationUpdate: (eventData: AnnotationActionEvent) => void;\n    handleAnnotator: (annotator: Annotator) => void;\n    handlePreviewDestroy: (shouldReset?: boolean) => void;\n};\n\nexport type WithAnnotationsProps = {\n    features?: FeatureConfig;\n    location?: Location;\n    onAnnotator: (annotator: Annotator) => void;\n    onError?: (error: Error, code: string, contextInfo?: Record<string, unknown>) => void;\n    onPreviewDestroy: (shouldReset?: boolean) => void;\n    routerDisabled?: boolean;\n    sidebarNavigation?: SidebarNavigation;\n};\n\nexport type WithAnnotationsComponent<P> = React.ComponentClass<P & WithAnnotationsProps>;\n\nconst ANNOTATIONS_PATH = '/:sidebar/annotations/:fileVersionId/:annotationId?';\nconst defaultState: AnnotatorState = {\n    action: null,\n    activeAnnotationFileVersionId: null,\n    activeAnnotationId: null,\n    annotation: null,\n    annotationReply: null,\n    error: null,\n    meta: null,\n};\n\nexport default function withAnnotations<P extends object>(\n    WrappedComponent: React.ComponentType<P>,\n): WithAnnotationsComponent<P> {\n    class ComponentWithAnnotations extends React.Component<P & WithAnnotationsProps, AnnotatorState> {\n        static displayName: string;\n\n        annotator: Annotator | null = null;\n\n        constructor(props: P & WithAnnotationsProps) {\n            super(props);\n\n            const { routerDisabled, sidebarNavigation } = props;\n            let activeAnnotationId = null;\n\n            const isRouterDisabled = routerDisabled || isFeatureEnabled(props?.features, 'routerDisabled.value');\n\n            if (isRouterDisabled) {\n                if (\n                    sidebarNavigation &&\n                    'activeFeedEntryType' in sidebarNavigation &&\n                    sidebarNavigation.activeFeedEntryType === FeedEntryType.ANNOTATIONS &&\n                    'activeFeedEntryId' in sidebarNavigation\n                ) {\n                    activeAnnotationId = sidebarNavigation.activeFeedEntryId;\n                }\n            } else {\n                // Determine by url if there is already a deeply linked annotation\n                const { location } = props;\n                const match = this.getMatchPath(location);\n                activeAnnotationId = getProp(match, 'params.annotationId', null);\n            }\n\n            // Seed the initial state with the activeAnnotationId if any from the location path\n            this.state = { ...defaultState, activeAnnotationId };\n        }\n\n        emitActiveAnnotationChangeEvent = (id: string | null) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            annotator.emit('annotations_active_set', id);\n        };\n\n        emitAnnotationRemoveEvent = (id: string, isStartEvent = false) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            // Event name does not include \"sidebar\" namespace because of backwards compatibility with Preview\n            const event = isStartEvent ? 'annotations_remove_start' : 'annotations_remove';\n\n            annotator.emit(event, id);\n        };\n\n        emitAnnotationUpdateEvent = (annotation: Object, isStartEvent = false) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            const event = isStartEvent ? 'sidebar.annotations_update_start' : 'sidebar.annotations_update';\n\n            annotator.emit(event, annotation);\n        };\n\n        emitAnnotationReplyCreateEvent = (\n            reply: Object,\n            requestId: string,\n            annotationId: string,\n            isStartEvent = false,\n        ) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            const event = isStartEvent ? 'sidebar.annotations_reply_create_start' : 'sidebar.annotations_reply_create';\n\n            annotator.emit(event, { annotationId, reply, requestId });\n        };\n\n        emitAnnotationReplyDeleteEvent = (id: string, annotationId: string, isStartEvent = false) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            const event = isStartEvent ? 'sidebar.annotations_reply_delete_start' : 'sidebar.annotations_reply_delete';\n\n            annotator.emit(event, { annotationId, id });\n        };\n\n        emitAnnotationReplyUpdateEvent = (reply: Object, annotationId: string, isStartEvent = false) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            const event = isStartEvent ? 'sidebar.annotations_reply_update_start' : 'sidebar.annotations_reply_update';\n\n            annotator.emit(event, { annotationId, reply });\n        };\n\n        getAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.CREATE_END : Action.CREATE_START;\n        }\n\n        getDeleteAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.DELETE_END : Action.DELETE_START;\n        }\n\n        getUpdateAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.UPDATE_END : Action.UPDATE_START;\n        }\n\n        getReplyCreateAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.REPLY_CREATE_END : Action.REPLY_CREATE_START;\n        }\n\n        getReplyDeleteAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.REPLY_DELETE_END : Action.REPLY_DELETE_START;\n        }\n\n        getReplyUpdateAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.REPLY_UPDATE_END : Action.REPLY_UPDATE_START;\n        }\n\n        getAnnotationsPath(fileVersionId?: string, annotationId?: string | null): string {\n            if (!fileVersionId) {\n                return '/activity';\n            }\n\n            return generatePath(ANNOTATIONS_PATH, {\n                sidebar: 'activity',\n                annotationId: annotationId || undefined,\n                fileVersionId,\n            });\n        }\n\n        // remove this method with routerDisabled switch\n        getMatchPath(location?: Location): matchType<MatchParams> | null {\n            const pathname = getProp(location, 'pathname', '');\n            return matchPath<MatchParams>(pathname, {\n                path: ANNOTATIONS_PATH,\n                exact: true,\n            });\n        }\n\n        handleAnnotationCreate = (eventData: AnnotationActionEvent): void => {\n            const { annotation = null, error = null, meta = null } = eventData;\n            const { onError } = this.props;\n\n            if (onError && error) {\n                onError(error, 'create_annotation_error', { showNotification: true });\n            }\n\n            this.setState({\n                ...this.state,\n                action: this.getAction(eventData),\n                annotation,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationDelete = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getDeleteAction(eventData),\n                annotation,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationUpdate = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getUpdateAction(eventData),\n                annotation,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationReplyCreate = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, annotationReply = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getReplyCreateAction(eventData),\n                annotation,\n                annotationReply,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationReplyDelete = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, annotationReply = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getReplyDeleteAction(eventData),\n                annotation,\n                annotationReply,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationReplyUpdate = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, annotationReply = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getReplyUpdateAction(eventData),\n                annotation,\n                annotationReply,\n                error,\n                meta,\n            });\n        };\n\n        handleActiveChange: ActiveChangeEventHandler = ({ annotationId, fileVersionId }): void => {\n            this.setState({ activeAnnotationFileVersionId: fileVersionId, activeAnnotationId: annotationId });\n        };\n\n        handleAnnotationFetchError = ({ error }: { error: Error }): void => {\n            const { onError } = this.props;\n\n            if (onError && error) {\n                onError(error, 'fetch_annotations_error', { showNotification: true });\n            }\n        };\n\n        handleAnnotator = (annotator: Annotator): void => {\n            this.annotator = annotator;\n            this.annotator.addListener('annotations_active_change', this.handleActiveChange);\n            this.annotator.addListener('annotations_create', this.handleAnnotationCreate);\n            this.annotator.addListener('annotations_delete', this.handleAnnotationDelete);\n            this.annotator.addListener('annotations_fetch_error', this.handleAnnotationFetchError);\n            this.annotator.addListener('annotations_update', this.handleAnnotationUpdate);\n            this.annotator.addListener('annotations_reply_create', this.handleAnnotationReplyCreate);\n            this.annotator.addListener('annotations_reply_delete', this.handleAnnotationReplyDelete);\n            this.annotator.addListener('annotations_reply_update', this.handleAnnotationReplyUpdate);\n        };\n\n        handlePreviewDestroy = (shouldReset = true): void => {\n            if (shouldReset) {\n                this.setState(defaultState);\n            }\n\n            if (this.annotator) {\n                this.annotator.removeListener('annotations_active_change', this.handleActiveChange);\n                this.annotator.removeListener('annotations_create', this.handleAnnotationCreate);\n                this.annotator.removeListener('annotations_delete', this.handleAnnotationDelete);\n                this.annotator.removeListener('annotations_fetch_error', this.handleAnnotationFetchError);\n                this.annotator.removeListener('annotations_update', this.handleAnnotationUpdate);\n                this.annotator.removeListener('annotations_reply_create', this.handleAnnotationReplyCreate);\n                this.annotator.removeListener('annotations_reply_delete', this.handleAnnotationReplyDelete);\n                this.annotator.removeListener('annotations_reply_update', this.handleAnnotationReplyUpdate);\n            }\n\n            this.annotator = null;\n        };\n\n        render(): JSX.Element {\n            const isRouterDisabled =\n                this.props?.routerDisabled || isFeatureEnabled(this.props?.features, 'routerDisabled.value');\n            const annotationsRouterProps = isRouterDisabled\n                ? {}\n                : {\n                      getAnnotationsMatchPath: this.getMatchPath,\n                      getAnnotationsPath: this.getAnnotationsPath,\n                  };\n            return (\n                <AnnotatorContext.Provider\n                    value={{\n                        emitActiveAnnotationChangeEvent: this.emitActiveAnnotationChangeEvent,\n                        emitAnnotationRemoveEvent: this.emitAnnotationRemoveEvent,\n                        emitAnnotationReplyCreateEvent: this.emitAnnotationReplyCreateEvent,\n                        emitAnnotationReplyDeleteEvent: this.emitAnnotationReplyDeleteEvent,\n                        emitAnnotationReplyUpdateEvent: this.emitAnnotationReplyUpdateEvent,\n                        emitAnnotationUpdateEvent: this.emitAnnotationUpdateEvent,\n                        ...annotationsRouterProps,\n                        state: this.state,\n                    }}\n                >\n                    <WrappedComponent\n                        {...this.props}\n                        onAnnotator={this.handleAnnotator}\n                        onPreviewDestroy={this.handlePreviewDestroy}\n                    />\n                </AnnotatorContext.Provider>\n            );\n        }\n    }\n\n    const displayName = WrappedComponent.displayName || WrappedComponent.name || 'Component';\n    ComponentWithAnnotations.displayName = `WithAnnotations(${displayName})`;\n\n    return ComponentWithAnnotations;\n}\n"],"mappings":"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","ignoreList":[]}