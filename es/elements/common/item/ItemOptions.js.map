{"version":3,"file":"ItemOptions.js","names":["React","useIntl","noop","ActionCell","Cell","DropdownMenu","GridList","IconButton","Ellipsis","Browser","PERMISSION_CAN_DELETE","PERMISSION_CAN_DOWNLOAD","PERMISSION_CAN_PREVIEW","PERMISSION_CAN_RENAME","PERMISSION_CAN_SHARE","TYPE_FILE","TYPE_WEBLINK","VIEW_MODE_GRID","VIEW_MODE_LIST","messages","ItemOptions","canDelete","canDownload","canPreview","canRename","canShare","item","itemActions","onItemDelete","onItemDownload","onItemPreview","onItemRename","onItemShare","portalElement","viewMode","permissions","type","itemType","formatMessage","isListView","isGridView","createElement","isDeleteEnabled","isDownloadEnabled","isOpenEnabled","isPreviewEnabled","isRenameEnabled","isShareEnabled","actions","reduce","validActions","action","filter","actionFilter","label","actionLabel","onAction","actionType","Item","key","onClick","hasActions","length","hasOptions","iconButtonProps","onPointerDown","event","stopPropagation","size","OptionsGroup","Actions","OptionsTrigger","ActionIconButton","optionsTriggerProps","OptionsDropdownMenu","onOpenChange","Root","Trigger","_extends","moreOptions","icon","Content","align","container","preview","open","delete","download","rename","share","Separator"],"sources":["../../../../src/elements/common/item/ItemOptions.tsx"],"sourcesContent":["import React from 'react';\nimport { useIntl } from 'react-intl';\nimport noop from 'lodash/noop';\n\nimport { ActionCell, Cell, DropdownMenu, GridList, IconButton } from '@box/blueprint-web';\nimport { Ellipsis } from '@box/blueprint-web-assets/icons/Fill';\nimport type { IconButtonProps } from '@box/blueprint-web';\n\nimport Browser from '../../../utils/Browser';\n\nimport {\n    PERMISSION_CAN_DELETE,\n    PERMISSION_CAN_DOWNLOAD,\n    PERMISSION_CAN_PREVIEW,\n    PERMISSION_CAN_RENAME,\n    PERMISSION_CAN_SHARE,\n    TYPE_FILE,\n    TYPE_WEBLINK,\n    VIEW_MODE_GRID,\n    VIEW_MODE_LIST,\n} from '../../../constants';\n\nimport messages from '../messages';\n\nimport type { BoxItem } from '../../../common/types/core';\nimport type { ItemAction, ItemEventHandlers, ItemEventPermissions } from './types';\n\nexport interface ItemOptionsProps extends ItemEventHandlers, ItemEventPermissions {\n    item: BoxItem;\n    itemActions?: ItemAction[];\n    portalElement?: HTMLElement;\n    viewMode?: VIEW_MODE_GRID | VIEW_MODE_LIST;\n}\n\nconst ItemOptions = ({\n    canDelete = false,\n    canDownload = false,\n    canPreview = false,\n    canRename = false,\n    canShare = false,\n    item,\n    itemActions = [],\n    onItemDelete = noop,\n    onItemDownload = noop,\n    onItemPreview = noop,\n    onItemRename = noop,\n    onItemShare = noop,\n    portalElement,\n    viewMode,\n}: ItemOptionsProps) => {\n    const { permissions, type: itemType } = item;\n    const { formatMessage } = useIntl();\n\n    const isListView = viewMode === VIEW_MODE_LIST;\n    const isGridView = viewMode === VIEW_MODE_GRID;\n\n    if (!permissions) {\n        return isListView ? <Cell /> : null;\n    }\n\n    const isDeleteEnabled = canDelete && permissions[PERMISSION_CAN_DELETE];\n    const isDownloadEnabled =\n        itemType === TYPE_FILE && canDownload && permissions[PERMISSION_CAN_DOWNLOAD] && Browser.canDownload();\n    const isOpenEnabled = itemType === TYPE_WEBLINK;\n    const isPreviewEnabled = itemType === TYPE_FILE && canPreview && permissions[PERMISSION_CAN_PREVIEW];\n    const isRenameEnabled = canRename && permissions[PERMISSION_CAN_RENAME];\n    const isShareEnabled = canShare && permissions[PERMISSION_CAN_SHARE];\n\n    const actions = itemActions.reduce((validActions, action) => {\n        const { filter: actionFilter, label: actionLabel, onAction, type: actionType } = action;\n\n        if (actionType && actionType !== itemType) {\n            return validActions;\n        }\n\n        if (actionFilter && !actionFilter(item)) {\n            return validActions;\n        }\n\n        return [\n            ...validActions,\n            <DropdownMenu.Item key={actionLabel + actionType} onClick={() => onAction(item)}>\n                {actionLabel}\n            </DropdownMenu.Item>,\n        ];\n    }, []);\n\n    const hasActions = !!actions.length;\n    const hasOptions =\n        isDeleteEnabled || isDownloadEnabled || isOpenEnabled || isPreviewEnabled || isRenameEnabled || isShareEnabled;\n\n    if (!hasActions && !hasOptions) {\n        return isListView ? <Cell /> : null;\n    }\n\n    const iconButtonProps = {\n        onPointerDown: event => {\n            event.stopPropagation();\n        },\n        size: 'large',\n    };\n\n    const OptionsGroup = isGridView ? GridList.Actions : ActionCell;\n    const OptionsTrigger = isGridView ? GridList.ActionIconButton : IconButton;\n    const optionsTriggerProps = isGridView ? {} : iconButtonProps;\n\n    const OptionsDropdownMenu = ({ onOpenChange = noop }) => (\n        <DropdownMenu.Root onOpenChange={onOpenChange}>\n            <DropdownMenu.Trigger>\n                <OptionsTrigger\n                    aria-label={formatMessage(messages.moreOptions)}\n                    icon={Ellipsis}\n                    {...(optionsTriggerProps as IconButtonProps)}\n                />\n            </DropdownMenu.Trigger>\n            <DropdownMenu.Content align=\"end\" container={portalElement}>\n                {isPreviewEnabled && (\n                    <DropdownMenu.Item onClick={() => onItemPreview(item)}>\n                        {formatMessage(messages.preview)}\n                    </DropdownMenu.Item>\n                )}\n                {isOpenEnabled && (\n                    <DropdownMenu.Item onClick={() => onItemPreview(item)}>\n                        {formatMessage(messages.open)}\n                    </DropdownMenu.Item>\n                )}\n                {isDeleteEnabled && (\n                    <DropdownMenu.Item onClick={() => onItemDelete(item)}>\n                        {formatMessage(messages.delete)}\n                    </DropdownMenu.Item>\n                )}\n                {isDownloadEnabled && (\n                    <DropdownMenu.Item onClick={() => onItemDownload(item)}>\n                        {formatMessage(messages.download)}\n                    </DropdownMenu.Item>\n                )}\n                {isRenameEnabled && (\n                    <DropdownMenu.Item onClick={() => onItemRename(item)}>\n                        {formatMessage(messages.rename)}\n                    </DropdownMenu.Item>\n                )}\n                {isShareEnabled && (\n                    <DropdownMenu.Item onClick={() => onItemShare(item)}>\n                        {formatMessage(messages.share)}\n                    </DropdownMenu.Item>\n                )}\n                {hasActions && hasOptions && <DropdownMenu.Separator />}\n                {hasActions && actions}\n            </DropdownMenu.Content>\n        </DropdownMenu.Root>\n    );\n\n    // TODO: Update to one `return` statement after ContentPicker has been migrated to Blueprint\n    if (viewMode) {\n        return <OptionsGroup>{onOpenChange => <OptionsDropdownMenu onOpenChange={onOpenChange} />}</OptionsGroup>;\n    }\n\n    return <OptionsDropdownMenu />;\n};\n\nexport default ItemOptions;\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,OAAO,QAAQ,YAAY;AACpC,OAAOC,IAAI,MAAM,aAAa;AAE9B,SAASC,UAAU,EAAEC,IAAI,EAAEC,YAAY,EAAEC,QAAQ,EAAEC,UAAU,QAAQ,oBAAoB;AACzF,SAASC,QAAQ,QAAQ,sCAAsC;AAG/D,OAAOC,OAAO,MAAM,wBAAwB;AAE5C,SACIC,qBAAqB,EACrBC,uBAAuB,EACvBC,sBAAsB,EACtBC,qBAAqB,EACrBC,oBAAoB,EACpBC,SAAS,EACTC,YAAY,EACZC,cAAc,EACdC,cAAc,QACX,oBAAoB;AAE3B,OAAOC,QAAQ,MAAM,aAAa;AAYlC,MAAMC,WAAW,GAAGA,CAAC;EACjBC,SAAS,GAAG,KAAK;EACjBC,WAAW,GAAG,KAAK;EACnBC,UAAU,GAAG,KAAK;EAClBC,SAAS,GAAG,KAAK;EACjBC,QAAQ,GAAG,KAAK;EAChBC,IAAI;EACJC,WAAW,GAAG,EAAE;EAChBC,YAAY,GAAG1B,IAAI;EACnB2B,cAAc,GAAG3B,IAAI;EACrB4B,aAAa,GAAG5B,IAAI;EACpB6B,YAAY,GAAG7B,IAAI;EACnB8B,WAAW,GAAG9B,IAAI;EAClB+B,aAAa;EACbC;AACc,CAAC,KAAK;EACpB,MAAM;IAAEC,WAAW;IAAEC,IAAI,EAAEC;EAAS,CAAC,GAAGX,IAAI;EAC5C,MAAM;IAAEY;EAAc,CAAC,GAAGrC,OAAO,CAAC,CAAC;EAEnC,MAAMsC,UAAU,GAAGL,QAAQ,KAAKhB,cAAc;EAC9C,MAAMsB,UAAU,GAAGN,QAAQ,KAAKjB,cAAc;EAE9C,IAAI,CAACkB,WAAW,EAAE;IACd,OAAOI,UAAU,gBAAGvC,KAAA,CAAAyC,aAAA,CAACrC,IAAI,MAAE,CAAC,GAAG,IAAI;EACvC;EAEA,MAAMsC,eAAe,GAAGrB,SAAS,IAAIc,WAAW,CAACzB,qBAAqB,CAAC;EACvE,MAAMiC,iBAAiB,GACnBN,QAAQ,KAAKtB,SAAS,IAAIO,WAAW,IAAIa,WAAW,CAACxB,uBAAuB,CAAC,IAAIF,OAAO,CAACa,WAAW,CAAC,CAAC;EAC1G,MAAMsB,aAAa,GAAGP,QAAQ,KAAKrB,YAAY;EAC/C,MAAM6B,gBAAgB,GAAGR,QAAQ,KAAKtB,SAAS,IAAIQ,UAAU,IAAIY,WAAW,CAACvB,sBAAsB,CAAC;EACpG,MAAMkC,eAAe,GAAGtB,SAAS,IAAIW,WAAW,CAACtB,qBAAqB,CAAC;EACvE,MAAMkC,cAAc,GAAGtB,QAAQ,IAAIU,WAAW,CAACrB,oBAAoB,CAAC;EAEpE,MAAMkC,OAAO,GAAGrB,WAAW,CAACsB,MAAM,CAAC,CAACC,YAAY,EAAEC,MAAM,KAAK;IACzD,MAAM;MAAEC,MAAM,EAAEC,YAAY;MAAEC,KAAK,EAAEC,WAAW;MAAEC,QAAQ;MAAEpB,IAAI,EAAEqB;IAAW,CAAC,GAAGN,MAAM;IAEvF,IAAIM,UAAU,IAAIA,UAAU,KAAKpB,QAAQ,EAAE;MACvC,OAAOa,YAAY;IACvB;IAEA,IAAIG,YAAY,IAAI,CAACA,YAAY,CAAC3B,IAAI,CAAC,EAAE;MACrC,OAAOwB,YAAY;IACvB;IAEA,OAAO,CACH,GAAGA,YAAY,eACflD,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACqD,IAAI;MAACC,GAAG,EAAEJ,WAAW,GAAGE,UAAW;MAACG,OAAO,EAAEA,CAAA,KAAMJ,QAAQ,CAAC9B,IAAI;IAAE,GAC3E6B,WACc,CAAC,CACvB;EACL,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMM,UAAU,GAAG,CAAC,CAACb,OAAO,CAACc,MAAM;EACnC,MAAMC,UAAU,GACZrB,eAAe,IAAIC,iBAAiB,IAAIC,aAAa,IAAIC,gBAAgB,IAAIC,eAAe,IAAIC,cAAc;EAElH,IAAI,CAACc,UAAU,IAAI,CAACE,UAAU,EAAE;IAC5B,OAAOxB,UAAU,gBAAGvC,KAAA,CAAAyC,aAAA,CAACrC,IAAI,MAAE,CAAC,GAAG,IAAI;EACvC;EAEA,MAAM4D,eAAe,GAAG;IACpBC,aAAa,EAAEC,KAAK,IAAI;MACpBA,KAAK,CAACC,eAAe,CAAC,CAAC;IAC3B,CAAC;IACDC,IAAI,EAAE;EACV,CAAC;EAED,MAAMC,YAAY,GAAG7B,UAAU,GAAGlC,QAAQ,CAACgE,OAAO,GAAGnE,UAAU;EAC/D,MAAMoE,cAAc,GAAG/B,UAAU,GAAGlC,QAAQ,CAACkE,gBAAgB,GAAGjE,UAAU;EAC1E,MAAMkE,mBAAmB,GAAGjC,UAAU,GAAG,CAAC,CAAC,GAAGwB,eAAe;EAE7D,MAAMU,mBAAmB,GAAGA,CAAC;IAAEC,YAAY,GAAGzE;EAAK,CAAC,kBAChDF,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACuE,IAAI;IAACD,YAAY,EAAEA;EAAa,gBAC1C3E,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACwE,OAAO,qBACjB7E,KAAA,CAAAyC,aAAA,CAAC8B,cAAc,EAAAO,QAAA;IACX,cAAYxC,aAAa,CAACnB,QAAQ,CAAC4D,WAAW,CAAE;IAChDC,IAAI,EAAExE;EAAS,GACViE,mBAAmB,CAC3B,CACiB,CAAC,eACvBzE,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAAC4E,OAAO;IAACC,KAAK,EAAC,KAAK;IAACC,SAAS,EAAElD;EAAc,GACtDY,gBAAgB,iBACb7C,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACqD,IAAI;IAACE,OAAO,EAAEA,CAAA,KAAM9B,aAAa,CAACJ,IAAI;EAAE,GACjDY,aAAa,CAACnB,QAAQ,CAACiE,OAAO,CAChB,CACtB,EACAxC,aAAa,iBACV5C,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACqD,IAAI;IAACE,OAAO,EAAEA,CAAA,KAAM9B,aAAa,CAACJ,IAAI;EAAE,GACjDY,aAAa,CAACnB,QAAQ,CAACkE,IAAI,CACb,CACtB,EACA3C,eAAe,iBACZ1C,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACqD,IAAI;IAACE,OAAO,EAAEA,CAAA,KAAMhC,YAAY,CAACF,IAAI;EAAE,GAChDY,aAAa,CAACnB,QAAQ,CAACmE,MAAM,CACf,CACtB,EACA3C,iBAAiB,iBACd3C,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACqD,IAAI;IAACE,OAAO,EAAEA,CAAA,KAAM/B,cAAc,CAACH,IAAI;EAAE,GAClDY,aAAa,CAACnB,QAAQ,CAACoE,QAAQ,CACjB,CACtB,EACAzC,eAAe,iBACZ9C,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACqD,IAAI;IAACE,OAAO,EAAEA,CAAA,KAAM7B,YAAY,CAACL,IAAI;EAAE,GAChDY,aAAa,CAACnB,QAAQ,CAACqE,MAAM,CACf,CACtB,EACAzC,cAAc,iBACX/C,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACqD,IAAI;IAACE,OAAO,EAAEA,CAAA,KAAM5B,WAAW,CAACN,IAAI;EAAE,GAC/CY,aAAa,CAACnB,QAAQ,CAACsE,KAAK,CACd,CACtB,EACA5B,UAAU,IAAIE,UAAU,iBAAI/D,KAAA,CAAAyC,aAAA,CAACpC,YAAY,CAACqF,SAAS,MAAE,CAAC,EACtD7B,UAAU,IAAIb,OACG,CACP,CACtB;;EAED;EACA,IAAId,QAAQ,EAAE;IACV,oBAAOlC,KAAA,CAAAyC,aAAA,CAAC4B,YAAY,QAAEM,YAAY,iBAAI3E,KAAA,CAAAyC,aAAA,CAACiC,mBAAmB;MAACC,YAAY,EAAEA;IAAa,CAAE,CAAgB,CAAC;EAC7G;EAEA,oBAAO3E,KAAA,CAAAyC,aAAA,CAACiC,mBAAmB,MAAE,CAAC;AAClC,CAAC;AAED,eAAetD,WAAW","ignoreList":[]}