{"version":3,"file":"ErrorBoundary.js","names":["React","noop","ERROR_CODE_UNEXPECTED_EXCEPTION","IS_ERROR_DISPLAYED","DefaultError","ErrorBoundary","Component","constructor","args","_defineProperty","error","code","contextInfo","origin","props","errorOrigin","elementsError","type","message","context_info","_objectSpread","onError","componentDidCatch","info","setState","handleError","render","_this$props","children","errorComponent","ErrorComponent","rest","_objectWithoutProperties","_excluded","state","createElement","cloneElement"],"sources":["../../../../src/elements/common/error-boundary/ErrorBoundary.js"],"sourcesContent":["/**\n * @flow\n * @file Error Boundary\n * @author Box\n */\n\nimport * as React from 'react';\nimport noop from 'lodash/noop';\nimport { ERROR_CODE_UNEXPECTED_EXCEPTION, IS_ERROR_DISPLAYED } from '../../../constants';\nimport DefaultError from './DefaultError';\nimport type { ElementsXhrError, ElementsError } from '../../../common/types/api';\nimport type { ElementOrigin } from '../flowTypes';\n\ntype Props = {\n    children: React.Element<any>,\n    errorComponent: React.ComponentType<any>,\n    errorOrigin: ElementOrigin,\n    onError: (error: ElementsError) => void,\n};\n\ntype State = {\n    error?: Error,\n};\n\nclass ErrorBoundary extends React.Component<Props, State> {\n    props: Props;\n\n    state: State = {};\n\n    static defaultProps = {\n        errorComponent: DefaultError,\n        onError: noop,\n    };\n\n    componentDidCatch(error: Error, info: Object): void {\n        this.setState({ error }, () => {\n            this.handleError(\n                error,\n                ERROR_CODE_UNEXPECTED_EXCEPTION,\n                {\n                    ...info,\n                },\n                this.props.errorOrigin,\n            );\n        });\n    }\n\n    /**\n     * Formats the error and emits it to the top level onError prop\n     *\n     * @param {Error} error - the error which occurred\n     * @param {string} type - the error type to identify where the error occurred\n     * @param {string} code - the error code to identify what error occurred\n     * @param {Object} contextInfo - additional information which may be useful for the consumer of the error\n     * @return {void}\n     */\n    handleError = (\n        error: ElementsXhrError | Error,\n        code: string,\n        contextInfo: Object = {},\n        origin: ElementOrigin = this.props.errorOrigin,\n    ) => {\n        if (!error || !code || !origin) {\n            return;\n        }\n\n        const elementsError: ElementsError = {\n            type: 'error',\n            code,\n            message: error.message,\n            origin,\n            context_info: {\n                [IS_ERROR_DISPLAYED]: true,\n                ...contextInfo,\n            },\n        };\n\n        this.props.onError(elementsError);\n    };\n\n    render() {\n        const { children, errorComponent: ErrorComponent, ...rest } = this.props;\n        const { error } = this.state;\n        if (error) {\n            return <ErrorComponent error={error} />;\n        }\n\n        return React.cloneElement(children, {\n            ...rest,\n            onError: this.handleError,\n        });\n    }\n}\n\nexport default ErrorBoundary;\n"],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;;AAEA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,OAAOC,IAAI,MAAM,aAAa;AAC9B,SAASC,+BAA+B,EAAEC,kBAAkB,QAAQ,oBAAoB;AACxF,OAAOC,YAAY,MAAM,gBAAgB;AAezC,MAAMC,aAAa,SAASL,KAAK,CAACM,SAAS,CAAe;EAAAC,YAAA,GAAAC,IAAA;IAAA,SAAAA,IAAA;IAAAC,eAAA,gBAGvC,CAAC,CAAC;IAoBjB;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IARIA,eAAA,sBASc,CACVC,KAA+B,EAC/BC,IAAY,EACZC,WAAmB,GAAG,CAAC,CAAC,EACxBC,MAAqB,GAAG,IAAI,CAACC,KAAK,CAACC,WAAW,KAC7C;MACD,IAAI,CAACL,KAAK,IAAI,CAACC,IAAI,IAAI,CAACE,MAAM,EAAE;QAC5B;MACJ;MAEA,MAAMG,aAA4B,GAAG;QACjCC,IAAI,EAAE,OAAO;QACbN,IAAI;QACJO,OAAO,EAAER,KAAK,CAACQ,OAAO;QACtBL,MAAM;QACNM,YAAY,EAAAC,aAAA;UACR,CAACjB,kBAAkB,GAAG;QAAI,GACvBS,WAAW;MAEtB,CAAC;MAED,IAAI,CAACE,KAAK,CAACO,OAAO,CAACL,aAAa,CAAC;IACrC,CAAC;EAAA;EA5CDM,iBAAiBA,CAACZ,KAAY,EAAEa,IAAY,EAAQ;IAChD,IAAI,CAACC,QAAQ,CAAC;MAAEd;IAAM,CAAC,EAAE,MAAM;MAC3B,IAAI,CAACe,WAAW,CACZf,KAAK,EACLR,+BAA+B,EAAAkB,aAAA,KAExBG,IAAI,GAEX,IAAI,CAACT,KAAK,CAACC,WACf,CAAC;IACL,CAAC,CAAC;EACN;EAmCAW,MAAMA,CAAA,EAAG;IACL,MAAAC,WAAA,GAA8D,IAAI,CAACb,KAAK;MAAlE;QAAEc,QAAQ;QAAEC,cAAc,EAAEC;MAAwB,CAAC,GAAAH,WAAA;MAANI,IAAI,GAAAC,wBAAA,CAAAL,WAAA,EAAAM,SAAA;IACzD,MAAM;MAAEvB;IAAM,CAAC,GAAG,IAAI,CAACwB,KAAK;IAC5B,IAAIxB,KAAK,EAAE;MACP,oBAAOV,KAAA,CAAAmC,aAAA,CAACL,cAAc;QAACpB,KAAK,EAAEA;MAAM,CAAE,CAAC;IAC3C;IAEA,oBAAOV,KAAK,CAACoC,YAAY,CAACR,QAAQ,EAAAR,aAAA,CAAAA,aAAA,KAC3BW,IAAI;MACPV,OAAO,EAAE,IAAI,CAACI;IAAW,EAC5B,CAAC;EACN;AACJ;AAAChB,eAAA,CApEKJ,aAAa,kBAKO;EAClBwB,cAAc,EAAEzB,YAAY;EAC5BiB,OAAO,EAAEpB;AACb,CAAC;AA8DL,eAAeI,aAAa","ignoreList":[]}