{"version":3,"file":"convertItemResponse.js","names":["ACCESS_COLLAB","INVITEE_ROLE_EDITOR","PERMISSION_CAN_DOWNLOAD","getAllowedAccessLevels","getAllowedPermissionLevels","API_TO_USM_CLASSIFICATION_COLORS_MAP","convertItemResponse","itemAPIData","allowed_invitee_roles","allowed_shared_link_access_levels","classification","id","name","permissions","shared_link","shared_link_features","type","password","isPasswordAvailable","can_download","isDownloadSettingAvailable","can_invite_collaborator","canInvite","can_set_share_access","canChangeAccessLevel","can_share","canShare","classificationData","color","definition","classificationName","colorId","isEditAllowed","indexOf","sharedLink","access","effective_permission","permission","is_password_enabled","isPasswordEnabled","unshared_at","expirationTimestamp","url","vanity_name","vanityName","vanity_url","vanityUrl","isDownloadAllowed","canChangeDownload","canChangePassword","canChangeExpiration","accessLevels","expiresAt","permissionLevels","settings","canChangeVanityName","isDownloadAvailable","isDownloadEnabled","vanityDomain","collaborationRoles","map","role","item","canInviteCollaborator","canSetShareAccess"],"sources":["../../../../src/elements/content-sharing/utils/convertItemResponse.ts"],"sourcesContent":["import { ACCESS_COLLAB, INVITEE_ROLE_EDITOR, PERMISSION_CAN_DOWNLOAD } from '../../../constants';\nimport { getAllowedAccessLevels } from './getAllowedAccessLevels';\nimport { getAllowedPermissionLevels } from './getAllowedPermissionLevels';\nimport { API_TO_USM_CLASSIFICATION_COLORS_MAP } from '../utils/constants';\n\nimport type { ContentSharingItemAPIResponse, ItemData } from '../types';\n\nexport const convertItemResponse = (itemAPIData: ContentSharingItemAPIResponse): ItemData => {\n    const {\n        allowed_invitee_roles,\n        allowed_shared_link_access_levels,\n        classification,\n        id,\n        name,\n        permissions,\n        shared_link,\n        shared_link_features,\n        type,\n    } = itemAPIData;\n\n    const { password: isPasswordAvailable } = shared_link_features;\n\n    const {\n        can_download: isDownloadSettingAvailable,\n        can_invite_collaborator: canInvite,\n        can_set_share_access: canChangeAccessLevel,\n        can_share: canShare,\n    } = permissions;\n\n    // Convert classification data for the item if available\n    let classificationData;\n    if (classification) {\n        const { color, definition, name: classificationName } = classification;\n        classificationData = {\n            colorId: API_TO_USM_CLASSIFICATION_COLORS_MAP[color],\n            definition,\n            name: classificationName,\n        };\n    }\n\n    const isEditAllowed = allowed_invitee_roles.indexOf(INVITEE_ROLE_EDITOR) !== -1;\n\n    let sharedLink;\n    if (shared_link) {\n        const {\n            access,\n            effective_permission: permission,\n            is_password_enabled: isPasswordEnabled,\n            unshared_at: expirationTimestamp,\n            url,\n            vanity_name: vanityName,\n            vanity_url: vanityUrl,\n        } = shared_link;\n\n        const isDownloadAllowed = permission === PERMISSION_CAN_DOWNLOAD;\n        const canChangeDownload = canChangeAccessLevel && isDownloadSettingAvailable && access !== ACCESS_COLLAB; // access must be \"company\" or \"open\"\n        const canChangePassword = canChangeAccessLevel && isPasswordAvailable;\n        const canChangeExpiration = canChangeAccessLevel && isEditAllowed;\n\n        sharedLink = {\n            access,\n            accessLevels: getAllowedAccessLevels(allowed_shared_link_access_levels),\n            expiresAt: expirationTimestamp,\n            permission,\n            permissionLevels: getAllowedPermissionLevels(canChangeAccessLevel, isDownloadSettingAvailable, permission),\n            settings: {\n                canChangeDownload,\n                canChangeExpiration,\n                canChangePassword,\n                canChangeVanityName: false, // vanity URLs cannot be set via the API,\n                isDownloadAvailable: isDownloadSettingAvailable,\n                isDownloadEnabled: isDownloadAllowed,\n                isPasswordAvailable: isPasswordAvailable ?? false,\n                isPasswordEnabled,\n            },\n            url,\n            vanityDomain: vanityUrl,\n            vanityName: vanityName || '',\n        };\n    }\n\n    const collaborationRoles = allowed_invitee_roles.map(role => ({ id: role }));\n\n    return {\n        collaborationRoles,\n        item: {\n            id,\n            classification: classificationData,\n            name,\n            permissions: {\n                canInviteCollaborator: !!canInvite,\n                canSetShareAccess: canChangeAccessLevel,\n                canShare: !!canShare,\n            },\n            type,\n        },\n        sharedLink,\n    };\n};\n"],"mappings":"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","ignoreList":[]}