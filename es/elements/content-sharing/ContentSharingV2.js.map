{"version":3,"file":"ContentSharingV2.js","names":["React","isEmpty","UnifiedShareModal","FIELD_ENTERPRISE","FIELD_HOSTNAME","TYPE_FILE","TYPE_FOLDER","Internationalize","Providers","CONTENT_SHARING_ITEM_FIELDS","convertItemResponse","ContentSharingV2","api","children","itemID","itemType","hasProviders","language","messages","item","setItem","useState","sharedLink","setSharedLink","currentUser","setCurrentUser","collaborationRoles","setCollaborationRoles","handleGetItemSuccess","useCallback","itemData","collaborationRolesFromAPI","itemFromAPI","sharedLinkFromAPI","useEffect","getItem","getFileAPI","getFile","fields","getFolderAPI","getFolderFields","getUserSuccess","userData","enterprise","id","name","getUserData","getUsersAPI","getUser","params","toString","config","sharedLinkEmail","createElement"],"sources":["../../../src/elements/content-sharing/ContentSharingV2.tsx"],"sourcesContent":["import * as React from 'react';\nimport isEmpty from 'lodash/isEmpty';\n\nimport { UnifiedShareModal } from '@box/unified-share-modal';\nimport type { CollaborationRole, Item, SharedLink, User } from '@box/unified-share-modal';\n\nimport API from '../../api';\nimport { FIELD_ENTERPRISE, FIELD_HOSTNAME, TYPE_FILE, TYPE_FOLDER } from '../../constants';\nimport Internationalize from '../common/Internationalize';\nimport Providers from '../common/Providers';\nimport { CONTENT_SHARING_ITEM_FIELDS } from './constants';\nimport { convertItemResponse } from './utils';\n\nimport type { ItemType, StringMap } from '../../common/types/core';\n\nexport interface ContentSharingV2Props {\n    /** api - API instance */\n    api: API;\n    /** children - Children for the element to open the Unified Share Modal */\n    children?: React.ReactElement;\n    /** itemID - Box file or folder ID */\n    itemID: string;\n    /** itemType - \"file\" or \"folder\" */\n    itemType: ItemType;\n    /** hasProviders - Whether the element has providers for USM already */\n    hasProviders?: boolean;\n    /** language - Language used for the element */\n    language?: string;\n    /** messages - Localized strings used by the element */\n    messages?: StringMap;\n}\n\nfunction ContentSharingV2({\n    api,\n    children,\n    itemID,\n    itemType,\n    hasProviders,\n    language,\n    messages,\n}: ContentSharingV2Props) {\n    const [item, setItem] = React.useState<Item | null>(null);\n    const [sharedLink, setSharedLink] = React.useState<SharedLink | null>(null);\n    const [currentUser, setCurrentUser] = React.useState<User | null>(null);\n    const [collaborationRoles, setCollaborationRoles] = React.useState<CollaborationRole[] | null>(null);\n\n    // Handle successful GET requests to /files or /folders\n    const handleGetItemSuccess = React.useCallback(itemData => {\n        const {\n            collaborationRoles: collaborationRolesFromAPI,\n            item: itemFromAPI,\n            sharedLink: sharedLinkFromAPI,\n        } = convertItemResponse(itemData);\n        setItem(itemFromAPI);\n        setSharedLink(sharedLinkFromAPI);\n        setCollaborationRoles(collaborationRolesFromAPI);\n    }, []);\n\n    // Reset state if the API has changed\n    React.useEffect(() => {\n        setItem(null);\n        setSharedLink(null);\n        setCurrentUser(null);\n        setCollaborationRoles(null);\n    }, [api]);\n\n    // Get initial data for the item\n    React.useEffect(() => {\n        const getItem = () => {\n            if (itemType === TYPE_FILE) {\n                api.getFileAPI().getFile(\n                    itemID,\n                    handleGetItemSuccess,\n                    {},\n                    {\n                        fields: CONTENT_SHARING_ITEM_FIELDS,\n                    },\n                );\n            } else if (itemType === TYPE_FOLDER) {\n                api.getFolderAPI().getFolderFields(\n                    itemID,\n                    handleGetItemSuccess,\n                    {},\n                    {\n                        fields: CONTENT_SHARING_ITEM_FIELDS,\n                    },\n                );\n            }\n        };\n\n        if (api && !isEmpty(api) && !item && !sharedLink) {\n            getItem();\n        }\n    }, [api, item, itemID, itemType, sharedLink, handleGetItemSuccess]);\n\n    // Get initial data for the user\n    React.useEffect(() => {\n        const getUserSuccess = userData => {\n            const { enterprise, id } = userData;\n            setCurrentUser({\n                id,\n                enterprise: {\n                    name: enterprise ? enterprise.name : '',\n                },\n            });\n        };\n\n        const getUserData = () => {\n            api.getUsersAPI(false).getUser(\n                itemID,\n                getUserSuccess,\n                {},\n                {\n                    params: {\n                        fields: [FIELD_ENTERPRISE, FIELD_HOSTNAME].toString(),\n                    },\n                },\n            );\n        };\n\n        if (api && !isEmpty(api) && item && sharedLink && !currentUser) {\n            getUserData();\n        }\n    }, [api, currentUser, item, itemID, itemType, sharedLink]);\n\n    const config = {\n        sharedLinkEmail: false,\n    };\n\n    return (\n        <Internationalize language={language} messages={messages}>\n            <Providers hasProviders={hasProviders}>\n                {item && (\n                    <UnifiedShareModal\n                        config={config}\n                        collaborationRoles={collaborationRoles}\n                        currentUser={currentUser}\n                        item={item}\n                        sharedLink={sharedLink}\n                    >\n                        {children}\n                    </UnifiedShareModal>\n                )}\n            </Providers>\n        </Internationalize>\n    );\n}\n\nexport default ContentSharingV2;\n"],"mappings":"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","ignoreList":[]}