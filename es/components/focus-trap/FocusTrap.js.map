{"version":3,"file":"FocusTrap.js","names":["React","tabbable","classNames","FocusTrap","Component","constructor","args","_defineProperty","el","tabbableEls","length","focus","trapEl","event","handleOverlayKeyDown","props","document","activeElement","key","focusFirstElement","stopPropagation","preventDefault","componentDidMount","shouldDefaultFocus","setTimeout","previousFocusEl","componentWillUnmount","render","_this$props","children","className","getRef","shouldOutlineFocus","rest","_objectWithoutProperties","_excluded","createElement","_extends","ref","onKeyDown","handleElKeyDown","onFocus","focusLastElement","tabIndex","handleTrapElKeyDown"],"sources":["../../../src/components/focus-trap/FocusTrap.js"],"sourcesContent":["// @flow\nimport * as React from 'react';\nimport tabbable from 'tabbable';\nimport classNames from 'classnames';\n\ntype Props = {\n    children: React.Node,\n    className?: string,\n    /** Function to get the ref to the focus trap wrapper element */\n    getRef?: Function,\n    /** Function to handle keyboard input passed in from parent component. e.g. close overlay on Escape */\n    handleOverlayKeyDown?: Function,\n    shouldDefaultFocus?: boolean,\n    shouldOutlineFocus?: boolean,\n};\n\nclass FocusTrap extends React.Component<Props> {\n    componentDidMount() {\n        if (this.props.shouldDefaultFocus) {\n            setTimeout(() => {\n                this.previousFocusEl = document.activeElement;\n                this.focusFirstElement();\n            }, 0);\n        } else {\n            setTimeout(() => {\n                if (this.el) {\n                    this.el.focus();\n                }\n            }, 0);\n        }\n    }\n\n    componentWillUnmount() {\n        setTimeout(() => {\n            if (this.previousFocusEl) {\n                this.previousFocusEl.focus();\n            }\n        }, 0);\n    }\n\n    el: ?HTMLDivElement;\n\n    previousFocusEl: ?HTMLElement;\n\n    trapEl: ?HTMLElement;\n\n    /**\n     * Focus the first tabbable element\n     */\n    focusFirstElement = () => {\n        if (!this.el) {\n            return;\n        }\n\n        const tabbableEls = tabbable(this.el);\n\n        // There are three trap-related elements, including first element.\n        // If there are 3 or fewer tabbable elements, that means there are no\n        // tabbable children, so focus on the trap element instead.\n        if (tabbableEls.length > 3) {\n            tabbableEls[1].focus();\n        } else if (this.trapEl) {\n            this.trapEl.focus();\n        }\n    };\n\n    /**\n     * Focus the last tabbable element\n     */\n    focusLastElement = () => {\n        if (!this.el) {\n            return;\n        }\n\n        const tabbableEls = tabbable(this.el);\n\n        // There are three trap-related elements, including the last two elements.\n        // If there are 3 or fewer tabbable elements, that means there are no\n        // tabbable children, so focus on the trap element instead.\n        if (tabbableEls.length > 3) {\n            tabbableEls[tabbableEls.length - 3].focus();\n        } else if (this.trapEl) {\n            this.trapEl.focus();\n        }\n    };\n\n    handleElKeyDown = (event: SyntheticKeyboardEvent<HTMLElement>) => {\n        const { handleOverlayKeyDown } = this.props;\n        if (this.el === document.activeElement && event.key === 'Tab') {\n            this.focusFirstElement();\n            event.stopPropagation();\n            event.preventDefault();\n        }\n\n        if (handleOverlayKeyDown) {\n            handleOverlayKeyDown(event);\n        }\n    };\n\n    handleTrapElKeyDown = (event: SyntheticKeyboardEvent<HTMLElement>) => {\n        if (event.key !== 'Tab') {\n            return;\n        }\n        event.stopPropagation();\n        event.preventDefault();\n    };\n\n    render() {\n        const {\n            children,\n            className,\n            getRef,\n            handleOverlayKeyDown,\n            shouldDefaultFocus,\n            shouldOutlineFocus,\n            ...rest\n        } = this.props;\n        return (\n            // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n            <div\n                ref={ref => {\n                    this.el = ref;\n                    if (getRef) {\n                        getRef(ref);\n                    }\n                }}\n                className={classNames(className, {\n                    'should-outline-focus': shouldOutlineFocus,\n                })}\n                onKeyDown={this.handleElKeyDown}\n                {...rest}\n            >\n                {/* eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex */}\n                <i aria-hidden onFocus={this.focusLastElement} tabIndex=\"0\" />\n                {children}\n                {/* eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex */}\n                <i aria-hidden onFocus={this.focusFirstElement} tabIndex=\"0\" />\n                {/* in case children doesn't contain any focusable elements, focus on trap */}\n                <i\n                    ref={ref => {\n                        this.trapEl = ref;\n                    }}\n                    aria-hidden\n                    onKeyDown={this.handleTrapElKeyDown}\n                    // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n                    tabIndex=\"0\"\n                />\n            </div>\n        );\n    }\n}\n\nexport default FocusTrap;\n"],"mappings":"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","ignoreList":[]}