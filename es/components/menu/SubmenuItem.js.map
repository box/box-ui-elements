{"version":3,"file":"SubmenuItem.js","names":["React","classNames","omit","debounce","Arrow16","SUBMENU_LEFT_ALIGNED_CLASS","SUBMENU_BOTTOM_ALIGNED_CLASS","SUBMENU_RIGHT_BOTTOM_ALIGNED_CLASS","SubmenuItem","Component","constructor","args","_defineProperty","isSubmenuOpen","submenuFocusIndex","submenuTriggerEl","submenuEl","rightBoundaryElement","bottomBoundaryElement","props","submenuElBounding","getBoundingClientRect","submenuTriggerElBounding","rightBoundaryElementBounding","right","window","innerWidth","bottomBoundaryElementBounding","bottom","innerHeight","isLeftAligned","width","isBottomAligned","top","height","isRightBottomAligned","event","isDisabled","onClick","stopPropagation","preventDefault","contains","target","key","openSubmenuAndFocus","setState","isKeyboardEvent","closeSubmenu","focus","cancel","onOpen","render","_this$props","children","className","rest","_objectWithoutProperties","_excluded","state","elements","Children","toArray","submenuTriggerContent","submenu","length","Error","chevron","createElement","menuItemProps","_objectSpread","undefined","handleMenuItemClick","onMouseLeave","onMouseEnter","openSubmenu","onKeyDown","handleKeyDown","ref","role","tabIndex","submenuProps","getMenuAlignmentClasses","initialFocusIndex","isHidden","isSubmenu","onClose","closeSubmenuAndFocusTrigger","setRef","cloneElement"],"sources":["../../../src/components/menu/SubmenuItem.tsx"],"sourcesContent":["import * as React from 'react';\nimport classNames from 'classnames';\nimport omit from 'lodash/omit';\nimport debounce from 'lodash/debounce';\n\nimport './SubmenuItem.scss';\nimport Arrow16 from '../../icon/fill/Arrow16';\n\nconst SUBMENU_LEFT_ALIGNED_CLASS = 'is-left-aligned';\nconst SUBMENU_BOTTOM_ALIGNED_CLASS = 'is-bottom-aligned';\nconst SUBMENU_RIGHT_BOTTOM_ALIGNED_CLASS = 'is-right-bottom-aligned';\n\nexport interface SubmenuItemProps {\n    /** 'aria-disabled' - ARIA attribute describing whether the submenu item is disabled */\n    'aria-disabled'?: boolean | 'true' | 'false';\n    /** 'aria-disabled' - ARIA attribute describing whether the submenu item is expanded */\n    'aria-expanded'?: boolean | 'true' | 'false';\n    /** 'aria-disabled' - ARIA attribute describing whether the submenu item has a popup */\n    'aria-haspopup'?: boolean | 'true' | 'false';\n    /** bottomBoundaryElement - an HTMLElement defining the bottom boundary for the submenu item */\n    bottomBoundaryElement?: HTMLElement;\n    /** children - submenu item content */\n    children?: Array<React.ReactChild> | React.ReactChild;\n    /** className - CSS class name for the submenu item */\n    className?: string;\n    /** isDisabled - whether the submenu item is disabled */\n    isDisabled?: boolean;\n    /** onClick - function called when the submenu item is clicked */\n    onClick?: (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => void;\n    /** onClick - function called when a key is pressed within the submenu item */\n    onKeyDown?: (event: React.KeyboardEvent<HTMLLIElement>) => void;\n    /** onClick - function called when the mouse enters the submenu item */\n    onMouseEnter?: (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => void;\n    /** onClick - function called when the mouse leaves the submenu item */\n    onMouseLeave?: (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => void;\n    /** onOpen - function called when the submenu opens */\n    onOpen?: () => void;\n    /** ref - reference to the menu element in the DOM */\n    ref?: string | ((instance: HTMLLIElement | null) => void) | React.RefObject<HTMLLIElement> | null | undefined;\n    /** rightBoundaryElement - an HTMLElement defining the right boundary for the submenu item */\n    rightBoundaryElement?: HTMLElement;\n    /** role - ARIA role for the submenu item */\n    role?: string;\n    /** tabIndex - indicator of whether the submenu item is focusable */\n    tabIndex?: number;\n}\n\ninterface SubmenuItemState {\n    /** isSubmenuOpen - whether the submenu is open */\n    isSubmenuOpen: boolean;\n    /** isSubmenuOpen - index of the focused submenu item */\n    submenuFocusIndex: number | null | undefined;\n}\n\n/**\n * A menu-item component which triggers open a submenu\n *\n * @NOTE: Nested submenus are NOT currently supported, switching\n * focus with arrow keys in the subsubmenu is not working properly.\n */\nclass SubmenuItem extends React.Component<SubmenuItemProps, SubmenuItemState> {\n    state = {\n        isSubmenuOpen: false,\n        submenuFocusIndex: null,\n    };\n\n    getMenuAlignmentClasses = (): Record<string, boolean> => {\n        if (!this.submenuTriggerEl || !this.submenuEl) {\n            return {};\n        }\n\n        const { rightBoundaryElement, bottomBoundaryElement } = this.props;\n        const submenuElBounding = this.submenuEl.getBoundingClientRect();\n        const submenuTriggerElBounding = this.submenuTriggerEl.getBoundingClientRect();\n        const rightBoundaryElementBounding = rightBoundaryElement\n            ? rightBoundaryElement.getBoundingClientRect()\n            : { right: window.innerWidth };\n        const bottomBoundaryElementBounding = bottomBoundaryElement\n            ? bottomBoundaryElement.getBoundingClientRect()\n            : { bottom: window.innerHeight };\n\n        const isLeftAligned =\n            submenuTriggerElBounding.right + submenuElBounding.width > rightBoundaryElementBounding.right;\n        const isBottomAligned =\n            submenuTriggerElBounding.top + submenuElBounding.height > bottomBoundaryElementBounding.bottom;\n        const isRightBottomAligned =\n            submenuTriggerElBounding.bottom + submenuElBounding.height > bottomBoundaryElementBounding.bottom;\n        return {\n            [SUBMENU_LEFT_ALIGNED_CLASS]: isLeftAligned,\n            [SUBMENU_BOTTOM_ALIGNED_CLASS]: isBottomAligned,\n            [SUBMENU_RIGHT_BOTTOM_ALIGNED_CLASS]: isRightBottomAligned, // Used only in medium-screen viewport sizes\n        };\n    };\n\n    handleMenuItemClick = (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => {\n        const { isDisabled, onClick } = this.props;\n\n        // If aria-disabled is passed as a prop, we should ignore clicks on this menu item\n        if (isDisabled) {\n            event.stopPropagation();\n            event.preventDefault();\n\n            return;\n        }\n\n        if (onClick) {\n            onClick(event);\n        }\n\n        // If event target is triggering submenu element, do not propagate to close menu\n        if (this.submenuEl && !this.submenuEl.contains(event.target as Node)) {\n            event.stopPropagation();\n            event.preventDefault();\n        }\n    };\n\n    submenuTriggerEl: HTMLElement | null | undefined;\n\n    submenuEl: HTMLElement | null | undefined;\n\n    handleKeyDown = (event: React.KeyboardEvent<HTMLLIElement>) => {\n        switch (event.key) {\n            case ' ':\n            case 'Enter':\n            case 'ArrowRight':\n                event.stopPropagation();\n                event.preventDefault();\n                this.openSubmenuAndFocus();\n                break;\n            default:\n                break;\n        }\n    };\n\n    closeSubmenu = debounce(() => {\n        this.setState({\n            isSubmenuOpen: false,\n        });\n    }, 50);\n\n    closeSubmenuAndFocusTrigger = (isKeyboardEvent: boolean | null | undefined) => {\n        this.closeSubmenu();\n        if (this.submenuTriggerEl && isKeyboardEvent) {\n            this.submenuTriggerEl.focus();\n        }\n    };\n\n    openSubmenu = () => {\n        this.closeSubmenu.cancel();\n        const { onOpen } = this.props;\n        if (onOpen) {\n            onOpen();\n        }\n        this.setState({\n            isSubmenuOpen: true,\n            submenuFocusIndex: null,\n        });\n    };\n\n    openSubmenuAndFocus = () => {\n        const { onOpen } = this.props;\n        if (onOpen) {\n            onOpen();\n        }\n\n        this.setState({\n            isSubmenuOpen: true,\n            submenuFocusIndex: 0,\n        });\n    };\n\n    render() {\n        const { children, className, isDisabled, ...rest } = this.props;\n        const { isSubmenuOpen, submenuFocusIndex } = this.state;\n\n        const elements = React.Children.toArray(children);\n        const submenuTriggerContent = elements[0];\n        const submenu = elements[1] as React.ReactElement;\n        if (elements.length !== 2 || !submenuTriggerContent || !submenu) {\n            throw new Error('SubmenuItem must have exactly two children, a trigger component and a <Menu>');\n        }\n\n        const chevron = <Arrow16 className=\"menu-item-arrow\" width={12} height={12} />;\n\n        const menuItemProps: SubmenuItemProps = {\n            ...omit(rest, ['bottomBoundaryElement', 'onClick', 'onOpen', 'rightBoundaryElement', 'role', 'tabIndex']),\n            'aria-disabled': isDisabled ? 'true' : undefined,\n            'aria-expanded': isSubmenuOpen ? 'true' : 'false',\n            'aria-haspopup': 'true',\n\n            className: classNames('menu-item', 'submenu-target', className),\n            onClick: this.handleMenuItemClick,\n            onMouseLeave: this.closeSubmenu,\n            onMouseEnter: this.openSubmenu,\n            onKeyDown: this.handleKeyDown,\n            ref: (ref: HTMLLIElement | null) => {\n                this.submenuTriggerEl = ref;\n            },\n            role: 'menuitem',\n            tabIndex: -1,\n        };\n\n        const submenuProps = {\n            className: classNames(submenu.props.className, 'submenu', this.getMenuAlignmentClasses()),\n            initialFocusIndex: submenuFocusIndex,\n            // Hide the menu instead of unmounting it. Otherwise onMouseLeave won't work.\n            isHidden: !isSubmenuOpen,\n            isSubmenu: true,\n            onClose: this.closeSubmenuAndFocusTrigger,\n            setRef: (ref: HTMLLIElement) => {\n                this.submenuEl = ref;\n            },\n        };\n\n        return (\n            <li {...menuItemProps}>\n                {submenuTriggerContent}\n                {chevron}\n                {React.cloneElement(submenu, submenuProps)}\n            </li>\n        );\n    }\n}\n\nexport default SubmenuItem;\n"],"mappings":"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","ignoreList":[]}