<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Open With Test Page</title>
        <style>
            .openwith {
                margin-top: 50px;
            }
            .container {
                display: flex;
                height: 100%;
                width: 100%;
                align-items: center;
                justify-content: center;
            }
            .container > div {
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            button {
                margin: 20px;
            }
        </style>
        <link rel="stylesheet" type="text/css" href="../dev/en-US/openwith.css" />
        <script src="../dev/en-US/openwith.js"></script>
    </head>
    <body>
        <div class='container'>
            <div class="id-token-container-1">
                <div>
                    <label>
                        <div>File Id</div>
                        <input class="file" type="text" placeholder="Enter file id" />
                    </label>
                    <label>
                        <div>Auth Token</div>
                        <input class="token" type="text" placeholder="Enter auth token" />
                    </label>
                </div>
                <button type="button" onclick="load(1)">Submit</button>
                <div class="openwith openwith1"></div>
            </div>
            <div class="id-token-container-2">
                    <div>
                        <label>
                            <div>File Id</div>
                            <input class="file" type="text" placeholder="Enter file id" />
                        </label>
                        <label>
                            <div>Auth Token</div>
                            <input class="token" type="text" placeholder="Enter auth token" />
                        </label>
                    </div>
                    <button type="button" onclick="load(2)">Submit</button>
                    <div class="openwith openwith2"></div>
            </div>
            <div class="id-token-container-3">
                    <div>
                        <label>
                            <div>File Id</div>
                            <input class="file" type="text" placeholder="Enter file id" />
                        </label>
                        <label>
                            <div>Auth Token</div>
                            <input class="token" type="text" placeholder="Enter auth token" />
                        </label>
                    </div>
                    <button type="button" onclick="load(3)">Submit</button>
                    <div class="openwith openwith3"></div>
            </div>
        </div>
        <script>
            function load(buttonNum) {
                const { OpenWith } = Box;
                const container = document.querySelector(`.id-token-container-${buttonNum}`); 
                const token = container.querySelector('.token').value || localStorage.getItem(`token${buttonNum}`);
                const fileId = container.querySelector('.file').value || localStorage.getItem(`file${buttonNum}`);
                if (!token || !fileId) {
                    return;
                }
                localStorage.setItem(`token${buttonNum}`, token);
                container.querySelector(`.token`).value = token;
                localStorage.setItem(`file${buttonNum}`, fileId);
                container.querySelector('.file').value = fileId;
                const openwith = new OpenWith();
                openwith.show(fileId, token, {
                    container: `.openwith${buttonNum}`
                });
            }
            load(1);
            load(2);
            load(3);
        </script>
    </body>
</html>
