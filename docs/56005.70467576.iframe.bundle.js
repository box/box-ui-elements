(globalThis.webpackChunkbox_ui_elements=globalThis.webpackChunkbox_ui_elements||[]).push([[56005],{"./node_modules/@box/blueprint-web-assets/dist/icons/Fill/ArrowsExpand.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__=(0,__webpack_require__("./node_modules/react/index.js").forwardRef)(((props,ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",role:"img",ref,...props,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("path",{fill:props.color||"#909090",fillRule:"evenodd",d:"M14 1a1 1 0 0 1 .993.883L15 2v5a1 1 0 0 1-1.993.117L13 7V4.414L9.914 7.5a1 1 0 0 1-1.497-1.32l.083-.094L11.584 3H9a1 1 0 0 1-.994-.883L8 2a1 1 0 0 1 .883-.993L9 1h5ZM2 15a1 1 0 0 1-.993-.883L1 14V9a1 1 0 0 1 1.993-.117L3 9v2.586L6.086 8.5a1 1 0 0 1 1.497 1.32l-.083.094L4.416 13H7a1 1 0 0 1 .993.883L8 14a1 1 0 0 1-.883.993L7 15H2Z",clipRule:"evenodd"})})))},"./node_modules/@box/blueprint-web-assets/dist/icons/Fill/XMark.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__=(0,__webpack_require__("./node_modules/react/index.js").forwardRef)(((props,ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",role:"img",ref,...props,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("path",{fill:props.color||"#909090",d:"M3 3a1.017 1.017 0 0 1 1.43.008L13 11.579a1.004 1.004 0 0 1-1.42 1.42L3.009 4.426A1.014 1.014 0 0 1 3 2.999Z"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("path",{fill:props.color||"#909090",d:"M3.004 12.996a1 1 0 0 1 0-1.414l8.58-8.58a1 1 0 1 1 1.414 1.414l-8.58 8.58a1 1 0 0 1-1.414 0Z"})]})))},"./node_modules/@box/blueprint-web-assets/dist/icons/Medium/XMark.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__=(0,__webpack_require__("./node_modules/react/index.js").forwardRef)(((props,ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("svg",{width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",role:"img",ref,...props,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("path",{fill:props.color||"#909090",d:"M18.293 4.293a1 1 0 1 1 1.414 1.414L13.414 12l6.293 6.293a1 1 0 0 1-1.414 1.414L12 13.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L10.586 12 4.293 5.707a1 1 0 1 1 1.414-1.414L12 10.586l6.293-6.293Z"})})))},"./node_modules/@box/box-ai-content-answers/dist/esm/lib/components/api-wrapper/api-wrapper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>s});var context=__webpack_require__("./node_modules/@box/box-ai-agent-selector/dist/esm/lib/contexts/context.js"),react=__webpack_require__("./node_modules/react/index.js"),types=__webpack_require__("./node_modules/@box/box-ai-content-answers/dist/chunks/types.js"),actions=__webpack_require__("./node_modules/@box/box-ai-agent-selector/dist/esm/lib/contexts/actions.js"),camelCase=__webpack_require__("./node_modules/lodash/camelCase.js"),camelCase_default=__webpack_require__.n(camelCase);const T="SET_MODAL_ERROR",_="SET_MODAL_SUCCESS",N="SET_SUGGESTED_QUESTIONS_REQUEST_STATE",R="SET_ANSWER_FEEDBACK";var immutable=__webpack_require__("./node_modules/immutable/dist/immutable.js");const o=(0,immutable.Record)({has_streamed_responses:!0,has_citations_enabled:!1}),records_t=(0,immutable.Record)({type:"file",id:null,version_id:null}),r=(0,immutable.Record)({suggestions:[],requestState:types.R.NOT_STARTED}),records_u=(0,immutable.Record)({config:new o,encodedSession:null,contextSession:null,error:null,isLoading:!1,hasRequestInProgress:!1,item:new records_t,questions:[],shouldShowLandingPage:!0,suggestedQuestions:new r}),records_a=(0,immutable.Record)({answer:null,citations:[],created_at:null,id:null,isCompleted:!1,isLoading:!0,error:null,prompt:null,feedbackValue:"none",promptType:types.U}),n=e=>e.map((t=>({content:t.cited_text_content,location:t.cited_text_location,title:t.cited_doc_name,fileId:t.cited_doc_id}))),d={chunk:15e3,initial:45e3},stream_N={RESPONSE_FAILED:types.A.RESPONSE_FAILED,RESPONSE_INTERRUPTED:types.A.RESPONSE_INTERRUPTED,RESPONSE_STOPPED:types.A.RESPONSE_STOPPED},O_CONTINUE="continue",O_DONE="done";const stream_k=new class stream_T{constructor(){this.abortControllerMap=new Map,this.chunkTimeout=d.chunk}abortRequest(r,i=!1){const t=this.abortControllerMap.get(r);t&&(t.isAbortFunctionCalled=!0,t.isUserInitiatedAbort=i,this.abortControllerMap.set(r,t),t.abortController.abort())}createAbortRequest(r){const i={abortController:new AbortController,isAbortFunctionCalled:!1,isUserInitiatedAbort:!1};return this.abortControllerMap.set(r,i),i.abortController}parseNDJSON(r,i,t){const e=(new TextDecoder).decode(i),o=r.partialData+e,n=o.trim().split(/\r?\n/);r.partialData=o.endsWith("\n")||o.endsWith("}")?"":n.pop()||"";let E="";n.forEach((c=>{const l=JSON.parse(c);l[t]&&(E+=l[t]),Object.entries(l).forEach((([u,s])=>{const C=camelCase_default()(u);C!==t&&(r[C]=s)}))})),r.data+=E}receiveStreamedResponse(r,i,t,e="answer",o,a){var u;const n=this.initializeStreamedResponseState(),E=null==(u=i.body)?void 0:u.getReader();if(this.chunkTimeout=(null==o?void 0:o.chunk)||d.chunk,!E)return void this.handleNoResponseBody(t,n);let c;const l=()=>{E.read().then((s=>{this.handleChunkSuccess(c,t,s,r,n,e),s.done||(c=this.setChunkTimeout(r,a),l())})).catch((s=>{this.handleChunkError(c,t,r,n)}))};l()}initializeStreamedResponseState(){return{completionReason:null,contextSession:null,data:"",error:null,isAborted:!1,isCompleted:!1,partialData:""}}handleChunkSuccess(r,i,t,e,o,a){if(!t)return;clearTimeout(r);const{completionReason:n}=o;o.isCompleted=t.done||null!==n,t.value&&this.parseNDJSON(o,t.value,a),o.isCompleted&&(this.removeAbortController(e),n!==O_DONE&&(o.data?o.error=n===O_CONTINUE?stream_N.RESPONSE_INTERRUPTED:stream_N.RESPONSE_FAILED:o.error=types.A.NO_CONTENT)),i(o)}handleChunkError(r,i,t,e){e.error=stream_N.RESPONSE_FAILED;const o=this.abortControllerMap.get(t);o&&o.isUserInitiatedAbort&&(e.error=stream_N.RESPONSE_STOPPED,e.isAborted=o.isUserInitiatedAbort),e.isCompleted=!0,this.removeAbortController(t),clearTimeout(r),i(e)}handleNoResponseBody(r,i){i.error=types.A.NO_CONTENT,i.isCompleted=!0,r(i)}removeAbortController(r){this.abortControllerMap.delete(r)}setChunkTimeout(r,i){return setTimeout((()=>{this.abortRequest(r),i&&i({eventType:"ai-client-chunk-streaming-timeout-error",message:"Chunk streaming timeout error",origin:"AIClientErrorLog"})}),this.chunkTimeout)}},request_A=async(i,e=!1,t,a,s,o,l,u,m,n,T)=>{let r;const p=((i,e,t)=>setTimeout((()=>{stream_k.abortRequest(i),t&&t({eventType:"ai-client-initial-streaming-timeout-error",message:"Initial streaming timeout error",origin:"AIClientErrorLog"})}),e))(t,(null==n?void 0:n.initial)||d.initial,T);return e&&u?r=await u(i,a,s,m,o):l&&(r=await l(i,a,s,o)),clearTimeout(p),r},Ns=/Too Many Requests/i,V="Agent not found";function Qs({contentAnswers:i,createSessionRequest:O,dispatchStateUpdate:o,fetchTimeout:k,formatCitations:F=n,getAnswerStreaming:v,getAnswer:D,getSuggestedQuestions:m,isStopResponseEnabled:j,isStreamingEnabled:L,itemID:c,items:E,onSuggestedQuestionsFetched:x,sendErrorLog:G,shouldPreinitSession:d=!0}){const y=react.useRef(null),K=(0,context.eK)(),S=(0,react.useMemo)((()=>Array.isArray(E)&&E.length>1),[E]),P=(0,react.useCallback)((s=>Array.isArray(s)?F(s):null),[F]);react.useEffect((s=>{c&&c!==i.item.id&&o({type:"SET_NEW_ITEM",itemID:c,fileVersionID:s})}),[c]);const u=react.useCallback(((s,e)=>{o({type:"UPDATE_QUESTION",newQuestion:s,session:e}),y.current=s}),[o]),W=react.useCallback((s=>{o({type:T,error:s})}),[o]),Q=react.useCallback(((s,e,a)=>{const{answer:n,error:r,citations:l=[],createdAt:f=null,encodedSession:C,contextSession:_}=s,N=e.set("citations",P(l)).merge({answer:n,error:r,created_at:f,isLoading:!1,isCompleted:a});let T;C&&(T={encodedSession:C}),_&&(T={contextSession:_}),u(N,T)}),[u,P]),g=react.useCallback(((s,e)=>{var N,T,b;const a=(null==s?void 0:s.message)||"",n=429===(null==(N=null==s?void 0:s.response)?void 0:N.status)||Ns.test(a),r=(null==s?void 0:s.code)===V||(null==s?void 0:s.errorCode)===V,l=204===(null==(T=null==s?void 0:s.response)?void 0:T.status),f=412===(null==(b=null==s?void 0:s.response)?void 0:b.status),C=l?types.A.NO_CONTENT:n?types.A.RATE_LIMITING:f?types.A.PRECONDITION_FAILED:r?types.A.AGENT_NOT_FOUND:types.A.GENERAL,_=e.merge({error:C,isLoading:!1,isCompleted:!0});u(_,void 0)}),[u]),A=react.useCallback((async(s,e)=>{try{const a={prompt:s.prompt,aiAgent:e||void 0},n=`content-answers-${s.id}`;let r;L&&(r=stream_k.createAbortRequest(n));const l=await request_A(a,L,n,c,E,i,D,v,r,k,G);L?stream_k.receiveStreamedResponse(n,l,(f=>{const{code:C,data:_,error:N,citations:T,contextSession:b,isCompleted:U,createdAt:h}=f,ss={answer:_,citations:T,error:N,contextSession:b,createdAt:h};l.ok&&200===l.status?Q({...ss},s,U):g({response:l,code:C},s)}),void 0,k,G):(Object.entries(l).forEach((([f,C])=>{const _=camelCase_default()(f);delete l[f],l[_]=C})),Q(l,s,!0))}catch(a){if(j&&a instanceof Error&&"AbortError"===a.name){const n=s.set("error",[]).merge({error:types.A.RESPONSE_STOPPED,isLoading:!1,isCompleted:!0});u(n)}else g(a,s)}}),[L,c,E,i,D,v,k,G,Q,g,j,u]),$=react.useCallback((s=>{const{encoded_session:e,metadata:{is_large_file:a}={is_large_file:!1}}=s;o({type:_,encodedSession:e,isLargeFile:a})}),[o]),I=react.useCallback((async(s=!0,e=!0)=>{try{s&&o({type:"SET_IS_LOADING",isLoading:!0});const a=await O({items:E},c);$(a)}catch{if(e&&W(types.C.GENERAL),!d&&(o({type:"SET_IS_LOADING",isLoading:!1}),y.current)){const n=y.current.set("error",types.A.GENERAL).merge({isLoading:!1,isCompleted:!0});u(n)}}}),[O,E,c,$,o,d,W,u]),p=react.useCallback(((s,e,a=!0)=>{const n=!i.isLoading&&!i.encodedSession&&!S&&O,r=(null==i?void 0:i.questions)||[];a&&(s.id=`${r.length}`),!d&&n&&(s.error=types.A.GENERAL,s.isLoading=!1,s.isCompleted=!0);const l=new records_a(s);return u(l),d||i.encodedSession?A(l,e):!i.isLoading&&!d&&O&&I(!0,!1),l}),[i.encodedSession,i.isLoading,null==i?void 0:i.questions,I,O,S,A,d,u]),X=react.useCallback(((s,e)=>{o({type:R,questionId:s,feedbackValue:e})}),[o]),Y=react.useCallback((()=>{o({type:"CLEAR_CONVERSATION_HISTORY"})}),[o]),z=react.useCallback((async(s,e)=>{p({...s.toJS(),answer:"",isLoading:!0,isCompleted:!1,error:null},e,!1)}),[p]),Z=react.useCallback((s=>{let e;s?e=s.id:y.current&&(e=y.current.id),e&&stream_k.abortRequest(`content-answers-${e}`,!0)}),[]),q=react.useCallback((async s=>{s&&K({type:actions.k.SET_ASK_CONFIG,id:s.id,ask:null==s?void 0:s.ask})}),[K]),w=react.useCallback((async()=>{if(m&&!S){o({type:N,requestState:types.R.IN_PROGRESS});try{const s=(await m(c,E)).suggestedPrompts.map(((t,o)=>({prompt:t,id:`suggestion-${o}`,type:types.S.INTELLIGENT})));x&&x(s),o({type:"SET_SUGGESTED_QUESTIONS",suggestedQuestions:s})}catch{o({type:N,requestState:types.R.ERROR})}}}),[o,m,S,c,E]);return{clearConversation:Y,createSession:I,fetchAgentConfig:q,fetchSuggestedQuestions:w,retryQuestion:z,sendQuestion:p,sendQuestionAnswerRequest:A,setAnswerFeedback:X,stopQuestion:Z,updateQuestionInState:u}}const reducer_O=(t,s)=>{switch(s.type){case"SET_NEW_ITEM":return new records_u({item:new records_t({id:s.itemID,version_id:s.fileVersionID&&s.fileVersionID.toString()})});case"SET_IS_LOADING":return t.set("isLoading",s.isLoading);case"CLEAR_CONVERSATION_HISTORY":{const{hasRequestInProgress:e}=t;return t.withMutations((n=>{n.set("shouldShowLandingPage",!e),n.set("questions",[]),n.set("contextSession",null)}))}case"UPDATE_QUESTION":{const{questions:e}=t,{newQuestion:n,session:u}=s,r=[...e],i=(null==e?void 0:e.findIndex((o=>o.id===n.id)))??-1;i>=0?r[i]=n:r.push(n);const{isCompleted:S}=s.newQuestion;return t.withMutations((o=>{u&&o.merge(u),o.set("hasRequestInProgress",!S),o.set("questions",r),o.set("shouldShowLandingPage",!1)}))}case T:return t.set("error",s.error);case _:return t.withMutations((e=>{e.set("encodedSession",s.encodedSession),e.set("error",s.isLargeFile?types.C.LARGE_FILE:null),e.set("isLoading",!1)}));case N:return t.withMutations((e=>{e.setIn(["suggestedQuestions","requestState"],s.requestState)}));case"SET_SUGGESTED_QUESTIONS":return t.withMutations((e=>{e.setIn(["suggestedQuestions","requestState"],types.R.SUCCESS),e.setIn(["suggestedQuestions","suggestions"],s.suggestedQuestions)}));case R:{const{questionId:e,feedbackValue:n}=s;return t.updateIn(["questions"],(u=>u.map((r=>r.get("id")===e?r.set("feedbackValue",n):r))))}default:return t}};var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Ce=t=>{const{WrappedComponent:f,cachedSuggestedQuestions:r=[],createSessionRequest:A,fetchTimeout:h,formatCitations:C,getAIStudioAgents:p,getAgentConfig:w,getAnswer:Q,getAnswerStreaming:E,getSuggestedQuestions:s,hostAppName:R,isAIStudioAgentSelectorEnabled:b,isCitationsEnabled:d,isDebugModeEnabled:q,isMarkdownEnabled:T,isOpen:n,isStopResponseEnabled:I,isStreamingEnabled:a,itemID:o,items:u,onCitationClick:L,onCloseModal:P,onItemClick:k,onSuggestedQuestionsFetched:D,parentItem:N,restoredQuestions:O=[],restoredSession:j=null,restoredShouldShowLandingPage:v=!0,sendErrorLog:M,shouldRenderProviders:U=!0,suggestedQuestions:_,warningNotice:x,warningNoticeAriaLabel:F}=t,[g,y]=(0,react.useReducer)(reducer_O,new records_u({item:new records_t({id:o}),questions:O,encodedSession:j,shouldShowLandingPage:v})),{clearConversation:W,createSession:z,fetchAgentConfig:c,fetchSuggestedQuestions:S,retryQuestion:B,sendQuestion:G,setAnswerFeedback:H,stopQuestion:J}=Qs({contentAnswers:g,createSessionRequest:A,dispatchStateUpdate:y,fetchTimeout:h,formatCitations:C,getAgentConfig:w,getAnswerStreaming:E,getAnswer:Q,getSuggestedQuestions:s,isCitationsEnabled:d,isStopResponseEnabled:I,isStreamingEnabled:a,itemID:o,items:u,onSuggestedQuestionsFetched:D,sendErrorLog:M,...t}),{encodedSession:K,error:V,isLoading:X,hasRequestInProgress:Y=!1,questions:Z,shouldShowLandingPage:$,suggestedQuestions:e}=g;(0,react.useEffect)((()=>{n&&e.requestState===types.R.NOT_STARTED&&S()}),[n,S,e.requestState]);const ee=r.length>0;let i=_,l=types.R.SUCCESS;ee?i=r:s&&(i=e.suggestions,l=e.requestState);const te=Object.fromEntries(Object.entries({createSession:z,encodedSession:K,error:V,getAIStudioAgents:p,hostAppName:R,hasCustomSuggestedQuestions:!!s,hasRequestInProgress:Y,isAIStudioAgentSelectorEnabled:b,isCitationsEnabled:d,isDebugModeEnabled:q,isMarkdownEnabled:T,isLoading:X,isOpen:n,isStreamingEnabled:a,itemID:o,items:u,onClearAction:W,onCloseModal:P,onCitationClick:L,onItemClick:k,onSelectAgent:c,onAgentEditorToggle:c,parentItem:N,questions:Z,retryQuestion:B,sendQuestion:G,setAnswerFeedback:H,shouldRenderProviders:U,shouldShowLandingPage:$,stopQuestion:J,suggestedQuestionsRequestState:l,suggestedQuestions:i,warningNotice:x,warningNoticeAriaLabel:F}).filter((([ce,se])=>void 0!==se)));return(0,jsx_runtime.jsx)(f,{...t,...te})},s=t=>o=>(0,jsx_runtime.jsx)(context.UQ,{children:(0,jsx_runtime.jsx)(Ce,{...o,WrappedComponent:t})})},"./node_modules/lodash/_createCaseFirst.js":(module,__unused_webpack_exports,__webpack_require__)=>{var castSlice=__webpack_require__("./node_modules/lodash/_castSlice.js"),hasUnicode=__webpack_require__("./node_modules/lodash/_hasUnicode.js"),stringToArray=__webpack_require__("./node_modules/lodash/_stringToArray.js"),toString=__webpack_require__("./node_modules/lodash/toString.js");module.exports=function createCaseFirst(methodName){return function(string){string=toString(string);var strSymbols=hasUnicode(string)?stringToArray(string):void 0,chr=strSymbols?strSymbols[0]:string.charAt(0),trailing=strSymbols?castSlice(strSymbols,1).join(""):string.slice(1);return chr[methodName]()+trailing}}},"./node_modules/lodash/camelCase.js":(module,__unused_webpack_exports,__webpack_require__)=>{var capitalize=__webpack_require__("./node_modules/lodash/capitalize.js"),camelCase=__webpack_require__("./node_modules/lodash/_createCompounder.js")((function(result,word,index){return word=word.toLowerCase(),result+(index?capitalize(word):word)}));module.exports=camelCase},"./node_modules/lodash/capitalize.js":(module,__unused_webpack_exports,__webpack_require__)=>{var toString=__webpack_require__("./node_modules/lodash/toString.js"),upperFirst=__webpack_require__("./node_modules/lodash/upperFirst.js");module.exports=function capitalize(string){return upperFirst(toString(string).toLowerCase())}},"./node_modules/lodash/upperFirst.js":(module,__unused_webpack_exports,__webpack_require__)=>{var upperFirst=__webpack_require__("./node_modules/lodash/_createCaseFirst.js")("toUpperCase");module.exports=upperFirst}}]);