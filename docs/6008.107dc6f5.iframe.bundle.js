(globalThis.webpackChunkbox_ui_elements=globalThis.webpackChunkbox_ui_elements||[]).push([[6008],{"./src/elements/content-sharing/constants.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C5:()=>API_TO_USM_CLASSIFICATION_COLORS_MAP,Dd:()=>CONTENT_SHARING_ERRORS,OZ:()=>PEOPLE_IN_ITEM,Rx:()=>COLLAB_USER_TYPE,XY:()=>ANYONE_IN_COMPANY,bk:()=>CONTENT_SHARING_ITEM_FIELDS,hL:()=>CONTENT_SHARING_SHARED_LINK_UPDATE_PARAMS,hc:()=>ANYONE_WITH_LINK,n1:()=>COLLAB_GROUP_TYPE,q0:()=>CONTENT_SHARING_VIEWS});var _features_classification_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/features/classification/constants.js"),_styles_variables__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/styles/variables.js"),_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/constants.js");const CONTENT_SHARING_ERRORS={400:"badRequestError",401:"noAccessError",403:"noAccessError",404:"notFoundError",500:"loadingError"},CONTENT_SHARING_ITEM_FIELDS=[_constants__WEBPACK_IMPORTED_MODULE_1__.ZSI,_constants__WEBPACK_IMPORTED_MODULE_1__.oOz,_constants__WEBPACK_IMPORTED_MODULE_1__.C24,_constants__WEBPACK_IMPORTED_MODULE_1__.qP1,_constants__WEBPACK_IMPORTED_MODULE_1__.jbK,_constants__WEBPACK_IMPORTED_MODULE_1__.NuS,_constants__WEBPACK_IMPORTED_MODULE_1__.wxw,_constants__WEBPACK_IMPORTED_MODULE_1__.VR0,_constants__WEBPACK_IMPORTED_MODULE_1__.PCe,_constants__WEBPACK_IMPORTED_MODULE_1__.En1,_constants__WEBPACK_IMPORTED_MODULE_1__.IiZ,_constants__WEBPACK_IMPORTED_MODULE_1__.WG9,_constants__WEBPACK_IMPORTED_MODULE_1__.iUp],CONTENT_SHARING_SHARED_LINK_UPDATE_PARAMS={fields:CONTENT_SHARING_ITEM_FIELDS},CONTENT_SHARING_VIEWS={SHARED_LINK_SETTINGS:"SHARED_LINK_SETTINGS",UNIFIED_SHARE_MODAL:"UNIFIED_SHARE_MODAL"},API_TO_USM_CLASSIFICATION_COLORS_MAP={[_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlYellow50]:_features_classification_constants__WEBPACK_IMPORTED_MODULE_0__.Mr,[_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlOrange50]:_features_classification_constants__WEBPACK_IMPORTED_MODULE_0__.FP,[_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlWatermelonRed50]:_features_classification_constants__WEBPACK_IMPORTED_MODULE_0__.M8,[_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlPurpleRain50]:_features_classification_constants__WEBPACK_IMPORTED_MODULE_0__.Fu,[_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlLightBlue50]:_features_classification_constants__WEBPACK_IMPORTED_MODULE_0__.Ml,[_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlDarkBlue50]:_features_classification_constants__WEBPACK_IMPORTED_MODULE_0__.FJ,[_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlGreenLight50]:_features_classification_constants__WEBPACK_IMPORTED_MODULE_0__.y7,[_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlGray20]:_features_classification_constants__WEBPACK_IMPORTED_MODULE_0__.T5},ANYONE_WITH_LINK="peopleWithTheLink",ANYONE_IN_COMPANY="peopleInYourCompany",PEOPLE_IN_ITEM="peopleInThisItem",COLLAB_USER_TYPE="user",COLLAB_GROUP_TYPE="group"},"./src/elements/content-sharing/hooks/useContacts.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_1__),_constants__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__("./src/api/index.js"),__webpack_require__("./src/constants.js"));const __WEBPACK_DEFAULT_EXPORT__=function useContacts(api,itemID,options){const[getContacts,setGetContacts]=react__WEBPACK_IMPORTED_MODULE_0__.useState(null),{currentUserId,handleSuccess=lodash_noop__WEBPACK_IMPORTED_MODULE_1___default(),handleError=lodash_noop__WEBPACK_IMPORTED_MODULE_1___default(),isContentSharingV2Enabled,transformGroups,transformUsers}=options;return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((()=>{if(getContacts||isContentSharingV2Enabled&&!currentUserId)return;const resolveAPICall=(resolve,response,transformFn)=>{handleSuccess(response);const entriesExist=response&&response.entries&&response.entries.length;if(transformFn&&entriesExist)return resolve(transformFn(response));return resolve(response&&response.entries?response.entries:[])};setGetContacts((()=>filterTerm=>{const getUsers=new Promise((resolve=>{api.getMarkerBasedUsersAPI(!1).getUsersInEnterprise(itemID,(response=>resolveAPICall(resolve,response,transformUsers)),handleError,{filter_term:filterTerm})})),getGroups=new Promise((resolve=>{api.getMarkerBasedGroupsAPI(!1).getGroupsInEnterprise(itemID,(response=>resolveAPICall(resolve,response,transformGroups)),handleError,{fields:[_constants__WEBPACK_IMPORTED_MODULE_3__.VR0,_constants__WEBPACK_IMPORTED_MODULE_3__.En1].toString(),filter_term:filterTerm})}));return Promise.all([getUsers,getGroups]).then((contactArrays=>[...contactArrays[0],...contactArrays[1]]))}))}),[api,currentUserId,getContacts,handleError,handleSuccess,isContentSharingV2Enabled,itemID,transformGroups,transformUsers]),getContacts}},"./src/elements/content-sharing/hooks/useContactsByEmail.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_1__);__webpack_require__("./src/api/index.js");const __WEBPACK_DEFAULT_EXPORT__=function useContactsByEmail(api,itemID,options){const[getContactsByEmail,setGetContactsByEmail]=react__WEBPACK_IMPORTED_MODULE_0__.useState(null),{handleSuccess=lodash_noop__WEBPACK_IMPORTED_MODULE_1___default(),handleError=lodash_noop__WEBPACK_IMPORTED_MODULE_1___default(),isContentSharingV2Enabled,transformUsers}=options;return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((()=>{if(getContactsByEmail)return;const resolveAPICall=(resolve,response,transformFn)=>(handleSuccess(response),response&&response.entries&&response.entries.length?resolve(transformFn?transformFn(response):response.entries):resolve({}));if(isContentSharingV2Enabled){setGetContactsByEmail((()=>email=>email?new Promise((resolve=>{api.getMarkerBasedUsersAPI(!1).getUsersInEnterprise(itemID,(response=>resolveAPICall(resolve,response,transformUsers)),handleError,{filter_term:email})})):Promise.resolve({})))}else{setGetContactsByEmail((()=>filterTerm=>{if(!filterTerm||!Array.isArray(filterTerm.emails)||!filterTerm.emails.length)return Promise.resolve({});const parsedFilterTerm=filterTerm.emails[0];return new Promise((resolve=>{api.getMarkerBasedUsersAPI(!1).getUsersInEnterprise(itemID,(response=>resolveAPICall(resolve,response,transformUsers)),handleError,{filter_term:parsedFilterTerm})}))}))}}),[api,getContactsByEmail,handleError,handleSuccess,isContentSharingV2Enabled,itemID,transformUsers]),getContactsByEmail}},"./src/elements/content-sharing/hooks/useInvites.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_1__);__webpack_require__("./src/api/index.js");const __WEBPACK_DEFAULT_EXPORT__=function useInvites(api,itemID,itemType,options){const[sendInvites,setSendInvites]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),{collaborators,handleSuccess=lodash_noop__WEBPACK_IMPORTED_MODULE_1___default(),handleError=lodash_noop__WEBPACK_IMPORTED_MODULE_1___default(),isContentSharingV2Enabled,setIsLoading=lodash_noop__WEBPACK_IMPORTED_MODULE_1___default(),transformRequest,transformResponse=arg=>arg}=options;return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((()=>{if(sendInvites||isContentSharingV2Enabled&&!collaborators)return;const itemData={id:itemID,type:itemType},sendCollabRequest=collab=>new Promise(((resolve,reject)=>{api.getCollaborationsAPI(!1).addCollaboration(itemData,collab,(response=>{handleSuccess(response),resolve(transformResponse(response))}),(error=>{handleError(error),reject(error)}))}));sendInvites||setSendInvites((()=>async collabRequest=>{if(!transformRequest)return Promise.resolve(null);const{users,groups}=transformRequest(collabRequest);setIsLoading(!0);try{return await Promise.all([...users.map((user=>sendCollabRequest(user))),...groups.map((group=>sendCollabRequest(group)))])}finally{setIsLoading(!1)}}))}),[api,collaborators,handleError,handleSuccess,isContentSharingV2Enabled,itemID,itemType,sendInvites,setIsLoading,transformRequest,transformResponse]),sendInvites}},"./src/elements/content-sharing/messages.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=(0,__webpack_require__("./node_modules/react-intl/lib/index.js").YK)({defaultErrorNoticeText:{id:"be.contentSharing.defaultErrorNoticeText",defaultMessage:"Something went wrong. Please try again later."},badRequestError:{id:"be.contentSharing.badRequestError",defaultMessage:"The request for this item was malformed."},loadingError:{id:"be.contentSharing.loadingError",defaultMessage:"Could not load shared link for this item."},noAccessError:{id:"be.contentSharing.noAccessError",defaultMessage:"You do not have access to this item."},notFoundError:{id:"be.contentSharing.notFoundError",defaultMessage:"Could not find shared link for this item."},sharedLinkUpdateError:{id:"be.contentSharing.sharedLinkUpdateError",defaultMessage:"Could not update the shared link for this item."},sharedLinkSettingsUpdateSuccess:{id:"be.contentSharing.sharedLinkSettingsUpdateSuccess",defaultMessage:"The shared link for this item was successfully updated."},sharedLinkRemovalSuccess:{id:"be.contentSharing.sharedLinkRemovalSuccess",defaultMessage:"The shared link for this item was removed."},collaboratorsLoadingError:{id:"be.contentSharing.collaboratorsLoadingError",defaultMessage:"Could not retrieve collaborators for this item."},getContactsError:{id:"be.contentSharing.getContactsError",defaultMessage:"Could not retrieve contacts."},sendInvitesError:{id:"be.contentSharing.sendInvitesError",defaultMessage:"Could not send invites."},sendInvitesSuccess:{id:"be.contentSharing.sendInvitesSuccess",defaultMessage:"Successfully invited collaborators."},sendInvitationsError:{id:"be.contentSharing.sendInvitationsError",defaultMessage:"{count, plural, one {Failed to invite a collaborator.} other {Failed to invite {count} collaborators.}}"},sendInvitationsSuccess:{id:"be.contentSharing.sendInvitationsSuccess",defaultMessage:"{count, plural, one {Successfully invited a collaborator.} other {Successfully invited {count} collaborators.}}"},groupContactLabel:{id:"be.contentSharing.groupContactLabel",defaultMessage:"Group"},noticeCloseLabel:{id:"be.contentSharing.noticeCloseLabel",defaultMessage:"Close"},errorNoticeIcon:{id:"be.contentSharing.errorNoticeIcon",defaultMessage:"Error"}})},"./src/elements/content-sharing/utils/__mocks__/ContentSharingV2Mocks.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C3:()=>mockApiWithCollaborators,Ur:()=>mockApiWithSharedLink,eS:()=>ContentSharingV2Template,wI:()=>mockApiWithoutSharedLink});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_box_blueprint_web__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@box/blueprint-web/dist/lib-esm/primitives/notification/index.js"),_box_blueprint_web__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@box/blueprint-web/dist/lib-esm/tooltip/tooltip.js"),_box_blueprint_web__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@box/blueprint-web/dist/lib-esm/button/button.js"),_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/constants.js"),_ContentSharingV2__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/elements/content-sharing/ContentSharingV2.tsx");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const MOCK_ITEM_id="123456789",MOCK_ITEM_name="Box Development Guide.pdf",MOCK_ITEM_type="file",mockAvatarUrlMap={456:"https://example.com/avatar.jpg"},mockOwner={id:789,login:"aotter@example.com",name:"Astronaut Otter"},MOCK_COLLABORATORS=[{id:456,login:"dparrot@example.com",name:"Detective Parrot",role:"editor"},{id:457,login:"rqueen@external.example.com",name:"Raccoon Queen"},{id:458,login:"dpenguin@example.com",name:"Dancing Penguin"}],MOCK_COLLABORATIONS_RESPONSE={entries:MOCK_COLLABORATORS.map((user=>({id:`record_${user.id}`,accessible_by:user,expires_at:user.expires_at,created_by:{id:789,login:"aotter@example.com",name:"Astronaut Otter",type:"user"},role:789===user.id?"owner":"editor",status:"accepted",type:user.type})))},EMPTY_COLLABORATIONS_RESPONSE={entries:[]},DEFAULT_USER_API_RESPONSE={id:"789",enterprise:{name:"Otter Enterprise"}},DEFAULT_ITEM_API_RESPONSE={allowed_invitee_roles:["editor","viewer"],allowed_shared_link_access_levels:["open","company","collaborators"],allowed_shared_link_access_levels_disabled_reasons:{peopleInThisItem:"access_policy"},classification:null,id:MOCK_ITEM_id,name:MOCK_ITEM_name,owned_by:mockOwner,permissions:{can_download:!0,can_invite_collaborator:!0,can_set_share_access:!0,can_share:!0},shared_link:null,shared_link_features:{password:!0},type:MOCK_ITEM_type},MOCK_ITEM_API_RESPONSE_WITH_SHARED_LINK=_objectSpread(_objectSpread({},DEFAULT_ITEM_API_RESPONSE),{},{shared_link:{access:"open",effective_permission:"can_download",is_password_enabled:!0,unshared_at:17040672e5,url:"https://example.com/shared-link",vanity_name:"vanity-name",vanity_url:"https://example.com/vanity-url"}}),MOCK_ITEM_API_RESPONSE_WITH_COLLABORATORS=_objectSpread(_objectSpread({},DEFAULT_ITEM_API_RESPONSE),{},{collaborators:MOCK_COLLABORATORS}),createMockApi=(_objectSpread(_objectSpread({},DEFAULT_ITEM_API_RESPONSE),{},{classification:{color:"#91c2fd",definition:"Blue classification",name:"Blue"}}),(itemResponse=DEFAULT_ITEM_API_RESPONSE,userResponse=DEFAULT_USER_API_RESPONSE,collaboratorsResponse=MOCK_COLLABORATIONS_RESPONSE)=>{const mockFileApi={getFile:(itemId,successCallback)=>{setTimeout((()=>{successCallback(itemResponse)}),100)}},mockFolderApi={getFolderFields:(itemId,successCallback)=>{setTimeout((()=>{successCallback(itemResponse)}),100)}},mockUsersApi={getUser:(itemId,successCallback)=>{setTimeout((()=>{successCallback(userResponse)}),100)},getAvatarUrlWithAccessToken:userId=>mockAvatarUrlMap[userId]??null};return{getFileAPI:()=>mockFileApi,getFolderAPI:()=>mockFolderApi,getUsersAPI:()=>mockUsersApi,getFileCollaborationsAPI:()=>({getCollaborations:(itemId,successCallback)=>{setTimeout((()=>{successCallback(collaboratorsResponse)}),100)}}),getFolderCollaborationsAPI:()=>({getCollaborations:(itemId,successCallback)=>{setTimeout((()=>{successCallback(collaboratorsResponse)}),100)}})}}),mockApiWithSharedLink=createMockApi(MOCK_ITEM_API_RESPONSE_WITH_SHARED_LINK,DEFAULT_USER_API_RESPONSE,EMPTY_COLLABORATIONS_RESPONSE),mockApiWithoutSharedLink=createMockApi(DEFAULT_ITEM_API_RESPONSE,DEFAULT_USER_API_RESPONSE,EMPTY_COLLABORATIONS_RESPONSE),mockApiWithCollaborators=createMockApi(MOCK_ITEM_API_RESPONSE_WITH_COLLABORATORS,DEFAULT_USER_API_RESPONSE,MOCK_COLLABORATIONS_RESPONSE),ContentSharingV2Template=(props={})=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_box_blueprint_web__WEBPACK_IMPORTED_MODULE_3__.E.Provider,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_box_blueprint_web__WEBPACK_IMPORTED_MODULE_4__.Bc,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ContentSharingV2__WEBPACK_IMPORTED_MODULE_2__.A,_extends({api:mockApiWithoutSharedLink,itemId:__webpack_require__.g.FILE_ID,itemType:_constants__WEBPACK_IMPORTED_MODULE_1__.I9H},props),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_box_blueprint_web__WEBPACK_IMPORTED_MODULE_5__.$,null,"Open Unified Share Modal"))));ContentSharingV2Template.__docgenInfo={description:"",methods:[],displayName:"ContentSharingV2Template"}},"./src/features/classification/constants.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{DK:()=>DOWNLOAD_CONTROL,Df:()=>DEFAULT_CLASSIFICATION_COLOR_ID,FJ:()=>CLASSIFICATION_COLOR_ID_5,FP:()=>CLASSIFICATION_COLOR_ID_1,Fu:()=>CLASSIFICATION_COLOR_ID_3,M8:()=>CLASSIFICATION_COLOR_ID_2,Ml:()=>CLASSIFICATION_COLOR_ID_4,Mr:()=>CLASSIFICATION_COLOR_ID_0,T5:()=>CLASSIFICATION_COLOR_ID_7,Uv:()=>SECURITY_CONTROLS_FORMAT,lC:()=>MANAGED_USERS_ACCESS_LEVEL,sk:()=>APP_RESTRICTION_MESSAGE_TYPE,t$:()=>ACCESS_POLICY_RESTRICTION,v9:()=>LIST_ACCESS_LEVEL,xP:()=>DEFAULT_MAX_APP_COUNT,y7:()=>CLASSIFICATION_COLOR_ID_6,zv:()=>SHARED_LINK_ACCESS_LEVEL});const DEFAULT_MAX_APP_COUNT=3,SECURITY_CONTROLS_FORMAT={FULL:"full",SHORT:"short",SHORT_WITH_BTN:"shortWithBtn"},ACCESS_POLICY_RESTRICTION={APP:"app",BOX_SIGN_REQUEST:"boxSignRequest",DOWNLOAD:"download",EXTERNAL_COLLAB:"externalCollab",FTP:"ftp",SHARED_LINK:"sharedLink",SHARED_LINK_AUTO_EXPIRATION:"sharedLinkAutoExpiration",WATERMARK:"watermark"},DOWNLOAD_CONTROL={DESKTOP:"desktop",FTP:"ftp",MOBILE:"mobile",WEB:"web"},LIST_ACCESS_LEVEL={BLACKLIST:"blacklist",BLOCK:"block",WHITELIST:"whitelist"},MANAGED_USERS_ACCESS_LEVEL={OWNERS_AND_COOWNERS:"ownersCoOwners",OWNERS_COOWNERS_AND_EDITORS:"ownersCoOwnersEditors"},SHARED_LINK_ACCESS_LEVEL={COLLAB_AND_COMPANY_ONLY:"companyAndCollabOnly",COLLAB_ONLY:"collabOnly",PUBLIC:"public"},APP_RESTRICTION_MESSAGE_TYPE={DEFAULT:"default",WITH_APP_LIST:"withAppList",WITH_OVERFLOWN_APP_LIST:"withOverflownAppList"},CLASSIFICATION_COLOR_ID_0=0,CLASSIFICATION_COLOR_ID_1=1,CLASSIFICATION_COLOR_ID_2=2,CLASSIFICATION_COLOR_ID_3=3,CLASSIFICATION_COLOR_ID_4=4,CLASSIFICATION_COLOR_ID_5=5,CLASSIFICATION_COLOR_ID_6=6,CLASSIFICATION_COLOR_ID_7=7,DEFAULT_CLASSIFICATION_COLOR_ID=CLASSIFICATION_COLOR_ID_0},"./src/styles/variables.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{avatarColors:()=>avatarColors,bdlBorderRadiusSize:()=>bdlBorderRadiusSize,bdlBorderRadiusSizeLarge:()=>bdlBorderRadiusSizeLarge,bdlBorderRadiusSizeMed:()=>bdlBorderRadiusSizeMed,bdlBorderRadiusSizeXlarge:()=>bdlBorderRadiusSizeXlarge,bdlBoxBlue:()=>bdlBoxBlue,bdlBoxBlue02:()=>bdlBoxBlue02,bdlBoxBlue05:()=>bdlBoxBlue05,bdlBoxBlue10:()=>bdlBoxBlue10,bdlBoxBlue20:()=>bdlBoxBlue20,bdlBoxBlue30:()=>bdlBoxBlue30,bdlBoxBlue40:()=>bdlBoxBlue40,bdlBoxBlue50:()=>bdlBoxBlue50,bdlBoxBlue80:()=>bdlBoxBlue80,bdlBtnBorderWidth:()=>bdlBtnBorderWidth,bdlBtnHeight:()=>bdlBtnHeight,bdlBtnHeightLarge:()=>bdlBtnHeightLarge,bdlBtnIconSize:()=>bdlBtnIconSize,bdlBtnPaddingHorizontal:()=>bdlBtnPaddingHorizontal,bdlBtnTextIconSize:()=>bdlBtnTextIconSize,bdlDarkBlue:()=>bdlDarkBlue,bdlDarkBlue02:()=>bdlDarkBlue02,bdlDarkBlue05:()=>bdlDarkBlue05,bdlDarkBlue10:()=>bdlDarkBlue10,bdlDarkBlue20:()=>bdlDarkBlue20,bdlDarkBlue50:()=>bdlDarkBlue50,bdlFontSize:()=>bdlFontSize,bdlFontSizeDejaBlue:()=>bdlFontSizeDejaBlue,bdlFontSizeMinimum:()=>bdlFontSizeMinimum,bdlGray:()=>bdlGray,bdlGray02:()=>bdlGray02,bdlGray05:()=>bdlGray05,bdlGray10:()=>bdlGray10,bdlGray20:()=>bdlGray20,bdlGray30:()=>bdlGray30,bdlGray40:()=>bdlGray40,bdlGray50:()=>bdlGray50,bdlGray65:()=>bdlGray65,bdlGray80:()=>bdlGray80,bdlGreenLight:()=>bdlGreenLight,bdlGreenLight02:()=>bdlGreenLight02,bdlGreenLight05:()=>bdlGreenLight05,bdlGreenLight10:()=>bdlGreenLight10,bdlGreenLight20:()=>bdlGreenLight20,bdlGreenLight50:()=>bdlGreenLight50,bdlGridUnit:()=>bdlGridUnit,bdlGridUnitPx:()=>bdlGridUnitPx,bdlGrimace:()=>bdlGrimace,bdlGrimace02:()=>bdlGrimace02,bdlGrimace05:()=>bdlGrimace05,bdlGrimace10:()=>bdlGrimace10,bdlGrimace20:()=>bdlGrimace20,bdlGrimace50:()=>bdlGrimace50,bdlHeaderBoxShadow:()=>bdlHeaderBoxShadow,bdlHeaderHeight:()=>bdlHeaderHeight,bdlLightBlue:()=>bdlLightBlue,bdlLightBlue02:()=>bdlLightBlue02,bdlLightBlue05:()=>bdlLightBlue05,bdlLightBlue10:()=>bdlLightBlue10,bdlLightBlue20:()=>bdlLightBlue20,bdlLightBlue50:()=>bdlLightBlue50,bdlLineHeight:()=>bdlLineHeight,bdlOrange:()=>bdlOrange,bdlOrange02:()=>bdlOrange02,bdlOrange05:()=>bdlOrange05,bdlOrange10:()=>bdlOrange10,bdlOrange20:()=>bdlOrange20,bdlOrange50:()=>bdlOrange50,bdlPurpleRain:()=>bdlPurpleRain,bdlPurpleRain02:()=>bdlPurpleRain02,bdlPurpleRain05:()=>bdlPurpleRain05,bdlPurpleRain10:()=>bdlPurpleRain10,bdlPurpleRain20:()=>bdlPurpleRain20,bdlPurpleRain50:()=>bdlPurpleRain50,bdlTimingFunction:()=>bdlTimingFunction,bdlTransitionDurationBase:()=>bdlTransitionDurationBase,bdlWatermelonRed:()=>bdlWatermelonRed,bdlWatermelonRed02:()=>bdlWatermelonRed02,bdlWatermelonRed05:()=>bdlWatermelonRed05,bdlWatermelonRed10:()=>bdlWatermelonRed10,bdlWatermelonRed20:()=>bdlWatermelonRed20,bdlWatermelonRed50:()=>bdlWatermelonRed50,bdlYellorange:()=>bdlYellorange,bdlYellorange02:()=>bdlYellorange02,bdlYellorange05:()=>bdlYellorange05,bdlYellorange10:()=>bdlYellorange10,bdlYellorange20:()=>bdlYellorange20,bdlYellorange50:()=>bdlYellorange50,bdlYellow:()=>bdlYellow,bdlYellow02:()=>bdlYellow02,bdlYellow05:()=>bdlYellow05,bdlYellow10:()=>bdlYellow10,bdlYellow20:()=>bdlYellow20,bdlYellow50:()=>bdlYellow50,black:()=>black,countBadgeBackground:()=>countBadgeBackground,largeScreen:()=>largeScreen,mediumScreen:()=>mediumScreen,menuZIndex:()=>menuZIndex,modalDialogZIndex:()=>modalDialogZIndex,notificationsWrapperZIndex:()=>notificationsWrapperZIndex,overlayZIndex:()=>overlayZIndex,sizeLargeMax:()=>sizeLargeMax,sizeLargeMin:()=>sizeLargeMin,sizeMediumMax:()=>sizeMediumMax,sizeMediumMin:()=>sizeMediumMin,sizeSmallMax:()=>sizeSmallMax,sizeSmallMediumMax:()=>sizeSmallMediumMax,sizeSmallMediumMin:()=>sizeSmallMediumMin,sizeXlargeMax:()=>sizeXlargeMax,smallMediumScreen:()=>smallMediumScreen,smallScreen:()=>smallScreen,submenuZIndex:()=>submenuZIndex,tooltipZIndex:()=>tooltipZIndex,white:()=>white,xlargeScreen:()=>xlargeScreen});const white="#fff",black="#000",countBadgeBackground="#e9163c",bdlBoxBlue="#0061d5",bdlBoxBlue80="#3381dd",bdlBoxBlue50="#7fb0ea",bdlBoxBlue40="#99c0ee",bdlBoxBlue30="#b2cff2",bdlBoxBlue20="#ccdff7",bdlBoxBlue10="#e5effa",bdlBoxBlue05="#f2f7fd",bdlBoxBlue02="#fafcfe",bdlGray="#222",bdlGray80="#4e4e4e",bdlGray65="#6f6f6f",bdlGray50="#909090",bdlGray40="#a7a7a7",bdlGray30="#bcbcbc",bdlGray20="#d3d3d3",bdlGray10="#e8e8e8",bdlGray05="#f4f4f4",bdlGray02="#fbfbfb",bdlDarkBlue="#003c84",bdlDarkBlue50="#7f9dc1",bdlDarkBlue20="#ccd8e6",bdlDarkBlue10="#e5ebf2",bdlDarkBlue05="#f2f5f9",bdlDarkBlue02="#fafbfd",bdlLightBlue="#2486fc",bdlLightBlue50="#91c2fd",bdlLightBlue20="#d3e7fe",bdlLightBlue10="#e9f2fe",bdlLightBlue05="#f4f9ff",bdlLightBlue02="#fbfdff",bdlYellorange="#f5b31b",bdlYellorange50="#fad98d",bdlYellorange20="#fdf0d1",bdlYellorange10="#fef7e8",bdlYellorange05="#fefbf3",bdlYellorange02="#fffefb",bdlYellow="#ffd700",bdlYellow50="#ffeb7f",bdlYellow20="#fff7cc",bdlYellow10="#fffbe5",bdlYellow05="#fffdf2",bdlYellow02="#fffefa",bdlGreenLight="#26c281",bdlGreenLight50="#92e0c0",bdlGreenLight20="#d4f3e6",bdlGreenLight10="#e9f8f2",bdlGreenLight05="#f4fcf8",bdlGreenLight02="#fbfefd",bdlGrimace="#4826c2",bdlGrimace50="#a392e0",bdlGrimace20="#dad4f3",bdlGrimace10="#ece9f8",bdlGrimace05="#f6f4fc",bdlGrimace02="#fbfbfe",bdlOrange="#f1811a",bdlOrange50="#f8c08c",bdlOrange20="#fce6d1",bdlOrange10="#fdf2e8",bdlOrange05="#fef8f3",bdlOrange02="#fffdfb",bdlPurpleRain="#9f3fed",bdlPurpleRain50="#cf9ff6",bdlPurpleRain20="#ecd9fb",bdlPurpleRain10="#f5ebfd",bdlPurpleRain05="#faf5fe",bdlPurpleRain02="#fdfbff",bdlWatermelonRed="#ed3757",bdlWatermelonRed50="#f69bab",bdlWatermelonRed20="#fbd7dd",bdlWatermelonRed10="#fdebee",bdlWatermelonRed05="#fef5f6",bdlWatermelonRed02="#fffbfc",bdlLineHeight="20px",bdlFontSize="13px",bdlFontSizeMinimum="11px",bdlFontSizeDejaBlue="14px",avatarColors=["#0061d5","#003c84","#6f6f6f","#222","#4826c2","#9f3fed"],modalDialogZIndex="160",menuZIndex="170",submenuZIndex="171",overlayZIndex="190",tooltipZIndex="190",notificationsWrapperZIndex="200",bdlBorderRadiusSize="4px",bdlBorderRadiusSizeMed="6px",bdlBorderRadiusSizeLarge="8px",bdlBorderRadiusSizeXlarge="12px",bdlHeaderBoxShadow=["0 0 10px 0 rgba(0","0","0","0.05)"],bdlGridUnit="4px",bdlGridUnitPx="4",bdlHeaderHeight="64px",bdlBtnBorderWidth="1px",bdlBtnHeight="32px",bdlBtnHeightLarge="40px",bdlBtnIconSize="20px",bdlBtnTextIconSize="16px",bdlBtnPaddingHorizontal="16px",bdlTransitionDurationBase="0.15s",bdlTimingFunction=["cubic-bezier(0","0","0.6","1)"],sizeSmallMediumMin="375px",sizeMediumMin="461px",sizeLargeMin="768px",sizeSmallMax="374px",sizeSmallMediumMax="460px",sizeMediumMax="767px",sizeLargeMax="1023px",sizeXlargeMax="1219px",smallScreen="(max-width: 374px)",smallMediumScreen="(max-width: 460px)",mediumScreen="(max-width: 767px)",largeScreen="(max-width: 1023px)",xlargeScreen="(max-width: 1219px)"},"./src/elements/common/withBlueprintModernization.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{P:()=>withBlueprintModernization});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_box_blueprint_web__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@box/blueprint-web/dist/lib-esm/blueprint-modernization-context/blueprint-modernization-context.js");function withBlueprintModernization(Component){return function WithBlueprintModernization(props){return(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_box_blueprint_web__WEBPACK_IMPORTED_MODULE_1__.G).enableModernizedComponents?react__WEBPACK_IMPORTED_MODULE_0__.createElement(Component,props):react__WEBPACK_IMPORTED_MODULE_0__.createElement(_box_blueprint_web__WEBPACK_IMPORTED_MODULE_1__.y,{enableModernizedComponents:!!props.enableModernizedComponents},react__WEBPACK_IMPORTED_MODULE_0__.createElement(Component,props))}}try{withBlueprintModernization.displayName="withBlueprintModernization",withBlueprintModernization.__docgenInfo={description:"",displayName:"withBlueprintModernization",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/elements/common/withBlueprintModernization.tsx#withBlueprintModernization"]={docgenInfo:withBlueprintModernization.__docgenInfo,name:"withBlueprintModernization",path:"src/elements/common/withBlueprintModernization.tsx#withBlueprintModernization"})}catch(__react_docgen_typescript_loader_error){}},"./src/elements/content-sharing/ContentSharingV2.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>content_sharing_ContentSharingV2});var react=__webpack_require__("./node_modules/react/index.js"),useIntl=__webpack_require__("./node_modules/react-intl/lib/src/components/useIntl.js"),isEmpty=__webpack_require__("./node_modules/lodash/isEmpty.js"),isEmpty_default=__webpack_require__.n(isEmpty),notification_provider=__webpack_require__("./node_modules/@box/blueprint-web/dist/lib-esm/primitives/notification/notification-provider.js"),unified_share_modal=__webpack_require__("./node_modules/@box/unified-share-modal/dist/esm/lib/unified-share-modal.js"),withBlueprintModernization=__webpack_require__("./src/elements/common/withBlueprintModernization.tsx");const fetchAvatars=async({api,itemId,collaborators})=>{const usersApi=api.getUsersAPI(!1),avatarUrlMap={},avatarPromises=collaborators.map((async collab=>{if(!collab?.accessible_by)return;const{accessible_by:{id:userId}}=collab;try{const url=await usersApi.getAvatarUrlWithAccessToken(userId.toString(),itemId);avatarUrlMap[userId]=url}catch{avatarUrlMap[userId]=null}}));return await Promise.all(avatarPromises),avatarUrlMap};var constants=__webpack_require__("./src/constants.js");var content_sharing_constants=__webpack_require__("./src/elements/content-sharing/constants.js");const convertCollab=({avatarUrlMap,collab,currentUserId,isCurrentUserOwner,ownerEmailDomain})=>{if(!collab||collab.status!==constants.bxd)return null;const{accessible_by:{id:collabId,login:collabEmail,name:collabName},id,expires_at:executeAt,role}=collab,isCurrentUser=collabId===currentUserId,isExternal=!isCurrentUserOwner&&collabEmail&&ownerEmailDomain&&collabEmail.split("@")[1]!==ownerEmailDomain,avatarUrl=avatarUrlMap?avatarUrlMap[collabId]:void 0;return{avatarUrl,email:collabEmail,expiresAt:executeAt,hasCustomAvatar:!!avatarUrl,hasCustomRole:!!role,id:id.toString(),isCurrentUser,isExternal,isPending:!1,name:collabName,role:role?`${role[0].toUpperCase()}${role.slice(1)}`:"",userId:collabId.toString()}},API_TO_USM_ACCESS_LEVEL_MAP={[constants.HmB]:content_sharing_constants.XY,[constants.IZ8]:content_sharing_constants.hc,[constants.x83]:content_sharing_constants.OZ},getAllowedPermissionLevels=(canChangeAccessLevel,isDownloadSettingAvailable,permission)=>{let allowedPermissionLevels=[constants.W68,constants.a8y];return canChangeAccessLevel||(allowedPermissionLevels=allowedPermissionLevels.filter((level=>level===permission))),isDownloadSettingAvailable||(allowedPermissionLevels=allowedPermissionLevels.filter((level=>level!==constants.W68))),allowedPermissionLevels},convertItemResponse=itemApiData=>{const{allowed_invitee_roles,allowed_shared_link_access_levels,allowed_shared_link_access_levels_disabled_reasons,classification,id,name,owned_by:ownedBy,permissions,shared_link,shared_link_features,type}=itemApiData,{password:isPasswordAvailable}=shared_link_features,{can_download:isDownloadSettingAvailable,can_invite_collaborator:canInvite,can_set_share_access:canChangeAccessLevel,can_share:canShare}=permissions;let classificationData;if(classification){const{color,definition,name:classificationName}=classification;classificationData={colorId:content_sharing_constants.C5[color],definition,name:classificationName}}const isEditAllowed=-1!==allowed_invitee_roles.indexOf(constants.UJ6);let sharedLink;if(shared_link){const{access,effective_permission:permission,is_password_enabled:isPasswordEnabled,unshared_at:expirationTimestamp,url,vanity_name:vanityName,vanity_url:vanityUrl}=shared_link,isDownloadAllowed=permission===constants.W68,canChangeDownload=canChangeAccessLevel&&isDownloadSettingAvailable&&access!==constants.x83,canChangePassword=canChangeAccessLevel&&isPasswordAvailable,canChangeExpiration=canChangeAccessLevel&&isEditAllowed;sharedLink={access,accessLevels:(levels=allowed_shared_link_access_levels,disabledReasons=allowed_shared_link_access_levels_disabled_reasons,levels||(levels=[constants.IZ8,constants.HmB,constants.x83]),levels.map((level=>{const apiLevel=API_TO_USM_ACCESS_LEVEL_MAP[level],disabledReason=disabledReasons?.[apiLevel];return disabledReason?{id:level,disabledReason}:level}))),expiresAt:expirationTimestamp?new Date(expirationTimestamp).getTime():void 0,permission,permissionLevels:getAllowedPermissionLevels(canChangeAccessLevel,isDownloadSettingAvailable,permission),settings:{canChangeDownload,canChangeExpiration,canChangePassword,canChangeVanityName:!1,isDownloadAvailable:isDownloadSettingAvailable,isDownloadEnabled:isDownloadAllowed,isPasswordAvailable:isPasswordAvailable??!1,isPasswordEnabled},url,vanityDomain:vanityUrl,vanityName:vanityName||""}}var levels,disabledReasons;return{collaborationRoles:allowed_invitee_roles.map((role=>({id:role,isDefault:role===constants.UJ6}))),item:{id,classification:classificationData,name,permissions:{canInviteCollaborator:!!canInvite,canSetShareAccess:canChangeAccessLevel,canShare:!!canShare},type},sharedLink,sharingService:{can_set_share_access:canChangeAccessLevel,can_share:canShare,ownerEmail:ownedBy.login,ownerId:ownedBy.id},ownedBy}},APP_USERS_DOMAIN_REGEXP=/boxdevedition.com/,sortByName=({name:nameA=""},{name:nameB=""})=>nameA.localeCompare(nameB);var datetime=__webpack_require__("./src/utils/datetime.ts");const convertSharedLinkPermissions=permissionLevel=>permissionLevel?{[constants.W68]:permissionLevel===constants.W68,[constants.a8y]:permissionLevel===constants.a8y}:{};var useContactsByEmail=__webpack_require__("./src/elements/content-sharing/hooks/useContactsByEmail.js"),useContacts=__webpack_require__("./src/elements/content-sharing/hooks/useContacts.js"),messages=__webpack_require__("./src/elements/content-sharing/messages.js");const useContactService=(api,itemId,currentUserId)=>{const{formatMessage}=(0,useIntl.A)(),getContacts=(0,useContacts.A)(api,itemId,{currentUserId,isContentSharingV2Enabled:!0,transformUsers:data=>((contactsApiData,currentUserId)=>{const{entries=[]}=contactsApiData;return entries.filter((({id,login:email,status})=>id!==currentUserId&&email&&!APP_USERS_DOMAIN_REGEXP.test(email)&&status&&status!==constants.Zae)).map((contact=>{const{id,login:email,name,type}=contact;return{id,email,name,type,value:email}})).sort(sortByName)})(data,currentUserId),transformGroups:data=>((contactsApiData,emailMessage)=>{const{entries=[]}=contactsApiData;return entries.filter((({permissions})=>permissions&&permissions.can_invite_as_collaborator)).map((contact=>{const{id,name,type}=contact;return{id,email:emailMessage,name,type,value:id}})).sort(sortByName)})(data,formatMessage(messages.A.groupContactLabel))});return{contactService:{getContactByEmail:(0,useContactsByEmail.A)(api,itemId,{isContentSharingV2Enabled:!0,transformUsers:data=>(contactsApiData=>{const{entries=[]}=contactsApiData,entry=entries[0];if(!entry)return{};const{id,login:email="",name,type}=entry;return{id,email,name,type,value:email}})(data)}),getContacts,getContactsAvatarUrls:react.useCallback((async contacts=>{if(!contacts||0===contacts.length)return Promise.resolve({});const collaborators=contacts.map((contact=>({accessible_by:{id:contact.id,is_active:!0,login:contact.email,name:contact.name,type:contact.type}})));return fetchAvatars({api,itemId,collaborators})}),[api,itemId])}}};function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const createSharingService=({hasSharedLink,itemApiInstance,onUpdateSharedLink,onRemoveSharedLink,options})=>{const{id,permissions}=options;return{createSharedLink:async()=>new Promise(((resolve,reject)=>{itemApiInstance.share({id,permissions},void 0,(data=>{onUpdateSharedLink(data),resolve(data)}),(error=>{reject(error)}),content_sharing_constants.hL)})),changeSharedLinkAccess:async access=>hasSharedLink?itemApiInstance.share({id,permissions},access,onUpdateSharedLink,{},content_sharing_constants.hL):Promise.reject(_extends(new Error("Shared link not found"),{status:404})),changeSharedLinkPermission:async permissionLevel=>hasSharedLink?itemApiInstance.updateSharedLink({id,permissions},{permissions:convertSharedLinkPermissions(permissionLevel)},onUpdateSharedLink,{},content_sharing_constants.hL):Promise.reject(_extends(new Error("Shared link not found"),{status:404})),deleteSharedLink:async()=>hasSharedLink?new Promise(((resolve,reject)=>{itemApiInstance.share({id,permissions},constants.S98,(data=>{onRemoveSharedLink(data),resolve(data)}),(error=>{reject(error)}),content_sharing_constants.hL)})):Promise.reject(_extends(new Error("Shared link not found"),{status:404})),updateSharedLink:async sharedLinkSettings=>{if(!hasSharedLink)return Promise.reject(_extends(new Error("Shared link not found"),{status:404}));const{access,isDownloadAvailable,serverUrl}=options;return new Promise(((resolve,reject)=>{itemApiInstance.updateSharedLink({id,permissions},((newSettings,accessLevel,isDownloadAvailable,serverUrl)=>{const{expiration,isDownloadEnabled,isExpirationEnabled,isPasswordEnabled,password,vanityName}=newSettings,convertedSettings={unshared_at:expiration&&isExpirationEnabled?(0,datetime.Ne)(new Date(expiration).toISOString()).toISOString():null,vanity_url:serverUrl&&vanityName?`${serverUrl}${vanityName}`:""};if(accessLevel!==constants.x83){const permissions={can_preview:!isDownloadEnabled};isDownloadAvailable&&(permissions.can_download=isDownloadEnabled),convertedSettings.permissions=permissions}return accessLevel===constants.IZ8&&(isPasswordEnabled&&password?convertedSettings.password=password:isPasswordEnabled||(convertedSettings.password=null)),convertedSettings})(sharedLinkSettings,access,isDownloadAvailable,serverUrl),(data=>{onUpdateSharedLink(data),resolve(data)}),(error=>{reject(error)}),content_sharing_constants.hL)}))}}};var useInvites=__webpack_require__("./src/elements/content-sharing/hooks/useInvites.js");function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const useSharingService=({api,avatarUrlMap,collaborators,currentUserId,item,itemId,itemType,sharedLink,sharingServiceProps,setCollaborators,setItem,setSharedLink})=>{const{formatMessage}=(0,useIntl.A)(),itemApiInstance=react.useMemo((()=>item?itemType===constants.I9H?api.getFileAPI(!1):itemType===constants.U_S?api.getFolderAPI(!1):null:null),[api,item,itemType]),sharingService=react.useMemo((()=>{if(!itemApiInstance)return null;const options={id:itemId,access:sharedLink?.access,permissions:{can_set_share_access:sharingServiceProps?.can_set_share_access,can_share:sharingServiceProps?.can_share},serverUrl:sharingServiceProps?.serverUrl,isDownloadAvailable:sharedLink?.settings?.isDownloadAvailable??!1};return createSharingService({hasSharedLink:!!sharedLink?.url,itemApiInstance,onUpdateSharedLink:updatedItemData=>{const{item:updatedItem,sharedLink:updatedSharedLink}=convertItemResponse(updatedItemData);setItem((prevItem=>_objectSpread(_objectSpread({},prevItem),updatedItem))),setSharedLink((prevSharedLink=>_objectSpread(_objectSpread({},prevSharedLink),updatedSharedLink)))},onRemoveSharedLink:itemData=>{const{item:updatedItem}=convertItemResponse(itemData);setItem((prevItem=>_objectSpread(_objectSpread({},prevItem),updatedItem))),setSharedLink({})},options})}),[itemApiInstance,itemId,sharedLink,sharingServiceProps,setItem,setSharedLink]),handleSendInvitations=(0,useInvites.A)(api,itemId,itemType,{collaborators,handleSuccess:response=>{const{id:ownerId,login:ownerEmail}=response.created_by,ownerEmailDomain=ownerEmail&&/@/.test(ownerEmail)?ownerEmail.split("@")[1]:null;setCollaborators((prevList=>{const newCollab=convertCollab({avatarUrlMap,collab:response,currentUserId,isCurrentUserOwner:currentUserId===ownerId,ownerEmailDomain});return newCollab?[...prevList,newCollab]:prevList}))},isContentSharingV2Enabled:!0,transformRequest:data=>((collabRequest,existingCollaboratorsList)=>{const existingCollab=[];existingCollaboratorsList&&existingCollaboratorsList.length>0&&existingCollaboratorsList.forEach((collab=>{existingCollab.push(collab.userId)}));const groups=[],users=[],{role}=collabRequest;return collabRequest.contacts.forEach((contact=>{existingCollab.includes(contact.id)||(contact.type===content_sharing_constants.n1?groups.push({accessible_by:{id:contact.id,type:content_sharing_constants.n1},role}):users.push({accessible_by:{login:contact.email,type:content_sharing_constants.Rx},role}))})),{groups,users}})(data,collaborators)});return{sharingService:_objectSpread(_objectSpread({},sharingService),{},{sendInvitations:(...request)=>handleSendInvitations(...request).then((response=>{const{contacts:collabRequest}=request[0];if(!response||!collabRequest||0===collabRequest.length)return null;const successCount=response.length,errorCount=collabRequest.length-successCount,notification=[];return errorCount>0&&notification.push({text:formatMessage(messages.A.sendInvitationsError,{count:errorCount}),type:"error"}),successCount>0&&notification.push({text:formatMessage(messages.A.sendInvitationsSuccess,{count:successCount}),type:"success"}),notification.length>0?{messages:notification}:null}))})}};function ContentSharingV2_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function ContentSharingV2_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ContentSharingV2_ownKeys(Object(t),!0).forEach((function(r){ContentSharingV2_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ContentSharingV2_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ContentSharingV2_defineProperty(e,r,t){return(r=function ContentSharingV2_toPropertyKey(t){var i=function ContentSharingV2_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ContentSharingV2({api,children,config:usmConfig,itemId,itemType,variant}){const[avatarUrlMap,setAvatarUrlMap]=react.useState(null),[item,setItem]=react.useState(null),[hasError,setHasError]=react.useState(!1),[sharedLink,setSharedLink]=react.useState(null),[sharingServiceProps,setSharingServiceProps]=react.useState(null),[currentUser,setCurrentUser]=react.useState(null),[collaborationRoles,setCollaborationRoles]=react.useState(null),[collaborators,setCollaborators]=react.useState(null),[collaboratorsData,setCollaboratorsData]=react.useState(null),[owner,setOwner]=react.useState({id:"",email:"",name:""}),{formatMessage}=(0,useIntl.A)(),{addNotification}=(0,notification_provider.h)(),{sharingService}=useSharingService({api,avatarUrlMap,collaborators,currentUserId:currentUser?.id,item,itemId,itemType,sharedLink,sharingServiceProps,setCollaborators,setItem,setSharedLink}),{contactService}=useContactService(api,itemId,currentUser?.id),handleGetItemSuccess=react.useCallback((itemData=>{const{collaborationRoles:collaborationRolesFromApi,item:itemFromApi,ownedBy,sharedLink:sharedLinkFromApi,sharingService:sharingServicePropsFromApi}=convertItemResponse(itemData);setItem(itemFromApi),setSharedLink(sharedLinkFromApi),setSharingServiceProps(sharingServicePropsFromApi),setCollaborationRoles(collaborationRolesFromApi),setOwner({id:ownedBy.id,email:ownedBy.login,name:ownedBy.name})}),[]),getError=react.useCallback((error=>{if(hasError)return;let errorMessage;errorMessage=error.status?messages.A[content_sharing_constants.Dd[error.status]]:error.response&&error.response.status?messages.A[content_sharing_constants.Dd[error.response.status]]:messages.A.loadingError,errorMessage||(errorMessage=messages.A.defaultErrorNoticeText),setHasError(!0),addNotification({closeButtonAriaLabel:formatMessage(messages.A.noticeCloseLabel),sensitivity:"foreground",typeIconAriaLabel:formatMessage(messages.A.errorNoticeIcon),variant:"error",styledText:formatMessage(errorMessage)})}),[hasError,addNotification,formatMessage]);react.useEffect((()=>{setHasError(!1),setItem(null),setSharedLink(null),setCurrentUser(null),setCollaborationRoles(null),setAvatarUrlMap(null),setCollaborators(null),setCollaboratorsData(null)}),[api]),react.useEffect((()=>{!api||isEmpty_default()(api)||item||(async()=>{try{const itemData=await(async({api,itemId,itemType})=>itemType===constants.I9H?new Promise(((resolve,reject)=>{api.getFileAPI().getFile(itemId,resolve,reject,{fields:content_sharing_constants.bk})})):itemType===constants.U_S?new Promise(((resolve,reject)=>{api.getFolderAPI().getFolderFields(itemId,resolve,reject,{fields:content_sharing_constants.bk})})):null)({api,itemId,itemType});handleGetItemSuccess(itemData)}catch(error){getError(error)}})()}),[api,item,itemId,itemType,sharedLink,handleGetItemSuccess,getError]),react.useEffect((()=>{if(!api||isEmpty_default()(api)||!item||currentUser)return;(async()=>{try{const userData=await(async({api,itemId})=>new Promise(((resolve,reject)=>{api.getUsersAPI(!1).getUser(itemId,resolve,reject,{params:{fields:[constants.f8F,constants.hQ9].toString()}})})))({api,itemId});(userData=>{const{id,enterprise,hostname}=userData;setCurrentUser({id,enterprise:{name:enterprise?enterprise.name:""}}),setSharingServiceProps((prevSharingServiceProps=>ContentSharingV2_objectSpread(ContentSharingV2_objectSpread({},prevSharingServiceProps),{},{serverUrl:hostname?`${hostname}v/`:""})))})(userData)}catch(error){getError(error)}})()}),[api,currentUser,item,itemId,itemType,sharedLink,getError]),react.useEffect((()=>{api&&!isEmpty_default()(api)&&item&&!collaboratorsData&&(async()=>{try{const response=await(async({api,itemId,itemType})=>{let collabApiInstance;return itemType===constants.I9H?collabApiInstance=api.getFileCollaborationsAPI(!1):itemType===constants.U_S&&(collabApiInstance=api.getFolderCollaborationsAPI(!1)),collabApiInstance?new Promise(((resolve,reject)=>{collabApiInstance.getCollaborations(itemId,resolve,reject)})):null})({api,itemId,itemType});setCollaboratorsData(response)}catch{setCollaboratorsData({entries:[],next_marker:null})}})()}),[api,collaboratorsData,item,itemId,itemType]),react.useEffect((()=>{!avatarUrlMap&&collaboratorsData&&collaboratorsData.entries&&owner.id&&(async()=>{const ownerEntry={accessible_by:{id:owner.id,login:owner.email,name:owner.name}},response=await fetchAvatars({api,itemId,collaborators:[...collaboratorsData.entries,ownerEntry]});setAvatarUrlMap(response)})()}),[api,avatarUrlMap,collaboratorsData,itemId,owner]),react.useEffect((()=>{if(avatarUrlMap&&collaboratorsData&&currentUser&&owner){const collaboratorsWithAvatars=((collabsApiData,currentUserId,owner,avatarUrlMap)=>{const{entries=[]}=collabsApiData;if(!entries.length)return[];const{id:ownerId,email:ownerEmail,name:ownerName}=owner,isCurrentUserOwner=currentUserId===ownerId,ownerEmailDomain=ownerEmail&&/@/.test(ownerEmail)?ownerEmail.split("@")[1]:null;return[{id:ownerEmail,status:constants.bxd,role:constants.k$T,accessible_by:{id:ownerId,login:ownerEmail,name:ownerName}},...entries].flatMap((collab=>{const converted=convertCollab({avatarUrlMap,collab,currentUserId,isCurrentUserOwner,ownerEmailDomain});return converted?[converted]:[]}))})(collaboratorsData,currentUser.id,owner,avatarUrlMap);setCollaborators(collaboratorsWithAvatars)}}),[avatarUrlMap,collaboratorsData,currentUser,owner]);const config=react.useMemo((()=>ContentSharingV2_objectSpread({sharedLinkEmail:!1},usmConfig)),[usmConfig]);return item&&react.createElement(unified_share_modal.z,{config,collaborationRoles,collaborators,contactService,currentUser,item,sharedLink,sharingService,variant},children)}const content_sharing_ContentSharingV2=(0,withBlueprintModernization.P)(ContentSharingV2);try{ContentSharingV2.displayName="ContentSharingV2",ContentSharingV2.__docgenInfo={description:"",displayName:"ContentSharingV2",props:{api:{defaultValue:null,description:"api - API instance",name:"api",required:!0,type:{name:"API"}},children:{defaultValue:null,description:"children - Children for the element to open the Unified Share Modal",name:"children",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},config:{defaultValue:null,description:"config - Configuration object for the Unified Share Modal",name:"config",required:!1,type:{name:"Configuration"}},itemId:{defaultValue:null,description:"itemId - Box file or folder ID",name:"itemId",required:!0,type:{name:"string"}},itemType:{defaultValue:null,description:'itemType - "file" or "folder"',name:"itemType",required:!0,type:{name:"ItemType"}},variant:{defaultValue:null,description:'variant - "desktop" or "modal" variant of the Unified Share Modal',name:"variant",required:!1,type:{name:"enum",value:[{value:'"desktop"'},{value:'"modal"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/elements/content-sharing/ContentSharingV2.tsx#ContentSharingV2"]={docgenInfo:ContentSharingV2.__docgenInfo,name:"ContentSharingV2",path:"src/elements/content-sharing/ContentSharingV2.tsx#ContentSharingV2"})}catch(__react_docgen_typescript_loader_error){}},"./src/utils/datetime.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ND:()=>isCurrentYear,Ne:()=>convertISOStringToUTCDate,PA:()=>isYesterday,cK:()=>isToday,fU:()=>formatTime,rD:()=>convertToMs,tY:()=>addTime,uX:()=>convertDateToUnixMidnightTime,vd:()=>isValidDate,wn:()=>isCurrentMonth,zL:()=>convertToDate});var lodash_isNaN__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/isNaN.js"),lodash_isNaN__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_isNaN__WEBPACK_IMPORTED_MODULE_0__);const MILLISECONDS_PER_SECOND=1e3,MILLISECONDS_PER_DAY=86400*MILLISECONDS_PER_SECOND,MILLISECONDS_PER_MINUTE=60*MILLISECONDS_PER_SECOND,RE_ISO8601_DATE=/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{1,3})?)?((Z$)|(?:[+-](?:([0-2]\d$)|([0-2]\d(?:00|30)$)|([0-2]\d:(?:00|30)$))))$/,ISO8601_DATETIME=1,ISO8601_MILLISECONDS=2,ISO8601_TIMEZONE=3,ISO8601_Z_FMT=4,ISO8601_SHORT_FMT=5,ISO8601_MEDIUM_FMT=6,ISO8601_LONG_FMT=7;function convertToDate(dateValue){return dateValue instanceof Date?dateValue:new Date(dateValue)}function convertToMs(seconds){return seconds*MILLISECONDS_PER_SECOND}function isToday(dateValue){return(new Date).toDateString()===convertToDate(dateValue).toDateString()}function isYesterday(dateValue){return isToday(convertToDate(dateValue).getTime()+MILLISECONDS_PER_DAY)}function isCurrentMonth(dateValue){return(new Date).getMonth()===convertToDate(dateValue).getMonth()}function isCurrentYear(dateValue){return(new Date).getFullYear()===convertToDate(dateValue).getFullYear()}function formatTime(seconds){const h=Math.floor(seconds/3600),m=Math.floor(seconds%3600/60),s=Math.floor(seconds%3600%60),hour=h>0?`${h.toString()}:`:"",sec=s<10?`0${s.toString()}`:s.toString();let min=m.toString();return h>0&&m<10&&(min=`0${min}`),`${hour}${min}:${sec}`}function addTime(dateValue,timeToAdd){return dateValue instanceof Date?new Date(dateValue.getTime()+timeToAdd):dateValue+timeToAdd}function convertDateToUnixMidnightTime(date){return date.getTime()-date.getTimezoneOffset()*MILLISECONDS_PER_MINUTE}function isValidDate(date){return!lodash_isNaN__WEBPACK_IMPORTED_MODULE_0___default()(date.getTime())}function convertISOStringToUTCDate(isoString){const utcDate=new Date(function convertISOStringtoRFC3339String(isoString){if(RE_ISO8601_DATE.test(isoString)){const parseDate=isoString.split(RE_ISO8601_DATE);let dateTime=parseDate[ISO8601_DATETIME];const milliseconds=parseDate[ISO8601_MILLISECONDS],timeZone=parseDate[ISO8601_TIMEZONE];if(milliseconds||(dateTime+=".000"),parseDate[ISO8601_Z_FMT])return isoString;if(parseDate[ISO8601_SHORT_FMT])return`${dateTime+timeZone}:00`;if(parseDate[ISO8601_MEDIUM_FMT])return`${dateTime+timeZone.substr(0,3)}:${timeZone.substr(3)}`;if(parseDate[ISO8601_LONG_FMT])return isoString}return isoString}(isoString)),utcTime=utcDate.getTime(),timezoneOffsetInMins=utcDate.getTimezoneOffset();return new Date(utcTime+timezoneOffsetInMins*MILLISECONDS_PER_MINUTE)}},"./node_modules/lodash/uniqueId.js":(module,__unused_webpack_exports,__webpack_require__)=>{var toString=__webpack_require__("./node_modules/lodash/toString.js"),idCounter=0;module.exports=function uniqueId(prefix){var id=++idCounter;return toString(prefix)+id}}}]);