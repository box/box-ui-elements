/**
 * @file Footer list component
 * @author Box
 */

import * as React from 'react';
import { useIntl } from 'react-intl';
import type { Node } from 'react';

import type { Collection, BoxItem } from '../../common/types/core';
import { Button } from '@box/blueprint-web';
import messages from '../common/messages';
import './Footer.scss';

type FooterCustomActionButtonsProps = {
    currentFolderId: Collection['id'],
    currentFolderName: Collection['name'],
    onCancel: () => void,
    onChoose: () => void,
    selectedCount: number,
    selectedItems: BoxItem[],
};

type Props = {
    cancelButtonLabel?: string,
    children?: React.ReactNode,
    chooseButtonLabel?: string,
    currentCollection: Collection,
    hasHitSelectionLimit: boolean,
    isSingleSelect: boolean,
    onCancel: () => void,
    onChoose: () => void,
    onSelectedClick: () => void,
    renderCustomActionButtons?: (props: FooterCustomActionButtonsProps) => Node,
    selectedCount: number,
    selectedItems: BoxItem[],
    showSelectedButton?: boolean,
};

const Footer = ({
    currentCollection,
    selectedCount,
    selectedItems,
    onSelectedClick,
    hasHitSelectionLimit,
    isSingleSelect,
    onCancel,
    onChoose,
    chooseButtonLabel,
    cancelButtonLabel,
    children,
    renderCustomActionButtons,
    showSelectedButton,
}: Props) => {
    const intl = useIntl();
    const cancelMessage = intl.formatMessage(messages.cancel);
    const chooseMessage = intl.formatMessage(messages.choose);
    const isChooseButtonDisabled = !selectedCount;
    return (
        <footer className="bcp-footer">
            <div className="bcp-footer-left">
                {showSelectedButton && !isSingleSelect && (
                    <Button 
                        className="bcp-selected" 
                        onClick={onSelectedClick}
                        variant="secondary"
                    >
                        {`${intl.formatMessage(messages.selected, { count: selectedCount })}${
                            hasHitSelectionLimit ? ` (${intl.formatMessage(messages.max)})` : ''
                        }`}
                    </Button>
                )}
            </div>
            <div className="bcp-footer-right">
                {children}

                {renderCustomActionButtons ? (
                    renderCustomActionButtons({
                        currentFolderId: currentCollection.id,
                        currentFolderName: currentCollection.name,
                        onCancel,
                        onChoose,
                        selectedCount,
                        selectedItems,
                    })
                ) : (
                    <div className="bcp-footer-actions">
                        <Button 
                            onClick={onCancel}
                            variant="secondary"
                        >
                            {cancelButtonLabel || cancelMessage}
                        </Button>
                        <Button
                            disabled={isChooseButtonDisabled}
                            onClick={onChoose}
                            variant="primary"
                            data-testid="choose-button"
                            data-resin-target="choose"
                        >
                            {chooseButtonLabel || chooseMessage}
                        </Button>
                    </div>
                )}
            </div>
        </footer>
    );
};

export default Footer;
